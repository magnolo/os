"use strict";angular.module("ngLocale",[],["$provide",function(a){function b(a){a+="";var b=a.indexOf(".");return-1==b?0:a.length-b-1}function c(a,c){var d=c;void 0===d&&(d=Math.min(b(a),3));var e=Math.pow(10,d),f=(a*e|0)%e;return{v:d,f:f}}var d={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};a.value("$locale",{DATETIME_FORMATS:{AMPMS:["vorm.","nachm."],DAY:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],MONTH:["Jänner","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],SHORTDAY:["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."],SHORTMONTH:["Jän.","Feb.","März","Apr.","Mai","Juni","Juli","Aug.","Sep.","Okt.","Nov.","Dez."],fullDate:"EEEE, dd. MMMM y",longDate:"dd. MMMM y",medium:"dd. MMM y HH:mm:ss",mediumDate:"dd. MMM y",mediumTime:"HH:mm:ss","short":"dd.MM.yy HH:mm",shortDate:"dd.MM.yy",shortTime:"HH:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"€",DECIMAL_SEP:",",GROUP_SEP:".",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"¤ -",negSuf:"",posPre:"¤ ",posSuf:""}]},id:"de-at",pluralCat:function(a,b){var e=0|a,f=c(a,b);return 1==e&&0==f.v?d.ONE:d.OTHER}})}]);var rwindow,rdocument;if("undefined"==typeof RELANG)var RELANG={};var RLANG={html:"HTML",video:"Video",image:"Bilder",table:"Tabelle",link:"Link",link_insert:"Link einfügen ...",link_edit:"Edit link",unlink:"Link entfernen",formatting:"Formatvorlagen",paragraph:"Absatz",quote:"Zitat",code:"Code",header1:"Überschrift 1",header2:"Überschrift 2",header3:"Überschrift 3",header4:"Überschrift 4",header5:"Überschrift 5",bold:"Fett",italic:"Kursiv",fontcolor:"Schriftfarbe",backcolor:"Texthervorhebungsfarbe",unorderedlist:"Aufzählungszeichen",orderedlist:"Nummerierung",outdent:"Einzug verkleinern",indent:"Einzug vergrößern",redo:"Wiederholen",undo:"Rückgängig",cut:"Ausschneiden",cancel:"Abbrechen",insert:"Einfügen",save:"Speichern",_delete:"Löschen",insert_table:"Tabelle einfügen",insert_row_above:"Zeile oberhalb einfügen",insert_row_below:"Zeile unterhalb einfügen",insert_column_left:"Spalte links einfügen",insert_column_right:"Spalte rechts einfügen",delete_column:"Spalte löschen",delete_row:"Zeile löschen",delete_table:"Tabelle löschen",rows:"Zeilen",columns:"Spalten",add_head:"Titel einfügen",delete_head:"Titel entfernen",title:"Title",image_view:"Bilder",image_position:"Textumbruch",none:"Keine",left:"Links",right:"Rechts",image_web_link:"Bilder Link",text:"Text",mailto:"Email",web:"URL",video_html_code:"Video-Einbettungscode",file:"Datei",upload:"Hochladen",download:"Download",choose:"Auswählen",or_choose:"Oder, wählen Sie eine Datei aus",drop_file_here:"Ziehen Sie eine Datei hier hin",align_left:"Linksbündig",align_center:"Mitte",align_right:"Rechtsbündig",align_justify:"Blocksatz",horizontalrule:"Horizontale Linie",fullscreen:"Vollbild",deleted:"Durchgestrichen",anchor:"Anker",link_new_tab:"Link in neuem Tab öffnen",underline:"Unterstrichen",alignment:"Ausrichtung",filename:"Name (optional)",edit:"Edit"};!function(a){jQuery.fn.redactor=function(c){return this.each(function(){var d=a(this),e=d.data("redactor");e||d.data("redactor",e=new b(this,c))})};var b=function(b,c){this.$el=a(b),"undefined"!=typeof c&&"undefined"!=typeof c.lang&&"en"!==c.lang&&"undefined"!=typeof RELANG[c.lang]&&(RLANG=RELANG[c.lang]),this.opts=a.extend({iframe:!1,css:!1,lang:"de",direction:"ltr",callback:!1,keyupCallback:!1,keydownCallback:!1,execCommandCallback:!1,plugins:!1,cleanup:!0,focus:!1,tabindex:!1,autoresize:!0,minHeight:!1,fixed:!1,fixedTop:0,fixedBox:!1,source:!0,shortcuts:!0,mobile:!0,air:!1,wym:!1,convertLinks:!0,convertDivs:!0,protocol:"http://",autosave:!1,autosaveCallback:!1,interval:60,imageGetJson:!1,imageUpload:!1,imageUploadCallback:!1,imageUploadErrorCallback:!1,fileUpload:!1,fileUploadCallback:!1,fileUploadErrorCallback:!1,uploadCrossDomain:!1,uploadFields:!1,observeImages:!0,overlay:!0,allowedTags:["form","input","button","select","option","datalist","output","textarea","fieldset","legend","section","header","hgroup","aside","footer","article","details","nav","progress","time","canvas","code","span","div","label","a","br","p","b","i","del","strike","u","img","video","source","track","audio","iframe","object","embed","param","blockquote","mark","cite","small","ul","ol","li","hr","dl","dt","dd","sup","sub","big","pre","code","figure","figcaption","strong","em","table","tr","td","th","tbody","thead","tfoot","h1","h2","h3","h4","h5","h6"],toolbarExternal:!1,buttonsCustom:{},buttonsAdd:[],buttons:["html","|","formatting","|","bold","italic","deleted","|","unorderedlist","orderedlist","outdent","indent","|","image","video","file","table","link","|","fontcolor","backcolor","|","alignment","|","horizontalrule"],airButtons:["formatting","|","bold","italic","deleted","|","unorderedlist","orderedlist","outdent","indent","|","fontcolor","backcolor"],formattingTags:["p","blockquote","pre","h1","h2","h3","h4"],activeButtons:["deleted","italic","bold","underline","unorderedlist","orderedlist"],activeButtonsStates:{b:"bold",strong:"bold",i:"italic",em:"italic",del:"deleted",strike:"deleted",ul:"unorderedlist",ol:"orderedlist",u:"underline"},colors:["#ff0000","#000080","#ffffff","#000000","#eeece1","#1f497d","#4f81bd","#c0504d","#9bbb59","#8064a2","#4bacc6","#f79646","#ffff00","#f2f2f2","#7f7f7f","#ddd9c3","#c6d9f0","#dbe5f1","#f2dcdb","#ebf1dd","#e5e0ec","#dbeef3","#fdeada","#fff2ca","#d8d8d8","#595959","#c4bd97","#8db3e2","#b8cce4","#e5b9b7","#d7e3bc","#ccc1d9","#b7dde8","#fbd5b5","#ffe694","#bfbfbf","#3f3f3f","#938953","#548dd4","#95b3d7","#d99694","#c3d69b","#b2a2c7","#b7dde8","#fac08f","#f2c314","#a5a5a5","#262626","#494429","#17365d","#366092","#953734","#76923c","#5f497a","#92cddc","#e36c09","#c09100","#7f7f7f","#0c0c0c","#1d1b10","#0f243e","#244061","#632423","#4f6128","#3f3151","#31859b","#974806","#7f6000"],emptyHtml:"<p><br /></p>",buffer:!1,visual:!0,modal_file:String()+'<div id="redactor_modal_content"><form id="redactorUploadFileForm" method="post" action="" enctype="multipart/form-data"><label>Name (optional)</label><input type="text" id="redactor_filename" class="redactor_input" /><div style="margin-top: 7px;"><input type="file" id="redactor_file" name="file" /></div></form><br></div>',modal_image_edit:String()+'<div id="redactor_modal_content"><label>'+RLANG.title+'</label><input id="redactor_file_alt" class="redactor_input" /><label>'+RLANG.link+'</label><input id="redactor_file_link" class="redactor_input" /><label>'+RLANG.image_position+'</label><select id="redactor_form_image_align"><option value="none">'+RLANG.none+'</option><option value="left">'+RLANG.left+'</option><option value="right">'+RLANG.right+'</option></select></div><div id="redactor_modal_footer"><a href="javascript:void(null);" id="redactor_image_delete_btn" class="redactor_modal_btn">'+RLANG._delete+'</a>&nbsp;&nbsp;&nbsp;<a href="javascript:void(null);" class="redactor_modal_btn redactor_btn_modal_close">'+RLANG.cancel+'</a><input type="button" name="save" class="redactor_modal_btn" id="redactorSaveBtn" value="'+RLANG.save+'" /></div>',modal_image:String()+'<div id="redactor_modal_content"><div id="redactor_tabs"><a href="javascript:void(null);" class="redactor_tabs_act">'+RLANG.upload+'</a><a href="javascript:void(null);">'+RLANG.choose+'</a><a href="javascript:void(null);">'+RLANG.link+'</a></div><form id="redactorInsertImageForm" method="post" action="" enctype="multipart/form-data"><div id="redactor_tab1" class="redactor_tab"><input type="file" id="redactor_file" name="file" /></div><div id="redactor_tab2" class="redactor_tab" style="display: none;"><div id="redactor_image_box"></div></div></form><div id="redactor_tab3" class="redactor_tab" style="display: none;"><label>'+RLANG.image_web_link+'</label><input type="text" name="redactor_file_link" id="redactor_file_link" class="redactor_input"  /></div></div><div id="redactor_modal_footer"><a href="javascript:void(null);" class="redactor_modal_btn redactor_btn_modal_close">'+RLANG.cancel+'</a><input type="button" name="upload" class="redactor_modal_btn" id="redactor_upload_btn" value="'+RLANG.insert+'" /></div>',modal_link:String()+'<div id="redactor_modal_content"><form id="redactorInsertLinkForm" method="post" action=""><div id="redactor_tabs"><a href="javascript:void(null);" class="redactor_tabs_act">URL</a><a href="javascript:void(null);">Email</a><a href="javascript:void(null);">'+RLANG.anchor+'</a></div><input type="hidden" id="redactor_tab_selected" value="1" /><div class="redactor_tab" id="redactor_tab1"><label>URL</label><input type="text" id="redactor_link_url" class="redactor_input"  /><label>'+RLANG.text+'</label><input type="text" class="redactor_input redactor_link_text" id="redactor_link_url_text" /><label><input type="checkbox" id="redactor_link_blank"> '+RLANG.link_new_tab+'</label></div><div class="redactor_tab" id="redactor_tab2" style="display: none;"><label>Email</label><input type="text" id="redactor_link_mailto" class="redactor_input" /><label>'+RLANG.text+'</label><input type="text" class="redactor_input redactor_link_text" id="redactor_link_mailto_text" /></div><div class="redactor_tab" id="redactor_tab3" style="display: none;"><label>'+RLANG.anchor+'</label><input type="text" class="redactor_input" id="redactor_link_anchor"  /><label>'+RLANG.text+'</label><input type="text" class="redactor_input redactor_link_text" id="redactor_link_anchor_text" /></div></form></div><div id="redactor_modal_footer"><a href="javascript:void(null);" class="redactor_modal_btn redactor_btn_modal_close">'+RLANG.cancel+'</a><input type="button" class="redactor_modal_btn" id="redactor_insert_link_btn" value="'+RLANG.insert+'" /></div>',modal_table:String()+'<div id="redactor_modal_content"><label>'+RLANG.rows+'</label><input type="text" size="5" value="2" id="redactor_table_rows" /><label>'+RLANG.columns+'</label><input type="text" size="5" value="3" id="redactor_table_columns" /></div><div id="redactor_modal_footer"><a href="javascript:void(null);" class="redactor_modal_btn redactor_btn_modal_close">'+RLANG.cancel+'</a><input type="button" name="upload" class="redactor_modal_btn" id="redactor_insert_table_btn" value="'+RLANG.insert+'" /></div>',modal_video:String()+'<div id="redactor_modal_content"><form id="redactorInsertVideoForm"><label>'+RLANG.video_html_code+'</label><textarea id="redactor_insert_video_area" style="width: 99%; height: 160px;"></textarea></form></div><div id="redactor_modal_footer"><a href="javascript:void(null);" class="redactor_modal_btn redactor_btn_modal_close">'+RLANG.cancel+'</a><input type="button" class="redactor_modal_btn" id="redactor_insert_video_btn" value="'+RLANG.insert+'" /></div>',toolbar:{html:{title:RLANG.html,func:"toggle"},formatting:{title:RLANG.formatting,func:"show",dropdown:{p:{title:RLANG.paragraph,exec:"formatblock"},blockquote:{title:RLANG.quote,exec:"formatblock",className:"redactor_format_blockquote"},pre:{title:RLANG.code,exec:"formatblock",className:"redactor_format_pre"},h1:{title:RLANG.header1,exec:"formatblock",className:"redactor_format_h1"},h2:{title:RLANG.header2,exec:"formatblock",className:"redactor_format_h2"},h3:{title:RLANG.header3,exec:"formatblock",className:"redactor_format_h3"},h4:{title:RLANG.header4,exec:"formatblock",className:"redactor_format_h4"}}},bold:{title:RLANG.bold,exec:"bold"},italic:{title:RLANG.italic,exec:"italic"},deleted:{title:RLANG.deleted,exec:"strikethrough"},underline:{title:RLANG.underline,exec:"underline"},unorderedlist:{title:"&bull; "+RLANG.unorderedlist,exec:"insertunorderedlist"},orderedlist:{title:"1. "+RLANG.orderedlist,exec:"insertorderedlist"},outdent:{title:"< "+RLANG.outdent,exec:"outdent"},indent:{title:"> "+RLANG.indent,exec:"indent"},image:{title:RLANG.image,func:"showImage"},video:{title:RLANG.video,func:"showVideo"},file:{title:RLANG.file,func:"showFile"},table:{title:RLANG.table,func:"show",dropdown:{insert_table:{title:RLANG.insert_table,func:"showTable"},separator_drop1:{name:"separator"},insert_row_above:{title:RLANG.insert_row_above,func:"insertRowAbove"},insert_row_below:{title:RLANG.insert_row_below,func:"insertRowBelow"},insert_column_left:{title:RLANG.insert_column_left,func:"insertColumnLeft"},insert_column_right:{title:RLANG.insert_column_right,func:"insertColumnRight"},separator_drop2:{name:"separator"},add_head:{title:RLANG.add_head,func:"addHead"},delete_head:{title:RLANG.delete_head,func:"deleteHead"},separator_drop3:{name:"separator"},delete_column:{title:RLANG.delete_column,func:"deleteColumn"},delete_row:{title:RLANG.delete_row,func:"deleteRow"},delete_table:{title:RLANG.delete_table,func:"deleteTable"}}},link:{title:RLANG.link,func:"show",dropdown:{link:{title:RLANG.link_insert,func:"showLink"},unlink:{title:RLANG.unlink,exec:"unlink"}}},fontcolor:{title:RLANG.fontcolor,func:"show"},backcolor:{title:RLANG.backcolor,func:"show"},alignment:{title:RLANG.alignment,func:"show",dropdown:{alignleft:{title:RLANG.align_left,exec:"JustifyLeft"},aligncenter:{title:RLANG.align_center,exec:"JustifyCenter"},alignright:{title:RLANG.align_right,exec:"JustifyRight"},justify:{title:RLANG.align_justify,exec:"JustifyFull"}}},alignleft:{exec:"JustifyLeft",title:RLANG.align_left},aligncenter:{exec:"JustifyCenter",title:RLANG.align_center},alignright:{exec:"JustifyRight",title:RLANG.align_right},justify:{exec:"JustifyFull",title:RLANG.align_justify},horizontalrule:{exec:"inserthorizontalrule",title:RLANG.horizontalrule}}},c,this.$el.data()),this.dropdowns=[],this.init()};b.prototype={init:function(){function b(){if(this.enableAir(),this.buildToolbar(),"object"==typeof this.opts.plugins&&a.each(this.opts.plugins,a.proxy(function(b,c){"undefined"!=typeof RedactorPlugins[c]&&(a.extend(this,RedactorPlugins[c]),"undefined"!=typeof RedactorPlugins[c].init&&this.init())},this)),this.opts.activeButtons!==!1&&this.opts.toolbar!==!1){var b=a.proxy(function(){this.observeFormatting()},this);this.$editor.click(b).keyup(b)}var c=!1;if(this.browser("webkit")&&-1===navigator.userAgent.indexOf("Chrome")){var d=this.browser("version").split(".");d[0]<536&&(c=!0)}if(this.isMobile(!0)===!1&&c===!1&&this.$editor.bind("paste",a.proxy(function(b){if(this.opts.cleanup===!1)return!0;this.pasteRunning=!0,this.setBuffer(),this.opts.autoresize===!0?this.saveScroll=this.document.body.scrollTop:this.saveScroll=this.$editor.scrollTop();var c=this.extractContent();setTimeout(a.proxy(function(){var a=this.extractContent();this.$editor.append(c),this.restoreSelection();var b=this.getFragmentHtml(a);this.pasteCleanUp(b),this.pasteRunning=!1},this),1)},this)),this.keyup(),this.keydown(),this.opts.autosave!==!1&&this.autoSave(),setTimeout(a.proxy(function(){this.observeImages(),this.observeTables()},this),1),this.browser("mozilla")){this.$editor.click(a.proxy(function(){this.saveSelection()},this));try{this.document.execCommand("enableObjectResizing",!1,!1),this.document.execCommand("enableInlineTableEditing",!1,!1)}catch(e){}}this.opts.focus&&setTimeout(a.proxy(function(){this.$editor.focus()},this),1),this.opts.fixed&&(this.observeScroll(),a(document).scroll(a.proxy(this.observeScroll,this))),"function"==typeof this.opts.callback&&this.opts.callback(this),this.opts.toolbar!==!1&&this.$toolbar.find("a").attr("tabindex","-1")}if(this.height=this.$el.css("height"),this.width=this.$el.css("width"),rdocument=this.document=document,rwindow=this.window=window,this.opts.mobile===!1&&this.isMobile())return this.build(!0),!1;if(this.opts.iframe&&(this.opts.autoresize=!1),this.opts.air)this.opts.buttons=this.opts.airButtons;else if(this.opts.toolbar!==!1){if(this.opts.source===!1){var c=this.opts.buttons.indexOf("html"),d=this.opts.buttons[c+1];this.opts.buttons.splice(c,1),"undefined"!=typeof d&&"|"===d&&this.opts.buttons.splice(c,1)}a.extend(this.opts.toolbar,this.opts.buttonsCustom),a.each(this.opts.buttonsAdd,a.proxy(function(a,b){this.opts.buttons.push(b)},this))}this.opts.toolbar!==!1&&a.each(this.opts.toolbar.formatting.dropdown,a.proxy(function(b,c){"-1"==a.inArray(b,this.opts.formattingTags)&&delete this.opts.toolbar.formatting.dropdown[b]},this)),this.build(!1,b)},shortcuts:function(a,b){a.preventDefault(),this.execCommand(b,!1)},keyup:function(){this.$editor.keyup(a.proxy(function(a){var b=a.keyCode||a.which;return this.browser("mozilla")&&!this.pasteRunning&&this.saveSelection(),"function"==typeof this.opts.keyupCallback&&this.opts.keyupCallback(this,a),8===b||46===b?(this.observeImages(),this.formatEmpty(a)):(13!==b||a.shiftKey||a.ctrlKey||a.metaKey||(this.browser("webkit")&&this.formatNewLine(a),this.opts.convertLinks&&this.$editor.linkify()),void this.syncCode())},this))},keydown:function(){this.$editor.keydown(a.proxy(function(b){var c=b.keyCode||b.which,d=this.getParentNode(),e=this.getCurrentNode(),f=!1,g=b.ctrlKey||b.metaKey;if(!d&&!e||"PRE"!==a(d).get(0).tagName&&"PRE"!==a(e).get(0).tagName||(f=!0),"function"==typeof this.opts.keydownCallback&&this.opts.keydownCallback(this,b),g&&this.opts.shortcuts&&(90===c?this.opts.buffer!==!1?(b.preventDefault(),this.getBuffer()):b.shiftKey?this.shortcuts(b,"redo"):this.shortcuts(b,"undo"):77===c?this.shortcuts(b,"removeFormat"):66===c?this.shortcuts(b,"bold"):73===c?this.shortcuts(b,"italic"):74===c?this.shortcuts(b,"insertunorderedlist"):75===c?this.shortcuts(b,"insertorderedlist"):76===c?this.shortcuts(b,"superscript"):72===c&&this.shortcuts(b,"subscript")),g||90===c||(this.opts.buffer=!1),f===!0&&13===c){b.preventDefault();var h=a(e).parent().text();return this.insertNodeAtCaret(this.document.createTextNode("\r\n")),-1==h.search(/\s$/)&&this.insertNodeAtCaret(this.document.createTextNode("\r\n")),this.syncCode(),!1}if(this.opts.shortcuts&&!b.shiftKey&&9===c){if(f!==!1)return b.preventDefault(),this.insertNodeAtCaret(this.document.createTextNode("	")),this.syncCode(),!1;this.shortcuts(b,"indent")}else this.opts.shortcuts&&b.shiftKey&&9===c&&this.shortcuts(b,"outdent");return this.browser("webkit")&&-1===navigator.userAgent.indexOf("Chrome")?this.safariShiftKeyEnter(b,c):void 0},this))},build:function(b,c){function d(){this.$editor=this.$content.contents().find("body").attr("contenteditable",!0).attr("dir",this.opts.direction),rdocument=this.document=this.$editor[0].ownerDocument,rwindow=this.window=this.document.defaultView||window,this.opts.css!==!1&&this.$content.contents().find("head").append('<link rel="stylesheet" href="'+this.opts.css+'" />'),this.$editor.html(g),c&&(c.call(this),c=null)}if(b!==!0){if(this.$box=a('<div class="redactor_box"></div>'),this.opts.air&&(this.air=a('<div class="redactor_air" style="display: none;"></div>')),this.$content=null,this.textareamode=!0,"TEXTAREA"===this.$el.get(0).tagName){if(this.opts.iframe){var e=this;this.$content=a('<iframe style="width: 100%;" frameborder="0"></iframe>').load(function(){d.call(e)})}else this.$content=this.$editor=a("<div></div>");var f=this.$el.get(0).className.split(/\s+/);a.each(f,a.proxy(function(a,b){this.$content.addClass("redactor_"+b)},this))}else this.textareamode=!1,this.$content=this.$editor=this.$el,this.$el=a('<textarea name="'+this.$editor.attr("id")+'"></textarea>').css("height",this.height);this.$editor&&this.$editor.addClass("redactor_editor").attr("contenteditable",!0).attr("dir",this.opts.direction),this.opts.tabindex!==!1&&this.$content.attr("tabindex",this.opts.tabindex),this.opts.minHeight!==!1&&this.$content.css("min-height",this.opts.minHeight+"px"),this.opts.wym===!0&&this.$content.addClass("redactor_editor_wym"),this.opts.autoresize===!1&&this.$content.css("height",this.height),this.$el.hide();var g="";this.textareamode?(g=this.$el.val(),g=this.savePreCode(g),this.$box.insertAfter(this.$el).append(this.$content).append(this.$el)):(g=this.$editor.html(),g=this.savePreCode(g),this.$box.insertAfter(this.$content).append(this.$el).append(this.$editor)),g=this.paragraphy(g),this.$editor&&this.$editor.html(g),this.textareamode===!1&&this.syncCode()}else if("TEXTAREA"!==this.$el.get(0).tagName){var g=this.$el.val(),h=a('<textarea name="'+this.$editor.attr("id")+'"></textarea>').css("height",this.height).val(g);this.$el.hide(),this.$el.after(h)}c&&this.$editor&&c.call(this)},enableAir:function(){return this.opts.air===!1?!1:(this.air.hide(),this.$editor.bind("textselect",a.proxy(function(a){this.showAir(a)},this)),void this.$editor.bind("textunselect",a.proxy(function(){this.air.hide()},this)))},showAir:function(b){a(".redactor_air").hide();var c=this.air.innerWidth(),d=b.clientX;a(this.document).width()<d+c&&(d-=c);var e=b.clientY+a(document).scrollTop()+14;this.opts.iframe===!0&&(e+=this.$box.position().top,d+=this.$box.position().left),this.air.css({left:d+"px",top:e+"px"}).show()},syncCode:function(){this.$el.val(this.$editor.html())},setCode:function(a){a=this.stripTags(a),this.$editor.html(a).focus(),this.syncCode()},getCode:function(){var a="";return a=this.opts.visual?this.$editor.html():this.$el.val(),this.stripTags(a)},insertHtml:function(a){this.$editor.focus(),this.pasteHtmlAtCaret(a),this.observeImages(),this.syncCode()},pasteHtmlAtCaret:function(a){var b,c;if(this.document.getSelection){if(b=this.window.getSelection(),b.getRangeAt&&b.rangeCount){c=b.getRangeAt(0),c.deleteContents();var d=this.document.createElement("div");d.innerHTML=a;for(var e,f,g=this.document.createDocumentFragment();e=d.firstChild;)f=g.appendChild(e);c.insertNode(g),f&&(c=c.cloneRange(),c.setStartAfter(f),c.collapse(!0),b.removeAllRanges(),b.addRange(c))}}else this.document.selection&&"Control"!=this.document.selection.type&&this.document.selection.createRange().pasteHTML(a)},destroy:function(){var b=this.getCode();this.textareamode?(this.$box.after(this.$el),this.$box.remove(),this.$el.height(this.height).val(b).show()):(this.$box.after(this.$editor),this.$box.remove(),this.$editor.removeClass("redactor_editor").removeClass("redactor_editor_wym").attr("contenteditable",!1).html(b).show()),this.opts.toolbarExternal&&a(this.opts.toolbarExternal).empty(),a(".redactor_air").remove();for(var c=0;c<this.dropdowns.length;c++)this.dropdowns[c].remove(),delete this.dropdowns[c];this.opts.autosave!==!1&&clearInterval(this.autosaveInterval)},observeFormatting:function(){var b=this.getCurrentNode();this.inactiveAllButtons(),a.each(this.opts.activeButtonsStates,a.proxy(function(c,d){0!=a(b).closest(c,this.$editor.get()[0]).length&&this.setBtnActive(d)},this));var c=a(b).closest(["p","div","h1","h2","h3","h4","h5","h6","blockquote","td"]);if("undefined"!=typeof c[0]&&"undefined"!=typeof c[0].elem&&0!=a(c[0].elem).size()){var d=a(c[0].elem).css("text-align");switch(d){case"right":this.setBtnActive("alignright");break;case"center":this.setBtnActive("aligncenter");break;case"justify":this.setBtnActive("justify");break;default:this.setBtnActive("alignleft")}}},observeImages:function(){return this.opts.observeImages===!1?!1:void this.$editor.find("img").each(a.proxy(function(b,c){this.browser("msie")&&a(c).attr("unselectable","on"),this.resizeImage(c)},this))},observeTables:function(){this.$editor.find("table").click(a.proxy(this.tableObserver,this))},observeScroll:function(){var b=a(this.document).scrollTop(),c=this.$box.offset().top,d=0;if(b>c){var e="100%";this.opts.fixedBox&&(d=this.$box.offset().left,e=this.$box.innerWidth()),this.fixed=!0,this.$toolbar.css({position:"fixed",width:e,zIndex:1005,top:this.opts.fixedTop+"px",left:d})}else this.fixed=!1,this.$toolbar.css({position:"relative",width:"auto",zIndex:1,top:0,left:d})},setBuffer:function(){this.saveSelection(),this.opts.buffer=this.$editor.html()},getBuffer:function(){return this.opts.buffer===!1?!1:(this.$editor.html(this.opts.buffer),this.browser("msie")||this.restoreSelection(),void(this.opts.buffer=!1))},execCommand:function(b,c){if(0==this.opts.visual)return this.$el.focus(),!1;try{var d;if("inserthtml"===b)this.browser("msie")?(this.$editor.focus(),this.document.selection.createRange().pasteHTML(c)):this.pasteHtmlAtCaret(c),this.observeImages();else if("unlink"===b)d=this.getParentNode(),"A"===a(d).get(0).tagName?a(d).replaceWith(a(d).text()):this.execRun(b,c);else if("JustifyLeft"===b||"JustifyCenter"===b||"JustifyRight"===b||"JustifyFull"===b){d=this.getCurrentNode();var e=a(d).get(0).tagName;if(this.opts.iframe===!1&&0==a(d).parents(".redactor_editor").size())return!1;var f=["P","DIV","H1","H2","H3","H4","H5","H6","BLOCKQUOTE","TD"];if(-1!=a.inArray(e,f)){var g=!1;"JustifyCenter"===b?g="center":"JustifyRight"===b?g="right":"JustifyFull"===b&&(g="justify"),g===!1?a(d).css("text-align",""):a(d).css("text-align",g)}else this.execRun(b,c)}else if("formatblock"===b&&"blockquote"===c)if(d=this.getCurrentNode(),"BLOCKQUOTE"===a(d).get(0).tagName)if(this.browser("msie")){var h=a("<p>"+a(d).html()+"</p>");a(d).replaceWith(h)}else this.execRun(b,"p");else if("P"===a(d).get(0).tagName){var i=a(d).parent();if("BLOCKQUOTE"===a(i).get(0).tagName){var h=a("<p>"+a(d).html()+"</p>");a(i).replaceWith(h),this.setSelection(h[0],0,h[0],0)}else if(this.browser("msie")){var h=a("<blockquote>"+a(d).html()+"</blockquote>");a(d).replaceWith(h)}else this.execRun(b,c)}else this.execRun(b,c);else"formatblock"!==b||"pre"!==c&&"p"!==c?("inserthorizontalrule"===b&&this.browser("msie")&&this.$editor.focus(),"formatblock"===b&&this.browser("mozilla")&&this.$editor.focus(),this.execRun(b,c)):(d=this.getParentNode(),"PRE"===a(d).get(0).tagName?a(d).replaceWith("<p>"+this.encodeEntities(a(d).text())+"</p>"):this.execRun(b,c));"inserthorizontalrule"===b&&this.$editor.find("hr").removeAttr("id"),this.syncCode(),this.oldIE()&&this.$editor.focus(),"function"==typeof this.opts.execCommandCallback&&this.opts.execCommandCallback(this,b),this.opts.air&&this.air.hide()}catch(j){}},execRun:function(a,b){"formatblock"===a&&this.browser("msie")&&(b="<"+b+">"),this.document.execCommand(a,!1,b)},formatNewLine:function(b){var c=this.getParentNode();if("DIV"===c.nodeName&&"redactor_editor"===c.className){var d=a(this.getCurrentNode());if("DIV"===d.get(0).tagName&&(""===d.html()||"<br>"===d.html())){var e=a("<p>").append(d.clone().get(0).childNodes);d.replaceWith(e),e.html("<br />"),this.setSelection(e[0],0,e[0],0)}}},safariShiftKeyEnter:function(b,c){return b.shiftKey&&13===c?(b.preventDefault(),this.insertNodeAtCaret(a("<span><br /></span>").get(0)),this.syncCode(),!1):!0},formatEmpty:function(b){var c=a.trim(this.$editor.html());this.browser("mozilla")&&(c=c.replace(/<br>/i,""));var d=c.replace(/<(?:.|\n)*?>/gm,"");if(""===c||""===d){b.preventDefault();var e=a(this.opts.emptyHtml).get(0);return this.$editor.html(e),this.setSelection(e,0,e,0),this.syncCode(),!1}this.syncCode()},paragraphy:function(b){if(b=a.trim(b),""===b||"<p></p>"===b)return this.opts.emptyHtml;this.opts.convertDivs&&(b=b.replace(/<div(.*?)>([\w\W]*?)<\/div>/gi,"<p>$2</p>"));var c=function(a,b,c){return a.replace(new RegExp(b,"g"),c)},d=function(a,d){return c(b,a,d)},e="(table|thead|tfoot|caption|colgroup|tbody|tr|td|th|div|dl|dd|dt|ul|ol|li|pre|select|form|blockquote|address|math|style|script|object|input|param|p|h[1-6])";return b+="\n",d("<br />\\s*<br />","\n\n"),d("(<"+e+"[^>]*>)","\n$1"),d("(</"+e+">)","$1\n\n"),d("\r\n|\r","\n"),d("\n\n+","\n\n"),d("\n?((.|\n)+?)$","<p>$1</p>\n"),d("<p>\\s*?</p>",""),d("<p>(<div[^>]*>\\s*)","$1<p>"),d("<p>([^<]+)\\s*?(</(div|address|form)[^>]*>)","<p>$1</p>$2"),d("<p>\\s*(</?"+e+"[^>]*>)\\s*</p>","$1"),d("<p>(<li.+?)</p>","$1"),d("<p>\\s*(</?"+e+"[^>]*>)","$1"),d("(</?"+e+"[^>]*>)\\s*</p>","$1"),d("(</?"+e+"[^>]*>)\\s*<br />","$1"),d("<br />(\\s*</?(p|li|div|dl|dd|dt|th|pre|td|ul|ol)[^>]*>)","$1"),-1!=b.indexOf("<pre")&&d("(<pre(.|\n)*?>)((.|\n)*?)</pre>",function(a,b,d,e){return c(b,"\\\\(['\"\\\\])","$1")+c(c(c(e,"<p>","\n"),"</p>|<br />",""),"\\\\(['\"\\\\])","$1")+"</pre>"}),d("\n</p>$","</p>")},stripTags:function(b){var c=this.opts.allowedTags,d=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi;return b.replace(d,function(b,d){return a.inArray(d.toLowerCase(),c)>"-1"?b:""})},savePreCode:function(b){var c=b.match(/<pre(.*?)>([\w\W]*?)<\/pre>/gi);return null!==c&&a.each(c,a.proxy(function(a,c){var d=c.match(/<pre(.*?)>([\w\W]*?)<\/pre>/i);d[2]=this.encodeEntities(d[2]),b=b.replace(c,"<pre"+d[1]+">"+d[2]+"</pre>")},this)),b},encodeEntities:function(a){return a=String(a).replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"'),String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},cleanupPre:function(a){a=a.replace(/<br>/gi,"\n"),a=a.replace(/<\/p>/gi,"\n"),a=a.replace(/<\/div>/gi,"\n");var b=this.document.createElement("div");return b.innerHTML=a,b.textContent||b.innerText},pasteCleanUp:function(b){var c=this.getParentNode();return"PRE"===a(c).get(0).tagName?(b=this.cleanupPre(b),this.pasteCleanUpInsert(b),!0):(b=b.replace(/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi,""),b=b.replace(/(&nbsp;){2,}/gi,"&nbsp;"),b=b.replace(/<b\sid="internal-source-marker(.*?)">([\w\W]*?)<\/b>/gi,"$2"),b=this.stripTags(b),b=b.replace(/<td><\/td>/gi,"[td]"),b=b.replace(/<td>&nbsp;<\/td>/gi,"[td]"),b=b.replace(/<td><br><\/td>/gi,"[td]"),b=b.replace(/<a(.*?)href="(.*?)"(.*?)>([\w\W]*?)<\/a>/gi,'[a href="$2"]$4[/a]'),b=b.replace(/<iframe(.*?)>([\w\W]*?)<\/iframe>/gi,"[iframe$1]$2[/iframe]"),b=b.replace(/<video(.*?)>([\w\W]*?)<\/video>/gi,"[video$1]$2[/video]"),b=b.replace(/<audio(.*?)>([\w\W]*?)<\/audio>/gi,"[audio$1]$2[/audio]"),b=b.replace(/<embed(.*?)>([\w\W]*?)<\/embed>/gi,"[embed$1]$2[/embed]"),b=b.replace(/<object(.*?)>([\w\W]*?)<\/object>/gi,"[object$1]$2[/object]"),b=b.replace(/<param(.*?)>/gi,"[param$1]"),b=b.replace(/<img(.*?)style="(.*?)"(.*?)>/gi,"[img$1$3]"),b=b.replace(/<(\w+)([\w\W]*?)>/gi,"<$1>"),b=b.replace(/<[^\/>][^>]*>(\s*|\t*|\n*|&nbsp;|<br>)<\/[^>]+>/gi,""),b=b.replace(/<[^\/>][^>]*>(\s*|\t*|\n*|&nbsp;|<br>)<\/[^>]+>/gi,""),b=b.replace(/\[td\]/gi,"<td>&nbsp;</td>"),b=b.replace(/\[a href="(.*?)"\]([\w\W]*?)\[\/a\]/gi,'<a href="$1">$2</a>'),b=b.replace(/\[iframe(.*?)\]([\w\W]*?)\[\/iframe\]/gi,"<iframe$1>$2</iframe>"),b=b.replace(/\[video(.*?)\]([\w\W]*?)\[\/video\]/gi,"<video$1>$2</video>"),b=b.replace(/\[audio(.*?)\]([\w\W]*?)\[\/audio\]/gi,"<audio$1>$2</audio>"),b=b.replace(/\[embed(.*?)\]([\w\W]*?)\[\/embed\]/gi,"<embed$1>$2</embed>"),b=b.replace(/\[object(.*?)\]([\w\W]*?)\[\/object\]/gi,"<object$1>$2</object>"),b=b.replace(/\[param(.*?)\]/gi,"<param$1>"),b=b.replace(/\[img(.*?)\]/gi,"<img$1>"),this.opts.convertDivs&&(b=b.replace(/<div(.*?)>([\w\W]*?)<\/div>/gi,"<p>$2</p>")),b=b.replace(/<span>([\w\W]*?)<\/span>/gi,"$1"),b=b.replace(/\n{3,}/gi,"\n"),b=b.replace(/<p><p>/gi,"<p>"),b=b.replace(/<\/p><\/p>/gi,"</p>"),this.browser("mozilla")&&(b=b.replace(/<br>$/gi,"")),void this.pasteCleanUpInsert(b))},pasteCleanUpInsert:function(b){this.execCommand("inserthtml",b),this.opts.autoresize===!0?a(this.document.body).scrollTop(this.saveScroll):this.$editor.scrollTop(this.saveScroll)},formattingRemove:function(b){var c=[],d=b.match(/<pre(.*?)>([\w\W]*?)<\/pre>/gi);return null!==d&&a.each(d,function(a,d){b=b.replace(d,"prebuffer_"+a),c.push(d)}),b=b.replace(/\s{2,}/g," "),b=b.replace(/\n/g," "),b=b.replace(/[\t]*/g,""),b=b.replace(/\n\s*\n/g,"\n"),b=b.replace(/^[\s\n]*/g,""),b=b.replace(/[\s\n]*$/g,""),b=b.replace(/>\s+</g,"><"),c&&(a.each(c,function(a,c){b=b.replace("prebuffer_"+a,c)}),c=[]),b},formattingIndenting:function(a){return a=a.replace(/<li/g,"	<li"),a=a.replace(/<tr/g,"	<tr"),a=a.replace(/<td/g,"		<td"),a=a.replace(/<\/tr>/g,"	</tr>")},formattingEmptyTags:function(a){for(var b=["<pre></pre>","<blockquote>\\s*</blockquote>","<em>\\s*</em>","<ul></ul>","<ol></ol>","<li></li>","<table></table>","<tr></tr>","<span>\\s*<span>","<span>&nbsp;<span>","<b>\\s*</b>","<b>&nbsp;</b>","<p>\\s*</p>","<p>&nbsp;</p>","<p>\\s*<br>\\s*</p>","<div>\\s*</div>","<div>\\s*<br>\\s*</div>"],c=0;c<b.length;++c){var d=b[c];a=a.replace(new RegExp(d,"gi"),"")}return a},formattingAddBefore:function(a){for(var b="\r\n",c=["<p","<form","</ul>","</ol>","<fieldset","<legend","<object","<embed","<select","<option","<input","<textarea","<pre","<blockquote","<ul","<ol","<li","<dl","<dt","<dd","<table","<thead","<tbody","<caption","</caption>","<th","<tr","<td","<figure"],d=0;d<c.length;++d){
var e=c[d];a=a.replace(new RegExp(e,"gi"),b+e)}return a},formattingAddAfter:function(a){for(var b="\r\n",c=["</p>","</div>","</h1>","</h2>","</h3>","</h4>","</h5>","</h6>","<br>","<br />","</dl>","</dt>","</dd>","</form>","</blockquote>","</pre>","</legend>","</fieldset>","</object>","</embed>","</textarea>","</select>","</option>","</table>","</thead>","</tbody>","</tr>","</td>","</th>","</figure>"],d=0;d<c.length;++d){var e=c[d];a=a.replace(new RegExp(e,"gi"),e+b)}return a},formatting:function(a){return a=this.formattingRemove(a),a=this.formattingEmptyTags(a),a=this.formattingAddBefore(a),a=this.formattingAddAfter(a),a=this.formattingIndenting(a)},toggle:function(){var a;if(this.opts.visual){var b=this.$editor.innerHeight();this.$editor.hide(),this.$content.hide(),a=this.$editor.html(),this.$el.height(b).val(a).show().focus(),this.setBtnActive("html"),this.opts.visual=!1}else{this.$el.hide();var a=this.$el.val();this.$editor.html(a).show(),this.$content.show(),""===this.$editor.html()&&this.setCode(this.opts.emptyHtml),this.$editor.focus(),this.setBtnInactive("html"),this.opts.visual=!0,this.observeImages(),this.observeTables()}},autoSave:function(){this.autosaveInterval=setInterval(a.proxy(function(){a.ajax({url:this.opts.autosave,type:"post",data:this.$el.attr("name")+"="+escape(encodeURIComponent(this.getCode())),success:a.proxy(function(a){"function"==typeof this.opts.autosaveCallback&&this.opts.autosaveCallback(a,this)},this)})},this),1e3*this.opts.interval)},buildToolbar:function(){return this.opts.toolbar===!1?!1:(this.$toolbar=a("<ul>").addClass("redactor_toolbar"),this.opts.air?(a(this.air).append(this.$toolbar),a("body").append(this.air)):this.opts.toolbarExternal===!1?this.$box.prepend(this.$toolbar):a(this.opts.toolbarExternal).html(this.$toolbar),void a.each(this.opts.buttons,a.proxy(function(b,c){if("|"!==c&&"undefined"!=typeof this.opts.toolbar[c]){var d=this.opts.toolbar[c];if(this.opts.fileUpload===!1&&"file"===c)return!0;this.$toolbar.append(a("<li>").append(this.buildButton(c,d)))}"|"===c&&this.$toolbar.append(a('<li class="redactor_separator"></li>'))},this)))},buildButton:function(b,c){var d=a('<a href="javascript:void(null);" title="'+c.title+'" class="redactor_btn_'+b+'"></a>');if("undefined"==typeof c.func?d.click(a.proxy(function(){-1!=a.inArray(b,this.opts.activeButtons)&&(this.inactiveAllButtons(),this.setBtnActive(b)),this.browser("mozilla")&&this.$editor.focus(),this.execCommand(c.exec,b)},this)):"show"!==c.func&&d.click(a.proxy(function(a){this[c.func](a)},this)),"undefined"!=typeof c.callback&&c.callback!==!1&&d.click(a.proxy(function(a){c.callback(this,a,b)},this)),"backcolor"===b||"fontcolor"===b||"undefined"!=typeof c.dropdown){var e=a('<div class="redactor_dropdown" style="display: none;">');e="backcolor"===b||"fontcolor"===b?this.buildColorPicker(e,b):this.buildDropdown(e,c.dropdown),this.dropdowns.push(e.appendTo(a(document.body))),this.hdlShowDropDown=a.proxy(function(a){this.showDropDown(a,e,b)},this),d.click(this.hdlShowDropDown)}return d},buildDropdown:function(b,c){return a.each(c,a.proxy(function(c,d){"undefined"==typeof d.className&&(d.className="");var e;"undefined"!=typeof d.name&&"separator"===d.name?e=a('<a class="redactor_separator_drop">'):(e=a('<a href="javascript:void(null);" class="'+d.className+'">'+d.title+"</a>"),"function"==typeof d.callback?a(e).click(a.proxy(function(a){d.callback(this,a,c)},this)):"undefined"==typeof d.func?a(e).click(a.proxy(function(){this.execCommand(d.exec,c)},this)):a(e).click(a.proxy(function(a){this[d.func](a)},this))),a(b).append(e)},this)),b},buildColorPicker:function(b,c){var d;d="backcolor"===c?this.browser("msie")?"BackColor":"hilitecolor":"forecolor",a(b).width(210);for(var e=this.opts.colors.length,f=0;e>f;++f){var g=this.opts.colors[f],h=a('<a rel="'+g+'" href="javascript:void(null);" class="redactor_color_link"></a>').css({backgroundColor:g});a(b).append(h);var i=this;a(h).click(function(){i.execCommand(d,a(this).attr("rel")),"forecolor"===d&&i.$editor.find("font").replaceWith(function(){return a('<span style="color: '+a(this).attr("color")+';">'+a(this).html()+"</span>")}),i.browser("msie")&&"BackColor"===d&&i.$editor.find("font").replaceWith(function(){return a('<span style="'+a(this).attr("style")+'">'+a(this).html()+"</span>")})})}var j=a('<a href="javascript:void(null);" class="redactor_color_none"></a>').html(RLANG.none);return"backcolor"===c?j.click(a.proxy(this.setBackgroundNone,this)):j.click(a.proxy(this.setColorNone,this)),a(b).append(j),b},setBackgroundNone:function(){a(this.getParentNode()).css("background-color","transparent"),this.syncCode()},setColorNone:function(){a(this.getParentNode()).attr("color","").css("color",""),this.syncCode()},showDropDown:function(b,c,d){if(this.getBtn(d).hasClass("dropact"))this.hideAllDropDown();else{this.hideAllDropDown(),this.setBtnActive(d),this.getBtn(d).addClass("dropact");var e=this.getBtn(d).offset().left;if(this.opts.air){var f=this.air.offset().top;a(c).css({position:"absolute",left:e+"px",top:f+30+"px"}).show()}else if(this.opts.fixed&&this.fixed)a(c).css({position:"fixed",left:e+"px",top:"30px"}).show();else{var g=this.$toolbar.offset().top+30;a(c).css({position:"absolute",left:e+"px",top:g+"px"}).show()}}var h=a.proxy(function(a){this.hideDropDown(a,c,d)},this);a(document).one("click",h),this.$editor.one("click",h),this.$content.one("click",h),b.stopPropagation()},hideAllDropDown:function(){this.$toolbar.find("a.dropact").removeClass("redactor_act").removeClass("dropact"),a(".redactor_dropdown").hide()},hideDropDown:function(b,c,d){a(b.target).hasClass("dropact")||(a(c).removeClass("dropact"),this.showedDropDown=!1,this.hideAllDropDown())},getBtn:function(b){return this.opts.toolbar===!1?!1:a(this.$toolbar.find("a.redactor_btn_"+b))},setBtnActive:function(a){this.getBtn(a).addClass("redactor_act")},setBtnInactive:function(a){this.getBtn(a).removeClass("redactor_act")},inactiveAllButtons:function(){a.each(this.opts.activeButtons,a.proxy(function(a,b){this.setBtnInactive(b)},this))},changeBtnIcon:function(a,b){this.getBtn(a).addClass("redactor_btn_"+b)},removeBtnIcon:function(a,b){this.getBtn(a).removeClass("redactor_btn_"+b)},addBtnSeparator:function(){this.$toolbar.append(a('<li class="redactor_separator"></li>'))},addBtnSeparatorAfter:function(b){var c=this.getBtn(b);c.parent().after(a('<li class="redactor_separator"></li>'))},addBtnSeparatorBefore:function(b){var c=this.getBtn(b);c.parent().before(a('<li class="redactor_separator"></li>'))},removeBtnSeparatorAfter:function(a){var b=this.getBtn(a);b.parent().next().remove()},removeBtnSeparatorBefore:function(a){var b=this.getBtn(a);b.parent().prev().remove()},setBtnRight:function(a){return this.opts.toolbar===!1?!1:void this.getBtn(a).parent().addClass("redactor_btn_right")},setBtnLeft:function(a){return this.opts.toolbar===!1?!1:void this.getBtn(a).parent().removeClass("redactor_btn_right")},addBtn:function(b,c,d,e){if(this.opts.toolbar===!1)return!1;var f=this.buildButton(b,{title:c,callback:d,dropdown:e});this.$toolbar.append(a("<li>").append(f))},addBtnFirst:function(b,c,d,e){if(this.opts.toolbar===!1)return!1;var f=this.buildButton(b,{title:c,callback:d,dropdown:e});this.$toolbar.prepend(a("<li>").append(f))},addBtnAfter:function(b,c,d,e,f){if(this.opts.toolbar===!1)return!1;var g=this.buildButton(c,{title:d,callback:e,dropdown:f}),h=this.getBtn(b);h.parent().after(a("<li>").append(g))},addBtnBefore:function(b,c,d,e,f){if(this.opts.toolbar===!1)return!1;var g=this.buildButton(c,{title:d,callback:e,dropdown:f}),h=this.getBtn(b);h.parent().before(a("<li>").append(g))},removeBtn:function(a,b){var c=this.getBtn(a);b===!0&&c.parent().next().remove(),c.parent().removeClass("redactor_btn_right"),c.remove()},getFragmentHtml:function(a){var b=a.cloneNode(!0),c=this.document.createElement("div");return c.appendChild(b),c.innerHTML},extractContent:function(){for(var a,b=this.$editor.get(0),c=this.document.createDocumentFragment();a=b.firstChild;)c.appendChild(a);return c},saveSelection:function(){this.$editor.focus(),this.savedSel=this.getOrigin(),this.savedSelObj=this.getFocus()},restoreSelection:function(){"undefined"!=typeof this.savedSel&&null!==this.savedSel&&null!==this.savedSelObj&&"BODY"!==this.savedSel[0].tagName?this.opts.iframe===!1&&0==a(this.savedSel[0]).closest(".redactor_editor").size()?this.$editor.focus():(this.browser("opera")&&this.$editor.focus(),this.setSelection(this.savedSel[0],this.savedSel[1],this.savedSelObj[0],this.savedSelObj[1]),this.browser("mozilla")&&this.$editor.focus()):this.$editor.focus()},getSelection:function(){var a=this.document;return this.window.getSelection?this.window.getSelection():a.getSelection?a.getSelection():a.selection.createRange()},hasSelection:function(){if(this.oldIE()){var a,b=this.$editor.get(0);return b.focus(),b.document.selection?(a=b.document.selection.createRange(),a&&a.parentElement().document===b.document):!1}var c;return(c=this.getSelection())&&null!=c.focusNode&&null!=c.anchorNode},getOrigin:function(){if(this.oldIE()){var a,b=this.$editor.get(0);return b.focus(),this.hasSelection()?(a=b.document.selection.createRange(),this._getBoundary(b.document,a,!0)):null}var c;return(c=this.getSelection())&&null!=c.anchorNode?[c.anchorNode,c.anchorOffset]:null},getFocus:function(){if(this.oldIE()){var a,b=this.$editor.get(0);return b.focus(),this.hasSelection()?(a=b.document.selection.createRange(),this._getBoundary(b.document,a,!1)):null}var c;return(c=this.getSelection())&&null!=c.focusNode?[c.focusNode,c.focusOffset]:null},setSelection:function(a,b,c,d){if(null==c&&(c=a),null==d&&(d=b),this.oldIE()){var e=this.$editor.get(0),f=e.document.body.createTextRange();return this._moveBoundary(e.document,f,!1,c,d),this._moveBoundary(e.document,f,!0,a,b),f.select()}var g=this.getSelection();if(g)if(g.collapse&&g.extend)g.collapse(a,b),g.extend(c,d);else{r=this.document.createRange(),r.setStart(a,b),r.setEnd(c,d);try{g.removeAllRanges()}catch(h){}g.addRange(r)}},getCurrentNode:function(){return"undefined"!=typeof this.window.getSelection?this.getSelectedNode().parentNode:"undefined"!=typeof this.document.selection?this.getSelection().parentElement():void 0},getParentNode:function(){return a(this.getCurrentNode()).parent()[0]},getSelectedNode:function(){if(this.oldIE())return this.getSelection().parentElement();if("undefined"!=typeof this.window.getSelection){var a=this.window.getSelection();return a.rangeCount>0?this.getSelection().getRangeAt(0).commonAncestorContainer:!1}return"undefined"!=typeof this.document.selection?this.getSelection():void 0},_getBoundary:function(a,b,c){var d,e,f,g,h;for(e=a.createElement("a"),d=b.duplicate(),d.collapse(c),h=d.parentElement();;)if(h.insertBefore(e,e.previousSibling),d.moveToElementText(e),!(d.compareEndPoints(c?"StartToStart":"StartToEnd",b)>0&&null!=e.previousSibling))break;return-1===d.compareEndPoints(c?"StartToStart":"StartToEnd",b)&&e.nextSibling?(d.setEndPoint(c?"EndToStart":"EndToEnd",b),f=e.nextSibling,g=d.text.length):(f=e.parentNode,g=this._getChildIndex(e)),e.parentNode.removeChild(e),[f,g]},_moveBoundary:function(a,b,c,d,e){var f,g,h,i,j;return j=0,f=this._isText(d)?d:d.childNodes[e],g=this._isText(d)?d.parentNode:d,this._isText(d)&&(j=e),i=a.createElement("a"),g.insertBefore(i,f||null),h=a.body.createTextRange(),h.moveToElementText(i),i.parentNode.removeChild(i),b.setEndPoint(c?"StartToStart":"EndToEnd",h),b[c?"moveStart":"moveEnd"]("character",j)},_isText:function(a){return null!=a?3==a.nodeType:!1},_getChildIndex:function(a){for(var b=0;a=a.previousSibling;)b++;return b},insertNodeAfterCaret:function(a){this.saveSelection(),this.insertNodeAtCaret(a),this.restoreSelection()},insertNodeAtCaret:function(a){if(this.window.getSelection){var b=this.getSelection();if(b.rangeCount){var c=b.getRangeAt(0);c.collapse(!1),c.insertNode(a),c=c.cloneRange(),c.selectNodeContents(a),c.collapse(!1),b.removeAllRanges(),b.addRange(c)}}else if(this.document.selection){var d=1===a.nodeType?a.outerHTML:a.data,e="marker_"+(""+Math.random()).slice(2);d+='<span id="'+e+'"></span>';var f=this.getSelection();f.collapse(!1),f.pasteHTML(d);var g=this.document.getElementById(e);f.moveToElementText(g),f.select(),g.parentNode.removeChild(g)}},getSelectedHtml:function(){var a="";if(this.window.getSelection){var b=this.window.getSelection();if(b.rangeCount){for(var c=this.document.createElement("div"),d=0,e=b.rangeCount;e>d;++d)c.appendChild(b.getRangeAt(d).cloneContents());a=c.innerHTML}}else this.document.selection&&"Text"===this.document.selection.type&&(a=this.document.selection.createRange().htmlText);return a},resizeImage:function(b){var c,d,e=!1,f=!1,g=a(b).width()/a(b).height(),h=10,i=10;a(b).off("hover mousedown mouseup click mousemove"),a(b).hover(function(){a(b).css("cursor","nw-resize")},function(){a(b).css("cursor",""),e=!1}),a(b).mousedown(function(h){h.preventDefault(),g=a(b).width()/a(b).height(),e=!0,f=!0,c=Math.round(h.pageX-a(b).eq(0).offset().left),d=Math.round(h.pageY-a(b).eq(0).offset().top)}),a(b).mouseup(a.proxy(function(c){e=!1,a(b).css("cursor",""),this.syncCode()},this)),a(b).click(a.proxy(function(a){f&&this.imageEdit(a)},this)),a(b).mousemove(function(j){if(e){f=!1;var k=(Math.round(j.pageX-a(this).eq(0).offset().left)-c,Math.round(j.pageY-a(this).eq(0).offset().top)-d),l=a(b).height(),m=parseInt(l,10)+k,n=m*g;n>h&&a(b).width(n),m>i&&a(b).height(m),c=Math.round(j.pageX-a(this).eq(0).offset().left),d=Math.round(j.pageY-a(this).eq(0).offset().top)}})},showTable:function(){this.saveSelection(),this.modalInit(RLANG.table,this.opts.modal_table,300,a.proxy(function(){a("#redactor_insert_table_btn").click(a.proxy(this.insertTable,this)),setTimeout(function(){a("#redactor_table_rows").focus()},200)},this))},insertTable:function(){for(var b=a("#redactor_table_rows").val(),c=a("#redactor_table_columns").val(),d=a("<div></div>"),e=Math.floor(99999*Math.random()),f=a('<table id="table'+e+'"><tbody></tbody></table>'),g=0;b>g;g++){for(var h=a("<tr></tr>"),i=0;c>i;i++){var j=a("<td><br></td>");a(h).append(j)}a(f).append(h)}a(d).append(f);var k=a(d).html()+"<p></p>";this.restoreSelection(),this.execCommand("inserthtml",k),this.modalClose(),this.observeTables()},tableObserver:function(b){this.$table=a(b.target).closest("table"),this.$table_tr=this.$table.find("tr"),this.$table_td=this.$table.find("td"),this.$tbody=a(b.target).closest("tbody"),this.$thead=a(this.$table).find("thead"),this.$current_td=a(b.target),this.$current_tr=a(b.target).closest("tr")},deleteTable:function(){a(this.$table).remove(),this.$table=!1,this.syncCode()},deleteRow:function(){a(this.$current_tr).remove(),this.syncCode()},deleteColumn:function(){var b=a(this.$current_td).get(0).cellIndex;a(this.$table).find("tr").each(function(){a(this).find("td").eq(b).remove()}),this.syncCode()},addHead:function(){if(0!==a(this.$table).find("thead").size())this.deleteHead();else{var b=a(this.$table).find("tr").first().clone();b.find("td").html("&nbsp;"),this.$thead=a("<thead></thead>"),this.$thead.append(b),a(this.$table).prepend(this.$thead),this.syncCode()}},deleteHead:function(){a(this.$thead).remove(),this.$thead=!1,this.syncCode()},insertRowAbove:function(){this.insertRow("before")},insertRowBelow:function(){this.insertRow("after")},insertColumnLeft:function(){this.insertColumn("before")},insertColumnRight:function(){this.insertColumn("after")},insertRow:function(b){var c=a(this.$current_tr).clone();c.find("td").html("&nbsp;"),"after"===b?a(this.$current_tr).after(c):a(this.$current_tr).before(c),this.syncCode()},insertColumn:function(b){var c=0;this.$current_tr.find("td").each(a.proxy(function(b,d){a(d)[0]===this.$current_td[0]&&(c=b)},this)),this.$table_tr.each(function(d,e){var f=a(e).find("td").eq(c),g=f.clone();g.html("&nbsp;"),"after"===b?a(f).after(g):a(f).before(g)}),this.syncCode()},showVideo:function(){this.saveSelection(),this.modalInit(RLANG.video,this.opts.modal_video,600,a.proxy(function(){a("#redactor_insert_video_btn").click(a.proxy(this.insertVideo,this)),setTimeout(function(){a("#redactor_insert_video_area").focus()},200)},this))},insertVideo:function(){var b=a("#redactor_insert_video_area").val();b=this.stripTags(b),this.restoreSelection(),this.execCommand("inserthtml",b),this.modalClose()},imageEdit:function(b){var c=a(b.target),d=c.parent(),e=a.proxy(function(){a("#redactor_file_alt").val(c.attr("alt")),a("#redactor_image_edit_src").attr("href",c.attr("src")),a("#redactor_form_image_align").val(c.css("float")),"A"===a(d).get(0).tagName&&a("#redactor_file_link").val(a(d).attr("href")),a("#redactor_image_delete_btn").click(a.proxy(function(){this.imageDelete(c)},this)),a("#redactorSaveBtn").click(a.proxy(function(){this.imageSave(c)},this))},this);this.modalInit(RLANG.image,this.opts.modal_image_edit,380,e)},imageDelete:function(b){a(b).remove(),this.modalClose(),this.syncCode()},imageSave:function(b){var c=a(b).parent();a(b).attr("alt",a("#redactor_file_alt").val());var d=a("#redactor_form_image_align").val();"left"===d?a(b).css({"float":"left",margin:"0 10px 10px 0"}):"right"===d?a(b).css({"float":"right",margin:"0 0 10px 10px"}):a(b).css({"float":"none",margin:"0"});var e=a.trim(a("#redactor_file_link").val());""!==e?"A"!==a(c).get(0).tagName?a(b).replaceWith('<a href="'+e+'">'+this.outerHTML(b)+"</a>"):a(c).attr("href",e):"A"===a(c).get(0).tagName&&a(c).replaceWith(this.outerHTML(b)),this.modalClose(),this.observeImages(),this.syncCode()},showImage:function(){this.saveSelection();var b=a.proxy(function(){if(this.opts.imageGetJson!==!1?a.getJSON(this.opts.imageGetJson,a.proxy(function(b){var c={},d=0;a.each(b,a.proxy(function(a,b){"undefined"!=typeof b.folder&&(d++,c[b.folder]=d)},this));var e=!1;if(a.each(b,a.proxy(function(b,d){var f="";"undefined"!=typeof d.title&&(f=d.title);var g=0;a.isEmptyObject(c)||"undefined"==typeof d.folder||(g=c[d.folder],e===!1&&(e=".redactorfolder"+g));var h=a('<img src="'+d.thumb+'" class="redactorfolder redactorfolder'+g+'" rel="'+d.image+'" title="'+f+'" />');a("#redactor_image_box").append(h),a(h).click(a.proxy(this.imageSetThumb,this))},this)),!a.isEmptyObject(c)){a(".redactorfolder").hide(),a(e).show();var f=function(b){a(".redactorfolder").hide(),a(".redactorfolder"+a(b.target).val()).show()},g=a('<select id="redactor_image_box_select">');a.each(c,function(b,c){g.append(a('<option value="'+c+'">'+b+"</option>"))}),a("#redactor_image_box").before(g),g.change(f)}},this)):a("#redactor_tabs a").eq(1).remove(),this.opts.imageUpload!==!1)this.opts.uploadCrossDomain===!1&&this.isMobile()===!1&&0!==a("#redactor_file").size()&&a("#redactor_file").dragupload({url:this.opts.imageUpload,uploadFields:this.opts.uploadFields,success:a.proxy(this.imageUploadCallback,this),error:a.proxy(this.opts.imageUploadErrorCallback,this)}),this.uploadInit("redactor_file",{auto:!0,url:this.opts.imageUpload,success:a.proxy(this.imageUploadCallback,this),error:a.proxy(this.opts.imageUploadErrorCallback,this)});else if(a(".redactor_tab").hide(),this.opts.imageGetJson===!1)a("#redactor_tabs").remove(),a("#redactor_tab3").show();else{var b=a("#redactor_tabs a");b.eq(0).remove(),b.eq(1).addClass("redactor_tabs_act"),a("#redactor_tab2").show()}a("#redactor_upload_btn").click(a.proxy(this.imageUploadCallbackLink,this)),this.opts.imageUpload===!1&&this.opts.imageGetJson===!1&&setTimeout(function(){a("#redactor_file_link").focus()},200)},this);this.modalInit(RLANG.image,this.opts.modal_image,610,b)},imageSetThumb:function(b){this._imageSet('<img src="'+a(b.target).attr("rel")+'" alt="'+a(b.target).attr("title")+'" />',!0)},imageUploadCallbackLink:function(){if(""!==a("#redactor_file_link").val()){var b='<img src="'+a("#redactor_file_link").val()+'" />';this._imageSet(b,!0)}else this.modalClose()},imageUploadCallback:function(a){this._imageSet(a)},_imageSet:function(a,b){if(this.restoreSelection(),a!==!1){var c="";c=b!==!0?'<p><img src="'+a.filelink+'" /></p>':a,this.execCommand("inserthtml",c),b!==!0&&"function"==typeof this.opts.imageUploadCallback&&this.opts.imageUploadCallback(this,a)}this.modalClose(),this.observeImages()},showLink:function(){this.saveSelection();var b=a.proxy(function(){this.insert_link_node=!1;var b=this.getSelection(),c="",d="",e="";if(this.browser("msie")){var f=this.getParentNode();"A"===f.nodeName?(this.insert_link_node=a(f),d=this.insert_link_node.text(),c=this.insert_link_node.attr("href"),e=this.insert_link_node.attr("target")):d=this.oldIE()?b.text:b.toString()}else b&&b.anchorNode&&"A"===b.anchorNode.parentNode.tagName?(c=b.anchorNode.parentNode.href,d=b.anchorNode.parentNode.text,e=b.anchorNode.parentNode.target,""===b.toString()&&(this.insert_link_node=b.anchorNode.parentNode)):d=b.toString();a(".redactor_link_text").val(d);var g=self.location.href.replace(/\/$/i,""),h=c.replace(g,"");0===c.search("mailto:")?(this.setModalTab(2),a("#redactor_tab_selected").val(2),a("#redactor_link_mailto").val(c.replace("mailto:",""))):0===h.search(/^#/gi)?(this.setModalTab(3),a("#redactor_tab_selected").val(3),a("#redactor_link_anchor").val(h.replace(/^#/gi,""))):a("#redactor_link_url").val(h),"_blank"===e&&a("#redactor_link_blank").attr("checked",!0),a("#redactor_insert_link_btn").click(a.proxy(this.insertLink,this)),setTimeout(function(){a("#redactor_link_url").focus()},200)},this);this.modalInit(RLANG.link,this.opts.modal_link,460,b)},insertLink:function(){var b=a("#redactor_tab_selected").val(),c="",d="",e="";if("1"===b){c=a("#redactor_link_url").val(),d=a("#redactor_link_url_text").val(),a("#redactor_link_blank").attr("checked")&&(e=' target="_blank"');var f="/(w+:{0,1}w*@)?(S+)(:[0-9]+)?(/|/([w#!:.?+=&%@!-/]))?/",g=new RegExp("^(http|ftp|https)://"+f,"i"),h=new RegExp("^"+f,"i");-1==c.search(g)&&0==c.search(h)&&this.opts.protocol!==!1&&(c=this.opts.protocol+c)}else"2"===b?(c="mailto:"+a("#redactor_link_mailto").val(),d=a("#redactor_link_mailto_text").val()):"3"===b&&(c="#"+a("#redactor_link_anchor").val(),d=a("#redactor_link_anchor_text").val());this._insertLink('<a href="'+c+'"'+e+">"+d+"</a>",a.trim(d),c,e)},_insertLink:function(b,c,d,e){this.$editor.focus(),this.restoreSelection(),""!==c&&(this.insert_link_node?(a(this.insert_link_node).text(c),a(this.insert_link_node).attr("href",d),""!==e?a(this.insert_link_node).attr("target",e):a(this.insert_link_node).removeAttr("target"),this.syncCode()):this.execCommand("inserthtml",b)),this.modalClose()},showFile:function(){this.saveSelection();var b=a.proxy(function(){var b=this.getSelection(),c="";c=this.oldIE()?b.text:b.toString(),a("#redactor_filename").val(c),this.opts.uploadCrossDomain===!1&&this.isMobile()===!1&&a("#redactor_file").dragupload({url:this.opts.fileUpload,uploadFields:this.opts.uploadFields,success:a.proxy(this.fileUploadCallback,this),error:a.proxy(this.opts.fileUploadErrorCallback,this)}),this.uploadInit("redactor_file",{auto:!0,url:this.opts.fileUpload,success:a.proxy(this.fileUploadCallback,this),error:a.proxy(this.opts.fileUploadErrorCallback,this)})},this);this.modalInit(RLANG.file,this.opts.modal_file,500,b)},fileUploadCallback:function(b){if(this.restoreSelection(),b!==!1){var c=a("#redactor_filename").val();""===c&&(c=b.filename);var d='<a href="'+b.filelink+'">'+c+"</a>";this.browser("webkit")&&this.window.chrome&&(d+="&nbsp;"),this.execCommand("inserthtml",d),"function"==typeof this.opts.fileUploadCallback&&this.opts.fileUploadCallback(this,b)}this.modalClose()},modalInit:function(b,c,d,e){if(0===a("#redactor_modal_overlay").size()&&(this.overlay=a('<div id="redactor_modal_overlay" style="display: none;"></div>'),a("body").prepend(this.overlay)),this.opts.overlay&&(a("#redactor_modal_overlay").show(),a("#redactor_modal_overlay").click(a.proxy(this.modalClose,this))),0===a("#redactor_modal").size()&&(this.modal=a('<div id="redactor_modal" style="display: none;"><div id="redactor_modal_close">&times;</div><div id="redactor_modal_header"></div><div id="redactor_modal_inner"></div></div>'),a("body").append(this.modal)),a("#redactor_modal_close").click(a.proxy(this.modalClose,this)),this.hdlModalClose=a.proxy(function(a){return 27===a.keyCode?(this.modalClose(),!1):void 0},this),a(document).keyup(this.hdlModalClose),this.$editor.keyup(this.hdlModalClose),0==c.indexOf("#")?a("#redactor_modal_inner").empty().append(a(c).html()):a("#redactor_modal_inner").empty().append(c),a("#redactor_modal_header").html(b),"undefined"!=typeof a.fn.draggable&&(a("#redactor_modal").draggable({handle:"#redactor_modal_header"}),a("#redactor_modal_header").css("cursor","move")),0!==a("#redactor_tabs").size()){var f=this;a("#redactor_tabs a").each(function(b,c){b++,a(c).click(function(){if(a("#redactor_tabs a").removeClass("redactor_tabs_act"),a(this).addClass("redactor_tabs_act"),a(".redactor_tab").hide(),a("#redactor_tab"+b).show(),a("#redactor_tab_selected").val(b),f.isMobile()===!1){var c=a("#redactor_modal").outerHeight();a("#redactor_modal").css("margin-top","-"+(c+10)/2+"px")}})})}a("#redactor_modal .redactor_btn_modal_close").click(a.proxy(this.modalClose,this)),this.isMobile()===!1?(a("#redactor_modal").css({position:"fixed",top:"-2000px",left:"50%",width:d+"px",marginLeft:"-"+(d+60)/2+"px"}).show(),this.modalSaveBodyOveflow=a(document.body).css("overflow"),a(document.body).css("overflow","hidden")):a("#redactor_modal").css({position:"fixed",width:"100%",height:"100%",top:"0",left:"0",margin:"0",minHeight:"300px"}).show(),"function"==typeof e&&e(),this.isMobile()===!1&&setTimeout(function(){var b=a("#redactor_modal").outerHeight();a("#redactor_modal").css({top:"50%",height:"auto",minHeight:"auto",marginTop:"-"+(b+10)/2+"px"})},20)},modalClose:function(){return a("#redactor_modal_close").unbind("click",this.modalClose),a("#redactor_modal").fadeOut("fast",a.proxy(function(){a("#redactor_modal_inner").html(""),this.opts.overlay&&(a("#redactor_modal_overlay").hide(),a("#redactor_modal_overlay").unbind("click",this.modalClose)),a(document).unbind("keyup",this.hdlModalClose),this.$editor.unbind("keyup",this.hdlModalClose)},this)),this.isMobile()===!1&&a(document.body).css("overflow",this.modalSaveBodyOveflow?this.modalSaveBodyOveflow:"visible"),!1},setModalTab:function(b){a(".redactor_tab").hide();var c=a("#redactor_tabs a");c.removeClass("redactor_tabs_act"),c.eq(b-1).addClass("redactor_tabs_act"),a("#redactor_tab"+b).show()},uploadInit:function(b,c){this.uploadOptions={url:!1,success:!1,error:!1,start:!1,trigger:!1,auto:!1,input:!1},a.extend(this.uploadOptions,c),0!==a("#"+b).size()&&"INPUT"===a("#"+b).get(0).tagName?(this.uploadOptions.input=a("#"+b),this.element=a(a("#"+b).get(0).form)):this.element=a("#"+b),this.element_action=this.element.attr("action"),this.uploadOptions.auto?a(this.uploadOptions.input).change(a.proxy(function(){this.element.submit(function(a){return!1}),this.uploadSubmit()},this)):this.uploadOptions.trigger&&a("#"+this.uploadOptions.trigger).click(a.proxy(this.uploadSubmit,this))},uploadSubmit:function(){this.uploadForm(this.element,this.uploadFrame())},uploadFrame:function(){this.id="f"+Math.floor(99999*Math.random());var b=this.document.createElement("div"),c='<iframe style="display:none" id="'+this.id+'" name="'+this.id+'"></iframe>';return b.innerHTML=c,a(b).appendTo("body"),this.uploadOptions.start&&this.uploadOptions.start(),a("#"+this.id).load(a.proxy(this.uploadLoaded,this)),this.id},uploadForm:function(b,c){if(this.uploadOptions.input){var d="redactorUploadForm"+this.id,e="redactorUploadFile"+this.id;this.form=a('<form  action="'+this.uploadOptions.url+'" method="POST" target="'+c+'" name="'+d+'" id="'+d+'" enctype="multipart/form-data"></form>'),this.opts.uploadFields!==!1&&"object"==typeof this.opts.uploadFields&&a.each(this.opts.uploadFields,a.proxy(function(b,c){0===c.toString().indexOf("#")&&(c=a(c).val());var d=a("<input/>",{type:"hidden",name:b,value:c});a(this.form).append(d)},this));var f=this.uploadOptions.input,g=a(f).clone();a(f).attr("id",e),a(f).before(g),a(f).appendTo(this.form),a(this.form).css("position","absolute"),a(this.form).css("top","-2000px"),a(this.form).css("left","-2000px"),a(this.form).appendTo("body"),this.form.submit()}else b.attr("target",c),b.attr("method","POST"),b.attr("enctype","multipart/form-data"),b.attr("action",this.uploadOptions.url),this.element.submit()},uploadLoaded:function(){var b,c=a("#"+this.id)[0];if(b=c.contentDocument?c.contentDocument:c.contentWindow?c.contentWindow.document:window.frames[this.id].document,this.uploadOptions.success)if("undefined"!=typeof b){var d=b.body.innerHTML,e=d.match(/\{(.|\n)*\}/)[0],f=a.parseJSON(e);"undefined"==typeof f.error?this.uploadOptions.success(f):(this.uploadOptions.error(this,f),this.modalClose())}else alert("Upload failed!"),this.modalClose();this.element.attr("action",this.element_action),this.element.attr("target","")},browser:function(a){var b=navigator.userAgent.toLowerCase(),c=/(chrome)[ \/]([\w.]+)/.exec(b)||/(webkit)[ \/]([\w.]+)/.exec(b)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(b)||/(msie) ([\w.]+)/.exec(b)||b.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(b)||[];return"version"==a?c[2]:"webkit"==a?"chrome"==c[1]||"webkit"==c[1]:c[1]==a},oldIE:function(){return this.browser("msie")&&parseInt(this.browser("version"),10)<9?!0:!1},outerHTML:function(b){return a("<p>").append(a(b).eq(0).clone()).html()},normalize:function(a){return parseInt(a.replace("px",""),10)},isMobile:function(a){return a===!0&&/(iPhone|iPod|iPad|BlackBerry|Android)/.test(navigator.userAgent)?!0:/(iPhone|iPod|BlackBerry|Android)/.test(navigator.userAgent)?!0:!1}},a.fn.getObject=function(){return this.data("redactor")},a.fn.getEditor=function(){return this.data("redactor").$editor},a.fn.getCode=function(){return a.trim(this.data("redactor").getCode())},a.fn.getText=function(){return this.data("redactor").$editor.text()},a.fn.getSelected=function(){return this.data("redactor").getSelectedHtml()},a.fn.setCode=function(a){this.data("redactor").setCode(a)},a.fn.insertHtml=function(a){this.data("redactor").insertHtml(a)},a.fn.destroyEditor=function(){this.each(function(){"undefined"!=typeof a(this).data("redactor")&&(a(this).data("redactor").destroy(),a(this).removeData("redactor"))})},a.fn.setFocus=function(){this.data("redactor").$editor.focus()},a.fn.execCommand=function(a,b){this.data("redactor").execCommand(a,b)}}(jQuery),function(a){function b(b,c){this.opts=a.extend({url:!1,success:!1,error:!1,preview:!1,uploadFields:!1,text:RLANG.drop_file_here,atext:RLANG.or_choose},c),this.$el=a(b)}a.fn.dragupload=function(a){return this.each(function(){var c=new b(this,a);c.init()})},b.prototype={init:function(){if(-1===navigator.userAgent.search("MSIE")){this.droparea=a('<div class="redactor_droparea"></div>'),this.dropareabox=a('<div class="redactor_dropareabox">'+this.opts.text+"</div>"),this.dropalternative=a('<div class="redactor_dropalternative">'+this.opts.atext+"</div>"),this.droparea.append(this.dropareabox),this.$el.before(this.droparea),this.$el.before(this.dropalternative),this.dropareabox.bind("dragover",a.proxy(function(){return this.ondrag()},this)),this.dropareabox.bind("dragleave",a.proxy(function(){return this.ondragleave()},this));var b=a.proxy(function(a){var b=parseInt(a.loaded/a.total*100,10);this.dropareabox.text("Loading "+b+"%")},this),c=jQuery.ajaxSettings.xhr();c.upload&&c.upload.addEventListener("progress",b,!1);var d=function(){return c};this.dropareabox.get(0).ondrop=a.proxy(function(b){b.preventDefault(),this.dropareabox.removeClass("hover").addClass("drop");var c=b.dataTransfer.files[0],e=new FormData;this.opts.uploadFields!==!1&&"object"==typeof this.opts.uploadFields&&a.each(this.opts.uploadFields,a.proxy(function(b,c){0===c.toString().indexOf("#")&&(c=a(c).val()),e.append(b,c)},this)),e.append("file",c),a.ajax({url:this.opts.url,dataType:"html",data:e,xhr:d,cache:!1,contentType:!1,processData:!1,type:"POST",success:a.proxy(function(b){var c=a.parseJSON(b);"undefined"==typeof c.error?this.opts.success(c):(this.opts.error(this,c),this.opts.success(!1))},this)})},this)}},ondrag:function(){return this.dropareabox.addClass("hover"),
!1},ondragleave:function(){return this.dropareabox.removeClass("hover"),!1}}}(jQuery),function(a){var b="http://",c=/(^|&lt;|\s)(www\..+?\..+?)(\s|&gt;|$)/g,d=/(^|&lt;|\s)(((https?|ftp):\/\/|mailto:).+?)(\s|&gt;|$)/g,e=function(){for(var f=this.childNodes,g=f.length;g--;){var h=f[g];if(3===h.nodeType){var i=h.nodeValue;i&&(i=i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(c,'$1<a href="'+b+'$2">$2</a>$3').replace(d,'$1<a href="$2">$2</a>$5'),a(h).after(i).remove())}else 1!==h.nodeType||/^(a|button|textarea)$/i.test(h.tagName)||e.call(h)}};a.fn.linkify=function(){this.each(e)}}(jQuery),function(a){a.fn.selectText=function(){var b=this[0];if(a.browser.msie){var c=b.offsetParent.createTextRange();c.moveToElementText(b),c.select()}else if(a.browser.mozilla||a.browser.opera){var d=b.ownerDocument.defaultView.getSelection(),c=b.ownerDocument.createRange();c.selectNodeContents(b),d.removeAllRanges(),d.addRange(c)}else if(a.browser.safari){var d=b.ownerDocument.defaultView.getSelection();d.setBaseAndExtent(b,0,b,1)}return this},a.event.special.textselect={setup:function(b,c){a(this).data("textselected",!1),a(this).bind("mouseup",a.event.special.textselect.handler)},teardown:function(b){a(this).unbind("mouseup",a.event.special.textselect.handler)},handler:function(b){var c=a.event.special.textselect.getSelectedText().toString();""!=c&&(a(this).data("textselected",!0),b.type="textselect",b.text=c,a.event.dispatch.apply(this,arguments))},getSelectedText:function(){var a="";return window.getSelection?a=window.getSelection():document.getSelection?a=document.getSelection():document.selection&&(a=document.selection.createRange().text),a}},a.event.special.textunselect={setup:function(b,c){a(this).data("textselected",!1),a(this).bind("mouseup",a.event.special.textunselect.handler),a(this).bind("keyup",a.event.special.textunselect.handlerKey)},teardown:function(b){a(this).unbind("mouseup",a.event.special.textunselect.handler)},handler:function(b){if(a(this).data("textselected")){var c=a.event.special.textselect.getSelectedText().toString();""==c&&(a(this).data("textselected",!1),b.type="textunselect",a.event.dispatch.apply(this,arguments))}},handlerKey:function(b){if(a(this).data("textselected")){var c=a.event.special.textselect.getSelectedText().toString();27==b.keyCode&&""==c&&(a(this).data("textselected",!1),b.type="textunselect",a.event.dispatch.apply(this,arguments))}}}}(jQuery),function(){$.fn.glDatePicker=function(a){var b="glDatePicker",c=this.data(b);return c?a===!0?c:this:this.each(function(){return $(this).data(b,new glDatePicker(this,a))})},$.fn.glDatePicker.defaults={cssName:"default",zIndex:1e3,borderSize:1,calendarOffset:{x:0,y:1},showAlways:!1,hideOnClick:!0,allowMonthSelect:!0,allowYearSelect:!0,todayDate:new Date,selectedDate:null,prevArrow:"◄",nextArrow:"►",selectableDates:null,selectableDateRange:null,specialDates:null,selectableMonths:null,selectableYears:null,selectableDOW:null,monthNames:null,dowNames:null,dowOffset:0,onClick:function(a,b,c,d){a.val(c.toLocaleDateString())},onHover:function(a,b,c,d){},onShow:function(a){a.show()},onHide:function(a){a.hide()},firstDate:null};var glDatePicker=function(){function glDatePicker(a,b){var c=this;c.el=$(a);var d=c.el;c.options=$.extend(!0,{},$.fn.glDatePicker.defaults,b);var e=c.options;c.calendar=$($.find("[gldp-el="+d.attr("gldp-id")+" ]")),e.selectedDate=e.selectedDate||e.todayDate,e.firstDate=new Date(e.firstDate||e.selectedDate)._first(),(d.attr("gldp-id")||"").length||d.attr("gldp-id","gldp-"+Math.round(1e10*Math.random())),d.addClass("gldp-el").bind("click",function(a){c.show(a)}).bind("focus",function(a){c.show(a)}),c.calendar.length&&!e.showAlways&&c.calendar.hide(),$(document).bind("mouseup",function(a){var b=a.target,e=c.calendar;d.is(b)||e.is(b)||0!==e.has(b).length||!e.is(":visible")||c.hide()}),c.render()}return glDatePicker.prototype={show:function(){$.each($(".gldp-el").not(this.el),function(a,b){b.length&&b.options.onHide(b.calendar)}),this.options.onShow(this.calendar)},hide:function(){this.options&&!this.options.showAlways&&this.options.onHide(this.calendar)},render:function(renderCalback){var self=this,el=self.el,options=self.options,calendar=self.calendar,coreClass=" core border ",cssName="gldp-"+options.cssName,todayVal=options.todayDate._val(),todayTime=todayVal.time,maxRow=6,maxCol=7,borderSize=options.borderSize+"px",getSelectableList=function(a,b,c){for(var d=[],e=a;b>=e;e++)d.push(e);if(c){var f=[];$.each(c,function(c,d){d>=a&&b>=d&&f._indexOf(d)<0&&f.push(d)}),d=f.length?f:d}return d.sort(),d},selectableMonths=getSelectableList(0,11,options.selectableMonths),selectableYears=getSelectableList(todayVal.year-5,todayVal.year+5,options.selectableYears),selectableDOW=getSelectableList(0,6,options.selectableDOW),dowNames=options.dowNames||["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],monthNames=options.monthNames||["January","February","March","April","May","June","July","August","September","October","November","December"],containerWidth=el.outerWidth(),containerHeight=containerWidth,getCellSize=function(a,b){return a/b+options.borderSize/b*(b-1)},cellWidth=getCellSize(containerWidth,maxCol),cellHeight=getCellSize(containerHeight,maxRow+2);calendar.length?eval(calendar.data("is"))||(containerWidth=calendar.outerWidth(),containerHeight=calendar.outerHeight(),cellWidth=getCellSize(containerWidth,maxCol),cellHeight=getCellSize(containerHeight,maxRow+2)):(self.calendar=calendar=$("<div/>").attr("gldp-el",el.attr("gldp-id")).data("is",!0).css({display:options.showAlways?void 0:"none",zIndex:options.zIndex,width:cellWidth*maxCol+"px"}),$("body").append(calendar)),el.is(":visible")||calendar.hide(),calendar.removeClass().addClass(cssName).children().remove();var onResize=function(){var a=el.offset();calendar.css({top:a.top+el.outerHeight()+options.calendarOffset.y+"px",left:a.left+options.calendarOffset.x+"px"})};$(window).resize(onResize),onResize();var cellCSS={width:cellWidth+"px",height:cellHeight+"px",lineHeight:cellHeight+"px"},setFirstDate=function(a){a&&(options.firstDate=a,self.render())},getFirstDate=function(a){var b=new Date(options.firstDate);for(a=a||0;;){if(b.setMonth(b.getMonth()+a),b.setDate(Math.min(1,b._max())),0==a)break;var c=b._val(),d=c.month,e=c.year;if(-1!=selectableMonths._indexOf(d)){if(-1!=selectableYears._indexOf(e))break;if(e<selectableYears[0]||e>selectableYears[selectableYears.length-1])return null}}return b},prevFirstDate=getFirstDate(-1),nextFirstDate=getFirstDate(1),firstDate=options.firstDate=getFirstDate(),firstDateVal=firstDate._val(),firstDateMonth=firstDateVal.month,firstDateYear=firstDateVal.year,startDate=new Date(firstDate),dowOffset=Math.abs(Math.min(6,Math.max(0,options.dowOffset))),startOffset=startDate.getDay()-dowOffset;startOffset=1>startOffset?-7-startOffset:-startOffset,dowNames=dowNames.concat(dowNames).slice(dowOffset,dowOffset+7),startDate._add(startOffset);var showPrev=prevFirstDate,showNext=nextFirstDate,monyearClass=coreClass+"monyear ",prevCell=$("<div/>").addClass(monyearClass).css($.extend({},cellCSS,{borderWidth:borderSize+" 0 0 "+borderSize})).append($("<a/>").addClass("prev-arrow"+(showPrev?"":"-off")).html(options.prevArrow)).mousedown(function(){return!1}).click(function(a){""!=options.prevArrow&&showPrev&&(a.stopPropagation(),setFirstDate(prevFirstDate))}),titleCellCount=maxCol-2,titleWidth=cellWidth*titleCellCount-titleCellCount*options.borderSize+options.borderSize,titleCell=$("<div/>").addClass(monyearClass+"title").css($.extend({},cellCSS,{width:titleWidth+"px",borderTopWidth:borderSize,marginLeft:"-"+borderSize})),nextCell=$("<div/>").addClass(monyearClass).css($.extend({},cellCSS,{marginLeft:"-"+borderSize,borderWidth:borderSize+" "+borderSize+" 0 0"})).append($("<a/>").addClass("next-arrow"+(showNext?"":"-off")).html(options.nextArrow)).mousedown(function(){return!1}).click(function(a){""!=options.nextArrow&&showNext&&(a.stopPropagation(),setFirstDate(nextFirstDate))});calendar.append(prevCell).append(titleCell).append(nextCell);for(var row=0,cellIndex=0;maxRow+1>row;row++)for(var col=0;maxCol>col;col++,cellIndex++){var cellDate=new Date(startDate),cellClass="day",cellZIndex=options.zIndex+cellIndex,cell=$("<div/>");if(row){cellDate._add(col+(row-1)*maxCol);var cellDateVal=cellDate._val(),cellDateTime=cellDateVal.time,specialData=null,isSelectable=!0,getRepeatDate=function(a,b){return a.repeatYear===!0&&b.setYear(cellDateVal.year),a.repeatMonth===!0&&b.setMonth(cellDateVal.month),b._val()};cell.html(cellDateVal.date),options.selectableDateRange&&(isSelectable=!1,$.each(options.selectableDateRange,function(a,b){var c=b.from,d=b.to||null;return d=d||new Date(b.from.getFullYear(),b.from.getMonth(),b.from._max()),c=getRepeatDate(b,c),d=getRepeatDate(b,d),cellDateTime>=c.time&&cellDateTime<=d.time?(isSelectable=!0,!0):void 0})),options.selectableDates&&((options.selectableDateRange&&!isSelectable||isSelectable&&!options.selectableDateRange)&&(isSelectable=!1),$.each(options.selectableDates,function(a,b){var c=getRepeatDate(b,b.date);return c.time==cellDateTime?isSelectable=!0:void 0})),!isSelectable||selectableYears._indexOf(cellDateVal.year)<0||selectableMonths._indexOf(cellDateVal.month)<0||selectableDOW._indexOf(cellDateVal.day)<0?(cellClass="noday",firstDateMonth!=cellDateVal.month&&(cellClass+=" outday")):(cellClass=["sun","mon","tue","wed","thu","fri","sat"][cellDateVal.day],options.specialDates&&$.each(options.specialDates,function(a,b){var c=getRepeatDate(b,b.date);c.time==cellDateTime&&(cellClass=b.cssClass||"special",cellZIndex+=52,specialData=b.data)}),firstDateMonth!=cellDateVal.month&&(cellClass+=" outday"),todayTime==cellDateTime&&(cellClass="today",cellZIndex+=50),options.selectedDate._time()==cellDateTime&&(cellClass+=" selected",cellZIndex+=51),cell.mousedown(function(){return!1}).hover(function(a){a.stopPropagation();var b=$(this).data("data");options.onHover(el,cell,b.date,b.data)}).click(function(a){a.stopPropagation();var b=$(this).data("data");options.selectedDate=options.firstDate=b.date,self.render(function(){!options.showAlways&&options.hideOnClick&&self.hide()}),options.onClick(el,$(this),b.date,b.data)}))}else cellClass="dow",cell.html(dowNames[col]),cellDate=null;$.extend(cellCSS,{borderTopWidth:borderSize,borderBottomWidth:borderSize,borderLeftWidth:row>0||!row&&!col?borderSize:0,borderRightWidth:row>0||!row&&6==col?borderSize:0,marginLeft:col>0?"-"+borderSize:0,marginTop:row>0?"-"+borderSize:0,zIndex:cellZIndex}),cell.data("data",{date:cellDate,data:specialData}).addClass(coreClass+cellClass).css(cellCSS),calendar.append(cell)}var toggleYearMonthSelect=function(a){var b="inline-block",c="none";options.allowMonthSelect&&(monthText.css({display:a?b:c}),monthSelect.css({display:a?c:b})),options.allowYearSelect&&(yearText.css({display:a?c:b}),yearSelect.css({display:a?b:c}))},onYearMonthSelect=function(){options.firstDate=new Date(yearSelect.val(),monthSelect.val(),1),self.render()},monthSelect=$("<select/>").hide().change(onYearMonthSelect),yearSelect=$("<select/>").hide().change(onYearMonthSelect),monthText=$("<span/>").html(monthNames[firstDateMonth]).mousedown(function(){return!1}).click(function(a){a.stopPropagation(),toggleYearMonthSelect(!1)}),yearText=$("<span/>").html(firstDateYear).mousedown(function(){return!1}).click(function(a){a.stopPropagation(),toggleYearMonthSelect(!0)});$.each(monthNames,function(a,b){if(options.allowMonthSelect&&-1!=selectableMonths._indexOf(a)){var c=$("<option/>").html(b).attr("value",a);a==firstDateMonth&&c.attr("selected","selected"),monthSelect.append(c)}}),$.each(selectableYears,function(a,b){if(options.allowYearSelect){var c=$("<option/>").html(b).attr("value",b);b==firstDateYear&&c.attr("selected","selected"),yearSelect.append(c)}});var titleYearMonth=$("<div/>").append(monthText).append(monthSelect).append(yearText).append(yearSelect);titleCell.children().remove(),titleCell.append(titleYearMonth),(renderCalback=renderCalback||function(){})()}},glDatePicker}();!function(){Date.prototype._clear=function(){return this.setHours(0),this.setMinutes(0),this.setSeconds(0),this.setMilliseconds(0),this},Date.prototype._time=function(){return this._clear().getTime()},Date.prototype._max=function(){var a=1==new Date(this.getYear(),1,29).getMonth()?1:0,b=[31,28+a,31,30,31,30,31,31,30,31,30,31];return b[this.getMonth()]},Date.prototype._add=function(a){this.setDate(this.getDate()+a)},Date.prototype._first=function(){var a=new Date(this);return a.setDate(1),a},Date.prototype._val=function(){return this._clear(),{year:this.getFullYear(),month:this.getMonth(),date:this.getDate(),time:this.getTime(),day:this.getDay()}},Array.prototype._indexOf=function(a){return $.inArray(a,this)}}()}();var app=angular.module("autocomplete",[]);app.directive("autocomplete",function(){var a=-1;return{restrict:"E",scope:{searchParam:"=ngModel",suggestions:"=data",onType:"=onType",onSelect:"=onSelect",onEnter:"=onEnter"},controller:["$scope",function(a){a.selectedIndex=-1,a.setIndex=function(b){a.selectedIndex=parseInt(b)},this.setIndex=function(b){a.setIndex(b),a.$apply()},a.getIndex=function(b){return a.selectedIndex};var b=!0;a.completing=!1,a.$watch("searchParam",function(c,d){d!==c&&d&&(b&&"undefined"!=typeof a.searchParam&&null!==a.searchParam&&(a.completing=!0,a.searchFilter=a.searchParam,a.selectedIndex=-1),a.onType&&a.onType(a.searchParam))}),this.preSelect=function(c){b=!1,a.$apply(),b=!0},a.preSelect=this.preSelect,this.preSelectOff=function(){b=!0},a.preSelectOff=this.preSelectOff,a.select=function(c){c&&(a.searchParam=c.value,a.searchFilter=c.value,a.onSelect&&a.onSelect(c)),b=!1,a.completing=!1,setTimeout(function(){b=!0},1e3),a.setIndex(-1)},a.enter=function(){a.onEnter&&a.onEnter(a.searchParam)}}],link:function(b,c,d){var e="";b.attrs={placeholder:"start typing...","class":"",id:"",inputclass:"",inputid:""};for(var f in d)e=f.replace("attr","").toLowerCase(),0===f.indexOf("attr")&&(b.attrs[e]=d[f]);d.clickActivation&&(c[0].onclick=function(a){b.searchParam||(b.completing=!0,b.$apply())});var g={left:37,up:38,right:39,down:40,enter:13,esc:27,tab:9};document.addEventListener("keydown",function(a){var c=a.keyCode||a.which;switch(c){case g.esc:b.select(),b.setIndex(-1),b.$apply(),a.preventDefault()}},!0),document.addEventListener("blur",function(a){setTimeout(function(){b.select(),b.setIndex(-1),b.$apply()},200)},!0),c[0].addEventListener("keydown",function(c){var d=c.keyCode||c.which,e=angular.element(this).find("li").length;switch(d){case g.up:if(a=b.getIndex()-1,-1>a)a=e-1;else if(a>=e){a=-1,b.setIndex(a),b.preSelectOff();break}b.setIndex(a),-1!==a&&b.preSelect(angular.element(angular.element(this).find("li")[a]).text()),b.$apply();break;case g.down:if(a=b.getIndex()+1,-1>a)a=e-1;else if(a>=e){a=-1,b.setIndex(a),b.preSelectOff(),b.$apply();break}b.setIndex(a),-1!==a&&b.preSelect(angular.element(angular.element(this).find("li")[a]).text());break;case g.left:break;case g.right:case g.enter:case g.tab:a=b.getIndex(),-1!==a?(b.select(angular.element(angular.element(this).find("li")[a]).text()),d==g.enter&&c.preventDefault()):d==g.enter&&(b.select(),b.enter()),b.setIndex(-1),b.$apply();break;case g.esc:b.select(),b.setIndex(-1),b.$apply(),c.preventDefault();break;default:return}})},template:'        <div class="autocomplete {{ attrs.class }}" id="{{ attrs.id }}">          <input            type="text"            ng-model="searchParam"            placeholder="{{ attrs.placeholder }}"            class="{{ attrs.inputclass }}"            id="{{ attrs.inputid }}"/>          <ul ng-show="completing && suggestions.length>0">            <li              suggestion              ng-repeat="suggestion in suggestions | filter:searchFilter | orderBy:\'suggestion.value.toString()\' track by $index"              index="{{ $index }}"              val="{{ suggestion }}"              ng-class="{ active: ($index === selectedIndex) }"              class="{{suggestion.data.section.name}}"              ng-click="select(suggestion)"              ng-bind-html="suggestion.value | highlight:searchParam"></li>          </ul>        </div>'}}),app.filter("highlight",["$sce",function(a){return function(b,c){if("function"==typeof b)return"";if(c){var d="("+c.split(/\ /).join(" |")+"|"+c.split(/\ /).join("|")+")",e=new RegExp(d,"gi");d.length&&(b=b.replace(e,'<span class="highlight">$1</span>'))}return a.trustAsHtml(b)}}]),app.directive("suggestion",function(){return{restrict:"A",require:"^autocomplete",link:function(a,b,c,d){b.bind("mouseenter",function(){d.preSelect(c.val),d.setIndex(c.index)}),b.bind("mouseleave",function(){d.preSelectOff()})}}}),function(a,b,c){function d(b,p,q){function K(){if(sa.initialized){var c=0,d=Ga.length;if(ya.old=a.extend({},ya),wa=ta?0:ua[ra.horizontal?"width":"height"](),Ba=za[ra.horizontal?"width":"height"](),xa=ta?b:va[ra.horizontal?"outerWidth":"outerHeight"](),Ga.length=0,ya.start=0,ya.end=H(xa-wa,0),Ra){c=Ia.length,Ha=va.children(ra.itemSelector),Ia.length=0;var e,f=j(va,ra.horizontal?"paddingLeft":"paddingTop"),g=j(va,ra.horizontal?"paddingRight":"paddingBottom"),h="border-box"===a(Ha).css("boxSizing"),i="none"!==Ha.css("float"),l=0,m=Ha.length-1;xa=0,Ha.each(function(b,c){var d=a(c),h=d[ra.horizontal?"outerWidth":"outerHeight"](),k=j(d,ra.horizontal?"marginLeft":"marginTop"),n=j(d,ra.horizontal?"marginRight":"marginBottom"),o=h+k+n,p=!k||!n,q={};q.el=c,q.size=p?h:o,q.half=q.size/2,q.start=xa+(p?k:0),q.center=q.start-G(wa/2-q.size/2),q.end=q.start-wa+q.size,b||(xa+=f),xa+=o,ra.horizontal||i||n&&k&&b>0&&(xa-=I(k,n)),b===m&&(q.end+=g,xa+=g,l=p?n:0),Ia.push(q),e=q}),va[0].style[ra.horizontal?"width":"height"]=(h?xa:xa-f-g)+"px",xa-=l,Ia.length?(ya.start=Ia[0][Pa?"center":"start"],ya.end=Pa?e.center:xa>wa?e.end:ya.start):ya.start=ya.end=0}if(ya.center=G(ya.end/2+ya.start/2),V(),Aa.length&&Ba>0&&(ra.dynamicHandle?(Ca=ya.start===ya.end?Ba:G(Ba*wa/xa),Ca=k(Ca,ra.minHandleSize,Ba),Aa[0].style[ra.horizontal?"width":"height"]=Ca+"px"):Ca=Aa[ra.horizontal?"outerWidth":"outerHeight"](),Da.end=Ba-Ca,eb||N()),!ta&&wa>0){var n=ya.start,o="";if(Ra)a.each(Ia,function(a,b){Pa?Ga.push(b.center):b.start+b.size>n&&n<=ya.end&&(n=b.start,Ga.push(n),n+=wa,n>ya.end&&n<ya.end+wa&&Ga.push(ya.end))});else for(;n-wa<ya.end;)Ga.push(n),n+=wa;if(Ea[0]&&d!==Ga.length){for(var p=0;p<Ga.length;p++)o+=ra.pageBuilder.call(sa,p);Fa=Ea.html(o).children(),Fa.eq(Ja.activePage).addClass(ra.activeClass)}}if(Ja.slideeSize=xa,Ja.frameSize=wa,Ja.sbSize=Ba,Ja.handleSize=Ca,Ra){sa.initialized?(Ja.activeItem>=Ia.length||0===c&&Ia.length>0)&&T(Ja.activeItem>=Ia.length?Ia.length-1:0,!c):(T(ra.startAt),sa[Qa?"toCenter":"toStart"](ra.startAt));var q=Ia[Ja.activeItem];L(Qa&&q?q.center:k(ya.dest,ya.start,ya.end))}else sa.initialized?L(k(ya.dest,ya.start,ya.end)):L(ra.startAt,1);oa("load")}}function L(a,b,c){if(Ra&&cb.released&&!c){var d=U(a),e=a>ya.start&&a<ya.end;Qa?(e&&(a=Ia[d.centerItem].center),Pa&&ra.activateMiddle&&T(d.centerItem)):e&&(a=Ia[d.firstItem].start)}cb.init&&cb.slidee&&ra.elasticBounds?a>ya.end?a=ya.end+(a-ya.end)/6:a<ya.start&&(a=ya.start+(a-ya.start)/6):a=k(a,ya.start,ya.end),ab.start=+new Date,ab.time=0,ab.from=ya.cur,ab.to=a,ab.delta=a-ya.cur,ab.tweesing=cb.tweese||cb.init&&!cb.slidee,ab.immediate=!ab.tweesing&&(b||cb.init&&cb.slidee||!ra.speed),cb.tweese=0,a!==ya.dest&&(ya.dest=a,oa("change"),eb||M()),Z(),V(),W(),O()}function M(){if(sa.initialized){if(!eb)return eb=t(M),void(cb.released&&oa("moveStart"));ab.immediate?ya.cur=ab.to:ab.tweesing?(ab.tweeseDelta=ab.to-ya.cur,D(ab.tweeseDelta)<.1?ya.cur=ab.to:ya.cur+=ab.tweeseDelta*(cb.released?ra.swingSpeed:ra.syncSpeed)):(ab.time=I(+new Date-ab.start,ra.speed),ya.cur=ab.from+ab.delta*jQuery.easing[ra.easing](ab.time/ra.speed,ab.time,0,1,ra.speed)),ab.to===ya.cur?(ya.cur=ab.to,cb.tweese=eb=0):eb=t(M),oa("move"),ta||(m?va[0].style[m]=n+(ra.horizontal?"translateX":"translateY")+"("+-ya.cur+"px)":va[0].style[ra.horizontal?"left":"top"]=-G(ya.cur)+"px"),!eb&&cb.released&&oa("moveEnd"),N()}}function N(){Aa.length&&(Da.cur=ya.start===ya.end?0:((cb.init&&!cb.slidee?ya.dest:ya.cur)-ya.start)/(ya.end-ya.start)*Da.end,Da.cur=k(G(Da.cur),Da.start,Da.end),_a.hPos!==Da.cur&&(_a.hPos=Da.cur,m?Aa[0].style[m]=n+(ra.horizontal?"translateX":"translateY")+"("+Da.cur+"px)":Aa[0].style[ra.horizontal?"left":"top"]=Da.cur+"px"))}function O(){Fa[0]&&_a.page!==Ja.activePage&&(_a.page=Ja.activePage,Fa.removeClass(ra.activeClass).eq(Ja.activePage).addClass(ra.activeClass),oa("activePage",_a.page))}function P(){bb.speed&&ya.cur!==(bb.speed>0?ya.end:ya.start)||sa.stop(),hb=cb.init?t(P):0,bb.now=+new Date,bb.pos=ya.cur+(bb.now-bb.lastTime)/1e3*bb.speed,L(cb.init?bb.pos:G(bb.pos)),cb.init||ya.cur!==ya.dest||oa("moveEnd"),bb.lastTime=bb.now}function Q(a,b,d){if("boolean"===e(b)&&(d=b,b=c),b===c)L(ya[a],d);else{if(Qa&&"center"!==a)return;var f=sa.getPos(b);f&&L(f[a],d,!Qa)}}function R(a){return null!=a?i(a)?a>=0&&a<Ia.length?a:-1:Ha.index(a):-1}function S(a){return R(i(a)&&0>a?a+Ia.length:a)}function T(a,b){var c=R(a);return!Ra||0>c?!1:((_a.active!==c||b)&&(Ha.eq(Ja.activeItem).removeClass(ra.activeClass),Ha.eq(c).addClass(ra.activeClass),_a.active=Ja.activeItem=c,W(),oa("active",c)),c)}function U(a){a=k(i(a)?a:ya.dest,ya.start,ya.end);var b={},c=Pa?0:wa/2;if(!ta)for(var d=0,e=Ga.length;e>d;d++){if(a>=ya.end||d===Ga.length-1){b.activePage=Ga.length-1;break}if(a<=Ga[d]+c){b.activePage=d;break}}if(Ra){for(var f=!1,g=!1,h=!1,j=0,l=Ia.length;l>j;j++)if(f===!1&&a<=Ia[j].start+Ia[j].half&&(f=j),h===!1&&a<=Ia[j].center+Ia[j].half&&(h=j),j===l-1||a<=Ia[j].end+Ia[j].half){g=j;break}b.firstItem=i(f)?f:0,b.centerItem=i(h)?h:b.firstItem,b.lastItem=i(g)?g:b.centerItem}return b}function V(b){a.extend(Ja,U(b))}function W(){var a=ya.dest<=ya.start,b=ya.dest>=ya.end,c=a?1:b?2:3;if(_a.slideePosState!==c&&(_a.slideePosState=c,Ya.is("button,input")&&Ya.prop("disabled",a),Za.is("button,input")&&Za.prop("disabled",b),Ya.add(Va)[a?"addClass":"removeClass"](ra.disabledClass),Za.add(Ua)[b?"addClass":"removeClass"](ra.disabledClass)),_a.fwdbwdState!==c&&cb.released&&(_a.fwdbwdState=c,Va.is("button,input")&&Va.prop("disabled",a),Ua.is("button,input")&&Ua.prop("disabled",b)),Ra){var d=0===Ja.activeItem,e=Ja.activeItem>=Ia.length-1,f=d?1:e?2:3;_a.itemsButtonState!==f&&(_a.itemsButtonState=f,Wa.is("button,input")&&Wa.prop("disabled",d),Xa.is("button,input")&&Xa.prop("disabled",e),Wa[d?"addClass":"removeClass"](ra.disabledClass),Xa[e?"addClass":"removeClass"](ra.disabledClass))}}function X(a,b,c){if(a=S(a),b=S(b),a>-1&&b>-1&&a!==b&&(!c||b!==a-1)&&(c||b!==a+1)){Ha.eq(a)[c?"insertAfter":"insertBefore"](Ia[b].el);var d=b>a?a:c?b:b-1,e=a>b?a:c?b+1:b,f=a>b;a===Ja.activeItem?_a.active=Ja.activeItem=c?f?b+1:b:f?b:b-1:Ja.activeItem>d&&Ja.activeItem<e&&(_a.active=Ja.activeItem+=f?1:-1),K()}}function Y(a,b){for(var c=0,d=$a[a].length;d>c;c++)if($a[a][c]===b)return c;return-1}function Z(){cb.released&&!sa.isPaused&&sa.resume()}function $(a){return G(k(a,Da.start,Da.end)/Da.end*(ya.end-ya.start))+ya.start}function _(){cb.history[0]=cb.history[1],cb.history[1]=cb.history[2],cb.history[2]=cb.history[3],cb.history[3]=cb.delta}function aa(a){cb.released=0,cb.source=a,cb.slidee="slidee"===a}function ba(b){var c="touchstart"===b.type,d=b.data.source,e="slidee"===d;cb.init||!c&&ea(b.target)||("handle"!==d||ra.dragHandle&&Da.start!==Da.end)&&(!e||(c?ra.touchDragging:ra.mouseDragging&&b.which<2))&&(c||f(b),aa(d),cb.init=0,cb.$source=a(b.target),cb.touch=c,cb.pointer=c?b.originalEvent.touches[0]:b,cb.initX=cb.pointer.pageX,cb.initY=cb.pointer.pageY,cb.initPos=e?ya.cur:Da.cur,cb.start=+new Date,cb.time=0,cb.path=0,cb.delta=0,cb.locked=0,cb.history=[0,0,0,0],cb.pathToLock=e?c?30:10:0,u.on(c?x:w,ca),sa.pause(1),(e?va:Aa).addClass(ra.draggedClass),oa("moveStart"),e&&(fb=setInterval(_,10)))}function ca(a){if(cb.released="mouseup"===a.type||"touchend"===a.type,cb.pointer=cb.touch?a.originalEvent[cb.released?"changedTouches":"touches"][0]:a,cb.pathX=cb.pointer.pageX-cb.initX,cb.pathY=cb.pointer.pageY-cb.initY,cb.path=E(F(cb.pathX,2)+F(cb.pathY,2)),cb.delta=ra.horizontal?cb.pathX:cb.pathY,!cb.init){if(!(ra.horizontal?D(cb.pathX)>D(cb.pathY):D(cb.pathX)<D(cb.pathY)))return da();cb.init=1}f(a),!cb.locked&&cb.path>cb.pathToLock&&cb.slidee&&(cb.locked=1,cb.$source.on(z,g)),cb.released&&(da(),ra.releaseSwing&&cb.slidee&&(cb.swing=(cb.delta-cb.history[0])/40*300,cb.delta+=cb.swing,cb.tweese=D(cb.swing)>10)),L(cb.slidee?G(cb.initPos-cb.delta):$(cb.initPos+cb.delta))}function da(){clearInterval(fb),u.off(cb.touch?x:w,ca),(cb.slidee?va:Aa).removeClass(ra.draggedClass),setTimeout(function(){cb.$source.off(z,g)}),sa.resume(1),ya.cur===ya.dest&&cb.init&&oa("moveEnd"),cb.init=0}function ea(b){return~a.inArray(b.nodeName,B)||a(b).is(ra.interactive)}function fa(){sa.stop(),u.off("mouseup",fa)}function ga(a){switch(f(a),this){case Ua[0]:case Va[0]:sa.moveBy(Ua.is(this)?ra.moveBy:-ra.moveBy),u.on("mouseup",fa);break;case Wa[0]:sa.prev();break;case Xa[0]:sa.next();break;case Ya[0]:sa.prevPage();break;case Za[0]:sa.nextPage()}}function ha(a){return db.curDelta=(ra.horizontal?a.deltaY||a.deltaX:a.deltaY)||-a.wheelDelta,db.curDelta/=1===a.deltaMode?3:100,Ra?(o=+new Date,db.last<o-db.resetTime&&(db.delta=0),db.last=o,db.delta+=db.curDelta,D(db.delta)<1?db.finalDelta=0:(db.finalDelta=G(db.delta/1),db.delta%=1),db.finalDelta):db.curDelta}function ia(a){var b=+new Date;if(J+300>b)return void(J=b);if(ra.scrollBy&&ya.start!==ya.end){var c=ha(a.originalEvent);(ra.scrollTrap||c>0&&ya.dest<ya.end||0>c&&ya.dest>ya.start)&&f(a,1),sa.slideBy(ra.scrollBy*c)}}function ja(a){ra.clickBar&&a.target===za[0]&&(f(a),L($((ra.horizontal?a.pageX-za.offset().left:a.pageY-za.offset().top)-Ca/2)))}function ka(a){if(ra.keyboardNavBy)switch(a.which){case ra.horizontal?37:38:f(a),sa["pages"===ra.keyboardNavBy?"prevPage":"prev"]();break;case ra.horizontal?39:40:f(a),sa["pages"===ra.keyboardNavBy?"nextPage":"next"]()}}function la(a){return ea(this)?void a.stopPropagation():void(this.parentNode===va[0]&&sa.activate(this))}function ma(){this.parentNode===Ea[0]&&sa.activatePage(Fa.index(this))}function na(a){ra.pauseOnHover&&sa["mouseenter"===a.type?"pause":"resume"](2)}function oa(a,b){if($a[a]){for(qa=$a[a].length,C.length=0,pa=0;qa>pa;pa++)C.push($a[a][pa]);for(pa=0;qa>pa;pa++)C[pa].call(sa,a,b)}}var pa,qa,ra=a.extend({},d.defaults,p),sa=this,ta=i(b),ua=a(b),va=ua.children().eq(0),wa=0,xa=0,ya={start:0,center:0,end:0,cur:0,dest:0},za=a(ra.scrollBar).eq(0),Aa=za.children().eq(0),Ba=0,Ca=0,Da={start:0,end:0,cur:0},Ea=a(ra.pagesBar),Fa=0,Ga=[],Ha=0,Ia=[],Ja={firstItem:0,lastItem:0,centerItem:0,activeItem:-1,activePage:0},Ka=new l(ua[0]),La=new l(va[0]),Ma=new l(za[0]),Na=new l(Aa[0]),Oa="basic"===ra.itemNav,Pa="forceCentered"===ra.itemNav,Qa="centered"===ra.itemNav||Pa,Ra=!ta&&(Oa||Qa||Pa),Sa=ra.scrollSource?a(ra.scrollSource):ua,Ta=ra.dragSource?a(ra.dragSource):ua,Ua=a(ra.forward),Va=a(ra.backward),Wa=a(ra.prev),Xa=a(ra.next),Ya=a(ra.prevPage),Za=a(ra.nextPage),$a={},_a={},ab={},bb={},cb={released:1},db={last:0,delta:0,resetTime:200},eb=0,fb=0,gb=0,hb=0;ta||(b=ua[0]),sa.initialized=0,sa.frame=b,sa.slidee=va[0],sa.pos=ya,sa.rel=Ja,sa.items=Ia,sa.pages=Ga,sa.isPaused=0,sa.options=ra,sa.dragging=cb,sa.reload=K,sa.getPos=function(a){if(Ra){var b=R(a);return-1!==b?Ia[b]:!1}var c=va.find(a).eq(0);if(c[0]){var d=ra.horizontal?c.offset().left-va.offset().left:c.offset().top-va.offset().top,e=c[ra.horizontal?"outerWidth":"outerHeight"]();return{start:d,center:d-wa/2+e/2,end:d-wa+e,size:e}}return!1},sa.moveBy=function(a){bb.speed=a,!cb.init&&bb.speed&&ya.cur!==(bb.speed>0?ya.end:ya.start)&&(bb.lastTime=+new Date,bb.startPos=ya.cur,aa("button"),cb.init=1,oa("moveStart"),s(hb),P())},sa.stop=function(){"button"===cb.source&&(cb.init=0,cb.released=1)},sa.prev=function(){sa.activate(Ja.activeItem-1)},sa.next=function(){sa.activate(Ja.activeItem+1)},sa.prevPage=function(){sa.activatePage(Ja.activePage-1)},sa.nextPage=function(){sa.activatePage(Ja.activePage+1)},sa.slideBy=function(a,b){a&&(Ra?sa[Qa?"toCenter":"toStart"](k((Qa?Ja.centerItem:Ja.firstItem)+ra.scrollBy*a,0,Ia.length)):L(ya.dest+a,b))},sa.slideTo=function(a,b){L(a,b)},sa.toStart=function(a,b){Q("start",a,b)},sa.toEnd=function(a,b){Q("end",a,b)},sa.toCenter=function(a,b){Q("center",a,b)},sa.getIndex=R,sa.activate=function(a,b){var c=T(a);ra.smart&&c!==!1&&(Qa?sa.toCenter(c,b):c>=Ja.lastItem?sa.toStart(c,b):c<=Ja.firstItem?sa.toEnd(c,b):Z())},sa.activatePage=function(a,b){i(a)&&L(Ga[k(a,0,Ga.length-1)],b)},sa.resume=function(a){!ra.cycleBy||!ra.cycleInterval||"items"===ra.cycleBy&&!Ia[0]||a<sa.isPaused||(sa.isPaused=0,gb?gb=clearTimeout(gb):oa("resume"),gb=setTimeout(function(){switch(oa("cycle"),ra.cycleBy){case"items":sa.activate(Ja.activeItem>=Ia.length-1?0:Ja.activeItem+1);break;case"pages":sa.activatePage(Ja.activePage>=Ga.length-1?0:Ja.activePage+1)}},ra.cycleInterval))},sa.pause=function(a){a<sa.isPaused||(sa.isPaused=a||100,gb&&(gb=clearTimeout(gb),oa("pause")))},sa.toggle=function(){sa[gb?"pause":"resume"]()},sa.set=function(b,c){a.isPlainObject(b)?a.extend(ra,b):ra.hasOwnProperty(b)&&(ra[b]=c)},sa.add=function(b,c){var d=a(b);Ra?(null==c||!Ia[0]||c>=Ia.length?d.appendTo(va):Ia.length&&d.insertBefore(Ia[c].el),c<=Ja.activeItem&&(_a.active=Ja.activeItem+=d.length)):va.append(d),K()},sa.remove=function(b){if(Ra){var c=S(b);if(c>-1){Ha.eq(c).remove();var d=c===Ja.activeItem;c<Ja.activeItem&&(_a.active=--Ja.activeItem),K(),d&&(_a.active=null,sa.activate(Ja.activeItem))}}else a(b).remove(),K()},sa.moveAfter=function(a,b){X(a,b,1)},sa.moveBefore=function(a,b){X(a,b)},sa.on=function(a,b){if("object"===e(a))for(var c in a)a.hasOwnProperty(c)&&sa.on(c,a[c]);else if("function"===e(b))for(var d=a.split(" "),f=0,g=d.length;g>f;f++)$a[d[f]]=$a[d[f]]||[],-1===Y(d[f],b)&&$a[d[f]].push(b);else if("array"===e(b))for(var h=0,i=b.length;i>h;h++)sa.on(a,b[h])},sa.one=function(a,b){function c(){b.apply(sa,arguments),sa.off(a,c)}sa.on(a,c)},sa.off=function(a,b){if(b instanceof Array)for(var c=0,d=b.length;d>c;c++)sa.off(a,b[c]);else for(var e=a.split(" "),f=0,g=e.length;g>f;f++)if($a[e[f]]=$a[e[f]]||[],null==b)$a[e[f]].length=0;else{var h=Y(e[f],b);-1!==h&&$a[e[f]].splice(h,1)}},sa.destroy=function(){return u.add(Sa).add(Aa).add(za).add(Ea).add(Ua).add(Va).add(Wa).add(Xa).add(Ya).add(Za).unbind("."+r),Wa.add(Xa).add(Ya).add(Za).removeClass(ra.disabledClass),Ha&&Ha.eq(Ja.activeItem).removeClass(ra.activeClass),Ea.empty(),ta||(ua.unbind("."+r),Ka.restore(),La.restore(),Ma.restore(),Na.restore(),a.removeData(b,r)),Ia.length=Ga.length=0,_a={},sa.initialized=0,sa},sa.init=function(){if(!sa.initialized){sa.on(q);var a=["overflow","position"],b=["position","webkitTransform","msTransform","transform","left","top","width","height"];Ka.save.apply(Ka,a),Ma.save.apply(Ma,a),La.save.apply(La,b),Na.save.apply(Na,b);var c=Aa;return ta||(c=c.add(va),ua.css("overflow","hidden"),m||"static"!==ua.css("position")||ua.css("position","relative")),m?n&&c.css(m,n):("static"===za.css("position")&&za.css("position","relative"),c.css({position:"absolute"})),ra.forward&&Ua.on(A,ga),ra.backward&&Va.on(A,ga),ra.prev&&Wa.on(z,ga),ra.next&&Xa.on(z,ga),ra.prevPage&&Ya.on(z,ga),ra.nextPage&&Za.on(z,ga),Sa.on(y,ia),za[0]&&za.on(z,ja),Ra&&ra.activateOn&&ua.on(ra.activateOn+"."+r,"*",la),Ea[0]&&ra.activatePageOn&&Ea.on(ra.activatePageOn+"."+r,"*",ma),Ta.on(v,{source:"slidee"},ba),Aa&&Aa.on(v,{source:"handle"},ba),u.bind("keydown."+r,ka),ta||(ua.on("mouseenter."+r+" mouseleave."+r,na),ua.on("scroll."+r,h)),sa.initialized=1,K(),ra.cycleBy&&!ta&&sa[ra.startPaused?"pause":"resume"](),sa}}}function e(a){return null==a?String(a):"object"==typeof a||"function"==typeof a?Object.prototype.toString.call(a).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":typeof a}function f(a,b){a.preventDefault(),b&&a.stopPropagation()}function g(b){f(b,1),a(this).off(b.type,g)}function h(){this.scrollLeft=0,this.scrollTop=0}function i(a){return!isNaN(parseFloat(a))&&isFinite(a)}function j(a,b){return 0|G(String(a.css(b)).replace(/[^\-0-9.]/g,""));
}function k(a,b,c){return b>a?b:a>c?c:a}function l(a){var b={};return b.style={},b.save=function(){if(a){for(var c=0;c<arguments.length;c++)b.style[arguments[c]]=a.style[arguments[c]];return b}},b.restore=function(){if(a){for(var c in b.style)b.style.hasOwnProperty(c)&&(a.style[c]=b.style[c]);return b}},b}var m,n,o,p="sly",q="Sly",r=p,s=b.cancelAnimationFrame||b.cancelRequestAnimationFrame,t=b.requestAnimationFrame,u=a(document),v="touchstart."+r+" mousedown."+r,w="mousemove."+r+" mouseup."+r,x="touchmove."+r+" touchend."+r,y=(document.implementation.hasFeature("Event.wheel","3.0")?"wheel.":"mousewheel.")+r,z="click."+r,A="mousedown."+r,B=["INPUT","SELECT","BUTTON","TEXTAREA"],C=[],D=Math.abs,E=Math.sqrt,F=Math.pow,G=Math.round,H=Math.max,I=Math.min,J=0;u.on(y,function(){J=+new Date}),function(a){function b(a){var b=(new Date).getTime(),d=Math.max(0,16-(b-c)),e=setTimeout(a,d);return c=b,e}t=a.requestAnimationFrame||a.webkitRequestAnimationFrame||b;var c=(new Date).getTime(),d=a.cancelAnimationFrame||a.webkitCancelAnimationFrame||a.clearTimeout;s=function(b){d.call(a,b)}}(window),function(){function a(a){for(var d=0,e=b.length;e>d;d++){var f=b[d]?b[d]+a.charAt(0).toUpperCase()+a.slice(1):a;if(null!=c.style[f])return f}}var b=["","webkit","moz","ms","o"],c=document.createElement("div");m=a("transform"),n=a("perspective")?"translateZ(0) ":""}(),b[q]=d,a.fn[p]=function(b,c){var f,g;return a.isPlainObject(b)||(("string"===e(b)||b===!1)&&(f=b===!1?"destroy":b,g=Array.prototype.slice.call(arguments,1)),b={}),this.each(function(e,h){var i=a.data(h,r);i||f?i&&f&&i[f]&&i[f].apply(i,g):i=a.data(h,r,new d(h,b,c).init())})},d.defaults={horizontal:!1,itemNav:null,itemSelector:null,smart:!1,activateOn:null,activateMiddle:!1,scrollSource:null,scrollBy:0,scrollHijack:300,scrollTrap:!1,dragSource:null,mouseDragging:!1,touchDragging:!1,releaseSwing:!1,swingSpeed:.2,elasticBounds:!1,interactive:null,scrollBar:null,dragHandle:!1,dynamicHandle:!1,minHandleSize:50,clickBar:!1,syncSpeed:.5,pagesBar:null,activatePageOn:null,pageBuilder:function(a){return"<li>"+(a+1)+"</li>"},forward:null,backward:null,prev:null,next:null,prevPage:null,nextPage:null,cycleBy:null,cycleInterval:5e3,pauseOnHover:!1,startPaused:!1,moveBy:300,speed:0,easing:"swing",startAt:0,keyboardNavBy:null,draggedClass:"dragged",activeClass:"active",disabledClass:"disabled"}}(jQuery,window),function(a){var b="~~",c="~~",d="[\\s!;,%\"'\\(\\)\\{\\}]",e="http://www.openscience.or.at/assets/lib/thesaurus4/server.php",f=["SCRIPT","BASE","LINK","META","STYLE","TITLE","APPLET","OBJECT"],g="",h='<div class="thesaurus"><div class="thesaurus-canvas"><div class="thesaurus-header"><a class="term"></a></div><div class="thesaurus-body">wird geladen...</div></div></div>',i=100,j=5e3,k=null,l={termsDef:{},targetId:0},m={_urlEncode:function(a){return encodeURIComponent(a.replace(/ /g,"+"))},request:function(b,c,d){a.getScript(e+"?action="+b+("undefined"!=typeof c.term?"&term="+m._urlEncode(c.term):"")+("undefined"!=typeof c.stats?"&stats="+m._urlEncode(c.stats):"")+("undefined"!=typeof c.caseSensitive?"&caseSensitive="+1*c.caseSensitive:""),d)}},n=function(){var b={},c=function(){Object.keys(b).length&&m.request("onview",{stats:JSON.stringify(b)},function(){b={}})};return{establishServerPushConnection:function(){window.setInterval(c,j),a(window).unload(c)},incrementTermViews:function(a){a=(a+"").toLowerCase(),b[a]="undefined"==typeof b[a]?1:b[a]+1},incrementTermClicks:function(a){m.request("onclick",{term:a})}}},o=function(b){var c=k.getSettings(),d=k.getStatsInstance(),e=b,f=null,g=null,j=0,n=function(b){var c=b.offset().top-5-f.height(),d=b.offset().left+b.width()/2,e=f.find(" > .thesaurus-canvas");e.removeClass("upwards").removeClass("downwards").removeClass("leftwards").removeClass("rightwards"),c<a(window).scrollTop()?(c=b.offset().top+b.height()+5,e.addClass("downwards")):e.addClass("upwards"),d>a(window).width()-f.width()?(d=b.offset().left-f.width()+b.width()/2,e.addClass("leftwards")):e.addClass("rightwards"),f.css("top",Math.floor(c)).css("left",Math.floor(d))},o=function(b,d){return"undefined"!=typeof l.termsDef[b]?void d(l.termsDef[b]):void m.request("termDef",{term:b,caseSensitive:c.caseSensitive},function(){l.termsDef[b]=a.callbackData.payload,d(l.termsDef[b])})},p=function(a){c.effect&&f.addClass("thesaurus-"+c.effect+"-"+a)};return{syncUI:function(b){b.find("dfn.thesaurus").unbind().bind("mouseenter",this,function(b){b.data.show(a(this))}).bind("mouseleave",this,function(a){a.data.hide()})},syncOverlayUI:function(a){f.unbind().bind("mouseenter",this,function(a){a.data.cancelHiding()}).bind("mouseleave",this,function(a){a.data.hide()}).bind("click",this,function(){d.incrementTermClicks(a)})},show:function(b){var c=b.text(),e=b.data("id"),g=this;return d.incrementTermViews(c),e&&j===e&&f.hasClass("thesaurus-visible")?void this.cancelHiding():("undefined"==typeof e&&b.data("id",j=++l.targetId),a(f).remove(),f=a(h).appendTo("body"),f.find("a.term").text(c),f.addClass("thesaurus-visible"),p("start"),this.syncOverlayUI(c),n(b),o(c,function(a){k.run(f.find("div.thesaurus-body").html(a),g),n(b)}),void p("end"))},cancelHiding:function(){window.clearTimeout(g),"undefined"!=typeof e&&e.cancelHiding()},hide:function(){"undefined"!=typeof e&&e.hide(),window.clearTimeout(g),g=window.setTimeout(function(){f.removeClass("thesaurus-visible").remove()},i)}}},p=function(e){var h=a.extend({caseSensitive:!1,effect:null,pushStats:!1},e),i={},j=new n,k=function(a,e){var f=h.caseSensitive?"g":"gi";if(e==a)return b+a+c;var g=new RegExp("^("+e+")("+d+")",f);return a=a.replace(g,b+"$1"+c+"$2"),g=new RegExp("("+d+")("+e+")$",f),a=a.replace(g,"$1"+b+"$2"+c),g=new RegExp("("+d+")("+e+")("+d+")",f),a=a.replace(g,"$1"+b+"$2"+c+"$3")},l=function(b){b.contents().filter(function(){return 1===this.nodeType&&l(a(this)),3===this.nodeType&&a.trim(a(this).text()).length&&-1===a.inArray(this.tagName,f)}).each(function(){var b=this;a.each(i,function(a,c){b.nodeValue=k(b.nodeValue,c)})})},p=function(a){a.find("script").detach(),a.html(function(a,c){var d=new RegExp(b+"(.*?)"+b,"g");return c.replace(d,'<dfn class="thesaurus">$1</dfn>')})};return{init:function(a){return h.pushStats&&j.establishServerPushConnection(),this.renderUI(),this.loadTerms(a),this},run:function(a,b){l(a),p(a);var c=new o(b);c.syncUI(a)},loadTerms:function(b){var c=this;m.request("termList",{},function(){i=a.callbackData.payload,b.call(c)})},renderUI:function(){a("body").append('<style type="text/css">'+g+"</style>")},getSettings:function(){return h},getStatsInstance:function(){return j}}};a.fn.Thesaurus=function(b){var c=a(this);null===k?(k=new p(b),k.init(function(){k.run(c)})):k.run(c)}}(jQuery),!function(a){a.Editable.commands=a.extend(a.Editable.commands,{insertOrderedList:{title:"Numbered List",icon:"fa fa-list-ol",refresh:function(){},callback:function(a){this.formatList(a)},undo:!0},insertUnorderedList:{title:"Bulleted List",icon:"fa fa-list-ul",refresh:function(){},callback:function(a){this.formatList(a)},undo:!0}}),a.Editable.prototype.refreshLists=function(){var b=a(this.getSelectionElement()),c=this.parents(b,"ul, ol");if(c.length>0){var d="insertUnorderedList";"OL"==c[0].tagName&&(d="insertOrderedList"),this.$editor.find('button[data-cmd="'+d+'"]').addClass("active")}},a.Editable.prototype.processBackspace=function(b){var c=b.prev();if(c.length){for(this.removeMarkers(),("UL"==c.get(0).tagName||"OL"==c.get(0).tagName)&&(c=c.find("li:last"));c.find("> ul, > ol").length;)c=c.find("> ul li:last, > ol li:last");var d=c.find("> p, > h1, > h3, > h4, > h5, > h6, > div, > pre, > blockquote");if(0===c.text().length&&0===c.find("img, table, input, iframe, video").length)c.remove();else{if(this.emptyElement(c.get(0))||(this.keep_enter=!0,b.find("> p, > h1, > h3, > h4, > h5, > h6, > div, > pre, > blockquote").each(function(b,c){a(c).replaceWith(a(c).html())}),this.keep_enter=!1),d.length)if(a(d[d.length-1]).append(this.markers_html),0===b.find("ul, ol").length)a(d[d.length-1]).append(b.html());else{for(var e=!1,f=b.contents(),g=0;g<f.length;g++){var h=f[g];["OL","UL"].indexOf(f[g].tagName)>=0&&(e=!0),e?a(d[d.length-1]).after(h):a(d[d.length-1]).append(h)}this.$element.find("breakli").remove();var i=d[d.length-1].nextSibling;i&&"BR"==i.tagName&&a(i).remove()}else this.emptyElement(c.get(0))?(this.$element.find("breakli").replaceWith(this.markers_html),c.html(b.html())):(c.append(this.markers_html),c.append(b.html()));b.remove(),this.cleanupLists(),this.restoreSelectionByMarkers()}this.$element.find("breakli").remove()}else this.$element.find("breakli").remove(),this.parents(b,"ul").length?this.formatList("insertUnorderedList",!1):this.formatList("insertOrderedList",!1);this.sync()},a.Editable.prototype.liBackspace=function(){if(""!==this.text())return!0;var b,c=this.getSelectionElement(),d=this.parents(a(c),"table, li");if(d.length>0&&"TABLE"===d[0].tagName)return!0;if(b="LI"==c.tagName?a(c):this.parents(a(c),"li:first"),this.removeMarkers(),this.emptyElement(b.get(0))?(b.prepend("<breakli></breakli>"),1==b.find("br").length&&b.find("br").remove()):this.insertHTML("<breakli></breakli>"),b.find("breakli").prev().length&&"TABLE"===b.find("breakli").prev().get(0).tagName&&b.find("breakli").next().length&&"BR"===b.find("breakli").next().get(0).tagName)return this.setSelection(b.find("breakli").prev().find("td:first").get(0)),b.find("breakli").next().remove(),this.$element.find("breakli").remove(),!1;for(var e,f=b.html(),g=[],h=0;h<f.length;h++){if(chr=f.charAt(h),"<"!=chr)return this.$element.find("breakli").remove(),!0;var i=f.indexOf(">",h+1);if(-1!==i){e=f.substring(h,i+1);var j=this.tagName(e);if(h=i,"breakli"==j){if(!this.isClosingTag(e)&&!this.isClosingTag(g[g.length-1]))return this.processBackspace(b),!1}else g.push(e)}}return this.$element.find("breakli").remove(),!0},a.Editable.prototype.textLiEnter=function(b){this.removeMarkers(),this.insertSimpleHTML("<breakli></breakli>",!1);var c,d,e=b.html(),f=[],g={},h=[],i=0,j=b.prop("attributes"),k="";for(d=0;d<j.length;d++)k+=" "+j[d].name+'="'+j[d].value+'"';var l=!1;for(d=0;d<e.length;d++)if(chr=e.charAt(d),"<"==chr){var m=e.indexOf(">",d+1);if(-1!==m){c=e.substring(d,m+1);var n=this.tagName(c);if(d=m,"breakli"==n){if(!this.isClosingTag(c)){for(var o=f.length-1;o>=0;o--){var p=this.tagName(f[o]);h.push("</"+p+">")}h.push("</li>"),h.push("<li"+k+">");for(var q=0;q<f.length;q++)h.push(f[q]);h.push('<span class="f-marker" data-type="false" data-collapsed="true" data-id="0" data-fr-verified="true"></span><span class="f-marker" data-type="true" data-collapsed="true" data-id="0" data-fr-verified="true"></span>'),l=!1}}else if(h.push(c),l=!1,!this.isSelfClosingTag(c))if(this.isClosingTag(c)){var r=g[n].pop();f.splice(r,1)}else f.push(c),void 0===g[n]&&(g[n]=[]),g[n].push(f.length-1)}}else i++,32!=chr.charCodeAt(0)||l?(h.push(chr),l=!0):h.push("&nbsp;");var s=a(b.parents("ul, ol")[0]);b.replaceWith("<li"+k+">"+h.join("")+"</li>"),s.find("p:empty + table").prev().remove(),s.find("p + table").each(function(b,c){var d=a(c);d.prev().append(d.clone()),d.remove()}),s.find("table + p").each(function(b,c){var d=a(c);d.append(d.prev().clone()),d.prev().remove()}),this.keep_enter=!0,s.find(this.valid_nodes.join(",")).each(a.proxy(function(b,c){""===a(c).text().trim()&&0===a(c).find(this.valid_nodes.join(",")).length&&a(c).prepend(a.Editable.INVISIBLE_SPACE)},this)),this.keep_enter=!1},a.Editable.prototype.liEnter=function(){var b,c=this.getSelectionElement(),d=this.parents(a(c),"table, li");if(d.length>0&&"TABLE"==d[0].tagName)return!0;if(b="LI"==c.tagName?a(c):this.parents(a(c),"li:first"),this.getSelectionTextInfo(b.get(0)).atStart&&""===this.text())b.before("<li>"+a.Editable.INVISIBLE_SPACE+"</li>");else{if(0===this.trim(b.text()).length&&0===b.find("img, table, iframe, input, object").length)return this.outdent(!1),!1;this.textLiEnter(b),this.$element.find("breakli").remove(),this.restoreSelectionByMarkers()}return this.sync(),!1},a.Editable.prototype.listTab=function(){var b=a(this.getSelectionElement());return this.parents(b,"ul, ol").length>0&&0===this.parents(b,"table").length?(this.indent(),!1):void 0},a.Editable.prototype.listShiftTab=function(){var b=a(this.getSelectionElement());return this.parents(b,"ul, ol").length>0&&0===this.parents(b,"table").length?(this.outdent(),!1):void 0},a.Editable.prototype.indentList=function(a,b){return"LI"===a.get(0).tagName?(b?this.outdentLi(a):this.indentLi(a),this.cleanupLists(),!1):!0},a.Editable.prototype.initList=function(){this.addListener("tab",this.listTab),this.addListener("shift+tab",this.listShiftTab),this.addListener("refresh",this.refreshLists),this.addListener("indent",this.indentList),this.isImage||this.isLink||this.options.editInPopup||this.$element.on("keypress",a.proxy(function(b){if(["TEXTAREA","INPUT"].indexOf(b.target.tagName)<0&&!this.isHTML){var c=b.which,d=this.getSelectionElement();if("LI"==d.tagName||this.parents(a(d),"li").length>0){if(13==c&&!b.shiftKey&&this.options.multiLine)return this.liEnter();if(8==c)return this.liBackspace()}}},this))},a.Editable.initializers.push(a.Editable.prototype.initList),a.Editable.prototype.formatList=function(b,c){if(this.browser.msie&&a.Editable.getIEversion()<9)return document.execCommand(b,!1,!1),!1;void 0===c&&(c=!0);var d,e,f=!1,g=!0,h=!1,i=this.getSelectionElements(),j=this.parents(a(i[0]),"ul, ol");if(j.length&&("UL"===j[0].tagName?"insertUnorderedList"!=b&&(f=!0):"insertOrderedList"!=b&&(f=!0)),this.saveSelectionByMarkers(),f){d="ol","insertUnorderedList"===b&&(d="ul");var k=a(j[0]);k.replaceWith("<"+d+">"+k.html()+"</"+d+">")}else{for(var l=0;l<i.length;l++)if(e=a(i[l]),("TD"==e.get(0).tagName||"TH"==e.get(0).tagName)&&this.wrapTextInElement(e),this.parents(e,"li").length>0||"LI"==e.get(0).tagName){var m;m="LI"==e.get(0).tagName?e:a(e.parents("li")[0]);var n=this.parents(e,"ul, ol");if(n.length>0&&(d=n[0].tagName.toLowerCase(),m.before('<span class="close-'+d+'" data-fr-verified="true"></span>'),m.after('<span class="open-'+d+'" data-fr-verified="true"></span>')),0===this.parents(a(n[0]),"ol, ul").length||f)if(0===m.find(this.valid_nodes.join(",")).length){var o=m.html().replace(/\u200B/gi,"");this.options.paragraphy?(0===m.text().replace(/\u200B/gi,"").length&&(o+=m.find("br").length>0?"":this.br),o="<"+this.options.defaultTag+this.attrs(m.get(0))+">"+o,o=o+"</"+this.options.defaultTag+">"):o+=m.find("br").length>0?"":this.br,m.replaceWith(o)}else m.replaceWith(m.html().replace(/\u200B/gi,""));else this.parents(a(n[0]),"ol, ul").length>0&&(m.append('<span class="open-li" data-fr-verified="true"></span>'),m.before('<span class="close-li" data-fr-verified="true"></span>'));h=!0}else g=!1;h&&this.cleanupLists(),(g===!1||f===!0)&&(this.wrapText(),this.restoreSelectionByMarkers(),i=this.getSelectionElements(),this.saveSelectionByMarkers(),this.elementsToList(i,b),this.unwrapText(),this.cleanupLists())}this.options.paragraphy&&!f&&this.wrapText(!0),this.restoreSelectionByMarkers(),c&&this.repositionEditor(),b="insertUnorderedList"==b?"unorderedListInserted":"orderedListInserted",this.triggerEvent(b)},a.Editable.prototype.elementsToList=function(b,c){var d="<ol>";"insertUnorderedList"==c&&(d="<ul>"),b[0]==this.$element.get(0)&&(b=this.$element.find("> "+this.valid_nodes.join(", >")));for(var e=0;e<b.length;e++){var f=a(d);$element=a(b[e]),$element.get(0)!=this.$element.get(0)&&("TD"===$element.get(0).tagName||"TH"===$element.get(0).tagName?(this.wrapTextInElement($element,!0),this.elementsToList($element.find("> "+this.valid_nodes.join(", >")),c)):(""===$element.attr("class")&&$element.removeAttr("class"),f.append($element.get(0).tagName==this.options.defaultTag&&0===$element.get(0).attributes.length?a("<li>").html($element.clone().html()):a("<li>").html($element.clone())),$element.replaceWith(f)))}},a.Editable.prototype.indentLi=function(b){var c=b.parents("ul, ol"),d=c.get(0).tagName.toLowerCase();b.find("> ul, > ol").length>0&&b.prev("li").length>0?(this.wrapTextInElement(b),b.find("> "+this.valid_nodes.join(" , > ")).each(function(b,c){a(c).wrap("<"+d+"></"+d+">").wrap("<li></li>")}),b.prev("li").append(b.find("> ul, > ol")),b.remove()):0===b.find("> ul, > ol").length&&b.prev("li").length>0&&(b.prev().append(a("<"+d+">").append(b.clone())),b.remove(),a(c.find("li").get().reverse()).each(function(b,c){var d=a(c);d.find(" > ul, > ol").length>0&&d.prev()&&d.prev().find(" > ul, > ol").length>0&&1===d.contents().length&&(d.prev().append(d.html()),d.remove())}))},a.Editable.prototype.outdentLi=function(b){var c=a(b.parents("ul, ol")[0]),d=this.parents(c,"ul, ol"),e=c.get(0).tagName.toLowerCase();0===b.prev("li").length&&this.parents(b,"li").length>0?(b.before('<span class="close-'+e+'" data-fr-verified="true"></span>'),b.before('<span class="close-li" data-fr-verified="true"></span>'),b.before('<span class="open-li" data-fr-verified="true"></span>'),b.after('<span class="open-'+e+'" data-fr-verified="true"></span>'),b.replaceWith(b.html())):(b.before('<span class="close-'+e+'" data-fr-verified="true"></span>'),b.after('<span class="open-'+e+'" data-fr-verified="true"></span>'),this.parents(b,"li").length>0&&(b.before('<span class="close-li" data-fr-verified="true"></span>'),b.after('<span class="open-li" data-fr-verified="true"></span>'))),d.length||(0===b.find(this.valid_nodes.join(",")).length?b.replaceWith(b.html().replace(/\u200b/gi,"")+this.br):(b.find(this.valid_nodes.join(", ")).each(a.proxy(function(b,c){this.emptyElement(c)&&a(c).append(this.br)},this)),b.replaceWith(b.html().replace(/\u200b/gi,""))))},a.Editable.prototype.listTextEmpty=function(b){var c=a(b).text().replace(/(\r\n|\n|\r|\t|\u200B)/gm,"");return(""===c||b===this.$element.get(0))&&1===a(b).find("br").length}}(jQuery),$.Editable.LANGS.de={translation:{Bold:"Fett",Italic:"Kursiv",Underline:"Unterstrichen",Strikethrough:"Durchgestrichen","Font Size":"Schriftgröße",Color:"Farbe",Background:"Hintergrund",Text:"Text","Format Block":"Formate",Normal:"Normal",Paragraph:"Absatz",Code:"Quelltext",Quote:"Zitat","Heading 1":"Überschrift 1","Heading 2":"Überschrift 2","Heading 3":"Überschrift 3","Heading 4":"Überschrift 4","Heading 5":"Überschrift 5","Heading 6":"Überschrift 6","Block Style":"Block-Stil",Alignment:"Ausrichtung","Align Left":"Linksbündig ausrichten","Align Center":"Zentriert ausrichten","Align Right":"Rechtsbündig ausrichten",Justify:"Blocksatz","Numbered List":"Nummerierte Liste","Bulleted List":"Aufzählung","Indent Less":"Einzug verkleinern","Indent More":"Einzug vergrößern","Select All":"Alles auswählen","Insert Link":"Link einfügen","Insert Image":"Bild einfügen","Insert Video":"Video einfügen",Undo:"Rückgängig",Redo:"Wiederholen","Show HTML":"HTML anzeigen","Float Left":"Linksbündig","Float None":"Keine","Float Right":"Rechtsbündig","Replace Image":"Bild ersetzen","Remove Image":"Bild entfernen",Title:"Titel","Drop image":"Ziehen Sie ein Bild hierhin","or click":"oder klicken Sie auf",or:"oder","Enter URL":"URL eingeben","Please wait!":"Bitte warten Sie!","Are you sure? Image will be deleted.":"Sind Sie sicher? Das Bild wird gelöscht.",UNLINK:"Link entfernen","Open in new tab":"In neuer Registerkarte öffnen","Type something":"Schreiben Sie etwas",Cancel:"Abbrechen",OK:"Ok","Manage images":"Bilder verwalten",Delete:"Löschen","Font Family":"Schriftart","Insert Horizontal Line":"Horizontale Linie Einfügen",Table:"Tabelle","Insert table":"Tabelle einfügen",Cell:"Zelle",Row:"Zeile",Column:"Spalte","Delete table":"Tabelle löschen","Insert cell before":"Neue zelle davor einfügen","Insert cell after":"Neue zelle danach einfügen","Delete cell":"Zelle löschen","Merge cells":"Zelle verschmelzen","Horizontal split":"Horizontal aufteilung","Vertical split":"Vertikal aufteilung","Insert row above":"Neue Zeile davor einfügen","Insert row below":"Neue Zeile danach einfügen","Delete row":"Zeile löschen","Insert column before":"Neue Spalte davor einfügen","Insert column after":"Neue Spalte danach einfügen","Delete column":"Spalte löschen","Uploading image":"Bild hochladen","Upload File":"Datei Hochladen","Drop File":"Tropfen Datei","Clear formatting":"Formatierung löschen"},direction:"ltr"},!function(){var a,b,c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=function(){function a(){this.options_index=0,this.parsed=[]}return a.prototype.add_node=function(a){return"OPTGROUP"===a.nodeName.toUpperCase()?this.add_group(a):this.add_option(a)},a.prototype.add_group=function(a){var b,c,d,e,f,g;for(b=this.parsed.length,this.parsed.push({array_index:b,group:!0,label:this.escapeExpression(a.label),children:0,disabled:a.disabled}),f=a.childNodes,g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(this.add_option(c,b,a.disabled));return g},a.prototype.add_option=function(a,b,c){return"OPTION"===a.nodeName.toUpperCase()?(""!==a.text?(null!=b&&(this.parsed[b].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:a.value,text:a.text,html:a.innerHTML,selected:a.selected,disabled:c===!0?c:a.disabled,group_array_index:b,classes:a.className,style:a.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1):void 0},a.prototype.escapeExpression=function(a){var b,c;return null==a||a===!1?"":/[\&\<\>\"\'\`]/.test(a)?(b={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},c=/&(?!\w+;)|[\<\>\"\'\`]/g,a.replace(c,function(a){return b[a]||"&amp;"})):a},a}(),d.select_to_array=function(a){var b,c,e,f,g;for(c=new d,g=a.childNodes,e=0,f=g.length;f>e;e++)b=g[e],c.add_node(b);return c.parsed},b=function(){function a(b,c){this.form_field=b,this.options=null!=c?c:{},a.browser_is_supported()&&(this.is_multiple=this.form_field.multiple,this.set_default_text(),this.set_default_values(),this.setup(),this.set_up_html(),this.register_observers())}return a.prototype.set_default_values=function(){var a=this;return this.click_test_action=function(b){return a.test_active_click(b)},this.activate_action=function(b){return a.activate_field(b)},this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.result_single_selected=null,this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text?this.options.allow_single_deselect:!1,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.enable_split_word_search=null!=this.options.enable_split_word_search?this.options.enable_split_word_search:!0,this.group_search=null!=this.options.group_search?this.options.group_search:!0,this.search_contains=this.options.search_contains||!1,this.single_backstroke_delete=null!=this.options.single_backstroke_delete?this.options.single_backstroke_delete:!0,this.max_selected_options=this.options.max_selected_options||1/0,this.inherit_select_classes=this.options.inherit_select_classes||!1,this.display_selected_options=null!=this.options.display_selected_options?this.options.display_selected_options:!0,this.display_disabled_options=null!=this.options.display_disabled_options?this.options.display_disabled_options:!0},a.prototype.set_default_text=function(){return this.default_text=this.form_field.getAttribute("data-placeholder")?this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.options.placeholder_text_multiple||this.options.placeholder_text||a.default_multiple_text:this.options.placeholder_text_single||this.options.placeholder_text||a.default_single_text,this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||a.default_no_result_text},a.prototype.mouse_enter=function(){return this.mouse_on_container=!0},a.prototype.mouse_leave=function(){return this.mouse_on_container=!1},a.prototype.input_focus=function(){var a=this;if(this.is_multiple){if(!this.active_field)return setTimeout(function(){return a.container_mousedown()},50)}else if(!this.active_field)return this.activate_field()},a.prototype.input_blur=function(){var a=this;return this.mouse_on_container?void 0:(this.active_field=!1,setTimeout(function(){return a.blur_test()},100))},a.prototype.results_option_build=function(a){var b,c,d,e,f;for(b="",f=this.results_data,d=0,e=f.length;e>d;d++)c=f[d],b+=c.group?this.result_add_group(c):this.result_add_option(c),(null!=a?a.first:void 0)&&(c.selected&&this.is_multiple?this.choice_build(c):c.selected&&!this.is_multiple&&this.single_set_selected_text(c.text));return b},a.prototype.result_add_option=function(a){var b,c;return a.search_match&&this.include_option_in_results(a)?(b=[],a.disabled||a.selected&&this.is_multiple||b.push("active-result"),!a.disabled||a.selected&&this.is_multiple||b.push("disabled-result"),a.selected&&b.push("result-selected"),null!=a.group_array_index&&b.push("group-option"),""!==a.classes&&b.push(a.classes),c=""!==a.style.cssText?' style="'+a.style+'"':"",'<li class="'+b.join(" ")+'"'+c+' data-option-array-index="'+a.array_index+'">'+a.search_text+"</li>"):""},a.prototype.result_add_group=function(a){return(a.search_match||a.group_match)&&a.active_options>0?'<li class="group-result">'+a.search_text+"</li>":""},a.prototype.results_update_field=function(){return this.set_default_text(),this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.result_single_selected=null,this.results_build(),this.results_showing?this.winnow_results():void 0},a.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},a.prototype.results_search=function(){return this.results_showing?this.winnow_results():this.results_show()},a.prototype.winnow_results=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m;for(this.no_results_clear(),e=0,g=this.get_search_text(),a=g.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),d=this.search_contains?"":"^",c=new RegExp(d+a,"i"),j=new RegExp(a,"i"),m=this.results_data,k=0,l=m.length;l>k;k++)b=m[k],b.search_match=!1,f=null,this.include_option_in_results(b)&&(b.group&&(b.group_match=!1,b.active_options=0),null!=b.group_array_index&&this.results_data[b.group_array_index]&&(f=this.results_data[b.group_array_index],0===f.active_options&&f.search_match&&(e+=1),f.active_options+=1),(!b.group||this.group_search)&&(b.search_text=b.group?b.label:b.html,b.search_match=this.search_string_match(b.search_text,c),b.search_match&&!b.group&&(e+=1),b.search_match?(g.length&&(h=b.search_text.search(j),i=b.search_text.substr(0,h+g.length)+"</em>"+b.search_text.substr(h+g.length),b.search_text=i.substr(0,h)+"<em>"+i.substr(h)),null!=f&&(f.group_match=!0)):null!=b.group_array_index&&this.results_data[b.group_array_index].search_match&&(b.search_match=!0)));return this.result_clear_highlight(),1>e&&g.length?(this.update_results_content(""),this.no_results(g)):(this.update_results_content(this.results_option_build()),this.winnow_results_set_highlight())},a.prototype.search_string_match=function(a,b){var c,d,e,f;if(b.test(a))return!0;if(this.enable_split_word_search&&(a.indexOf(" ")>=0||0===a.indexOf("["))&&(d=a.replace(/\[|\]/g,"").split(" "),d.length))for(e=0,f=d.length;f>e;e++)if(c=d[e],b.test(c))return!0},a.prototype.choices_count=function(){var a,b,c,d;if(null!=this.selected_option_count)return this.selected_option_count;for(this.selected_option_count=0,d=this.form_field.options,b=0,c=d.length;c>b;b++)a=d[b],a.selected&&(this.selected_option_count+=1);return this.selected_option_count},a.prototype.choices_click=function(a){return a.preventDefault(),this.results_showing||this.is_disabled?void 0:this.results_show()},a.prototype.keyup_checker=function(a){var b,c;switch(b=null!=(c=a.which)?c:a.keyCode,this.search_field_scale(),b){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices_count()>0)return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:if(a.preventDefault(),this.results_showing)return this.result_select(a);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}},a.prototype.container_width=function(){return null!=this.options.width?this.options.width:""+this.form_field.offsetWidth+"px"},a.prototype.include_option_in_results=function(a){return this.is_multiple&&!this.display_selected_options&&a.selected?!1:!this.display_disabled_options&&a.disabled?!1:a.empty?!1:!0},a.browser_is_supported=function(){return"Microsoft Internet Explorer"===window.navigator.appName?document.documentMode>=8:/iP(od|hone)/i.test(window.navigator.userAgent)?!1:/Android/i.test(window.navigator.userAgent)&&/Mobile/i.test(window.navigator.userAgent)?!1:!0},a.default_multiple_text="Select Some Options",a.default_single_text="Select an Option",a.default_no_result_text="No results match",a}(),a=jQuery,a.fn.extend({chosen:function(d){return b.browser_is_supported()?this.each(function(){var b,e;b=a(this),e=b.data("chosen"),"destroy"===d&&e?e.destroy():e||b.data("chosen",new c(this,d))}):this}}),c=function(b){function c(){return e=c.__super__.constructor.apply(this,arguments)}return g(c,b),c.prototype.setup=function(){return this.form_field_jq=a(this.form_field),this.current_selectedIndex=this.form_field.selectedIndex,this.is_rtl=this.form_field_jq.hasClass("chosen-rtl")},c.prototype.set_up_html=function(){var b,c;return b=["chosen-container"],b.push("chosen-container-"+(this.is_multiple?"multi":"single")),this.inherit_select_classes&&this.form_field.className&&b.push(this.form_field.className),this.is_rtl&&b.push("chosen-rtl"),c={"class":b.join(" "),style:"width: "+this.container_width()+";",title:this.form_field.title},this.form_field.id.length&&(c.id=this.form_field.id.replace(/[^\w]/g,"_")+"_chosen"),this.container=a("<div />",c),this.is_multiple?this.container.html('<ul class="chosen-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chosen-drop"><ul class="chosen-results"></ul></div>'):this.container.html('<a class="chosen-single chosen-default" tabindex="-1"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chosen-drop"><div class="chosen-search"><input type="text" autocomplete="off" /></div><ul class="chosen-results"></ul></div>'),this.form_field_jq.hide().after(this.container),this.dropdown=this.container.find("div.chosen-drop").first(),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chosen-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chosen-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chosen-search").first(),this.selected_item=this.container.find(".chosen-single").first()),this.results_build(),this.set_tab_index(),this.set_label_behavior(),this.form_field_jq.trigger("chosen:ready",{chosen:this})},c.prototype.register_observers=function(){var a=this;return this.container.bind("mousedown.chosen",function(b){a.container_mousedown(b)}),this.container.bind("mouseup.chosen",function(b){a.container_mouseup(b)}),this.container.bind("mouseenter.chosen",function(b){a.mouse_enter(b)}),this.container.bind("mouseleave.chosen",function(b){a.mouse_leave(b)}),this.search_results.bind("mouseup.chosen",function(b){a.search_results_mouseup(b)}),this.search_results.bind("mouseover.chosen",function(b){a.search_results_mouseover(b)}),this.search_results.bind("mouseout.chosen",function(b){a.search_results_mouseout(b)}),this.search_results.bind("mousewheel.chosen DOMMouseScroll.chosen",function(b){a.search_results_mousewheel(b)}),this.form_field_jq.bind("chosen:updated.chosen",function(b){
a.results_update_field(b)}),this.form_field_jq.bind("chosen:activate.chosen",function(b){a.activate_field(b)}),this.form_field_jq.bind("chosen:open.chosen",function(b){a.container_mousedown(b)}),this.search_field.bind("blur.chosen",function(b){a.input_blur(b)}),this.search_field.bind("keyup.chosen",function(b){a.keyup_checker(b)}),this.search_field.bind("keydown.chosen",function(b){a.keydown_checker(b)}),this.search_field.bind("focus.chosen",function(b){a.input_focus(b)}),this.is_multiple?this.search_choices.bind("click.chosen",function(b){a.choices_click(b)}):this.container.bind("click.chosen",function(a){a.preventDefault()})},c.prototype.destroy=function(){return a(document).unbind("click.chosen",this.click_test_action),this.search_field[0].tabIndex&&(this.form_field_jq[0].tabIndex=this.search_field[0].tabIndex),this.container.remove(),this.form_field_jq.removeData("chosen"),this.form_field_jq.show()},c.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field_jq[0].disabled,this.is_disabled?(this.container.addClass("chosen-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus.chosen",this.activate_action),this.close_field()):(this.container.removeClass("chosen-disabled"),this.search_field[0].disabled=!1,this.is_multiple?void 0:this.selected_item.bind("focus.chosen",this.activate_action))},c.prototype.container_mousedown=function(b){return this.is_disabled||(b&&"mousedown"===b.type&&!this.results_showing&&b.preventDefault(),null!=b&&a(b.target).hasClass("search-choice-close"))?void 0:(this.active_field?this.is_multiple||!b||a(b.target)[0]!==this.selected_item[0]&&!a(b.target).parents("a.chosen-single").length||(b.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),a(document).bind("click.chosen",this.click_test_action),this.results_show()),this.activate_field())},c.prototype.container_mouseup=function(a){return"ABBR"!==a.target.nodeName||this.is_disabled?void 0:this.results_reset(a)},c.prototype.search_results_mousewheel=function(a){var b,c,d;return b=-(null!=(c=a.originalEvent)?c.wheelDelta:void 0)||(null!=(d=a.originialEvent)?d.detail:void 0),null!=b?(a.preventDefault(),"DOMMouseScroll"===a.type&&(b=40*b),this.search_results.scrollTop(b+this.search_results.scrollTop())):void 0},c.prototype.blur_test=function(){return!this.active_field&&this.container.hasClass("chosen-container-active")?this.close_field():void 0},c.prototype.close_field=function(){return a(document).unbind("click.chosen",this.click_test_action),this.active_field=!1,this.results_hide(),this.container.removeClass("chosen-container-active"),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},c.prototype.activate_field=function(){return this.container.addClass("chosen-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.search_field.focus()},c.prototype.test_active_click=function(b){return this.container.is(a(b.target).closest(".chosen-container"))?this.active_field=!0:this.close_field()},c.prototype.results_build=function(){return this.parsing=!0,this.selected_option_count=null,this.results_data=d.select_to_array(this.form_field),this.is_multiple?this.search_choices.find("li.search-choice").remove():this.is_multiple||(this.single_set_selected_text(),this.disable_search||this.form_field.options.length<=this.disable_search_threshold?(this.search_field[0].readOnly=!0,this.container.addClass("chosen-container-single-nosearch")):(this.search_field[0].readOnly=!1,this.container.removeClass("chosen-container-single-nosearch"))),this.update_results_content(this.results_option_build({first:!0})),this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.parsing=!1},c.prototype.result_do_highlight=function(a){var b,c,d,e,f;if(a.length){if(this.result_clear_highlight(),this.result_highlight=a,this.result_highlight.addClass("highlighted"),d=parseInt(this.search_results.css("maxHeight"),10),f=this.search_results.scrollTop(),e=d+f,c=this.result_highlight.position().top+this.search_results.scrollTop(),b=c+this.result_highlight.outerHeight(),b>=e)return this.search_results.scrollTop(b-d>0?b-d:0);if(f>c)return this.search_results.scrollTop(c)}},c.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},c.prototype.results_show=function(){return this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.container.addClass("chosen-with-drop"),this.form_field_jq.trigger("chosen:showing_dropdown",{chosen:this}),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.winnow_results())},c.prototype.update_results_content=function(a){return this.search_results.html(a)},c.prototype.results_hide=function(){return this.results_showing&&(this.result_clear_highlight(),this.container.removeClass("chosen-with-drop"),this.form_field_jq.trigger("chosen:hiding_dropdown",{chosen:this})),this.results_showing=!1},c.prototype.set_tab_index=function(){var a;return this.form_field.tabIndex?(a=this.form_field.tabIndex,this.form_field.tabIndex=-1,this.search_field[0].tabIndex=a):void 0},c.prototype.set_label_behavior=function(){var b=this;return this.form_field_label=this.form_field_jq.parents("label"),!this.form_field_label.length&&this.form_field.id.length&&(this.form_field_label=a("label[for='"+this.form_field.id+"']")),this.form_field_label.length>0?this.form_field_label.bind("click.chosen",function(a){return b.is_multiple?b.container_mousedown(a):b.activate_field()}):void 0},c.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices_count()<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},c.prototype.search_results_mouseup=function(b){var c;return c=a(b.target).hasClass("active-result")?a(b.target):a(b.target).parents(".active-result").first(),c.length?(this.result_highlight=c,this.result_select(b),this.search_field.focus()):void 0},c.prototype.search_results_mouseover=function(b){var c;return c=a(b.target).hasClass("active-result")?a(b.target):a(b.target).parents(".active-result").first(),c?this.result_do_highlight(c):void 0},c.prototype.search_results_mouseout=function(b){return a(b.target).hasClass("active-result")?this.result_clear_highlight():void 0},c.prototype.choice_build=function(b){var c,d,e=this;return c=a("<li />",{"class":"search-choice"}).html("<span>"+b.html+"</span>"),b.disabled?c.addClass("search-choice-disabled"):(d=a("<a />",{"class":"search-choice-close","data-option-array-index":b.array_index}),d.bind("click.chosen",function(a){return e.choice_destroy_link_click(a)}),c.append(d)),this.search_container.before(c)},c.prototype.choice_destroy_link_click=function(b){return b.preventDefault(),b.stopPropagation(),this.is_disabled?void 0:this.choice_destroy(a(b.target))},c.prototype.choice_destroy=function(a){return this.result_deselect(a[0].getAttribute("data-option-array-index"))?(this.show_search_field_default(),this.is_multiple&&this.choices_count()>0&&this.search_field.val().length<1&&this.results_hide(),a.parents("li").first().remove(),this.search_field_scale()):void 0},c.prototype.results_reset=function(){return this.form_field.options[0].selected=!0,this.selected_option_count=null,this.single_set_selected_text(),this.show_search_field_default(),this.results_reset_cleanup(),this.form_field_jq.trigger("change"),this.active_field?this.results_hide():void 0},c.prototype.results_reset_cleanup=function(){return this.current_selectedIndex=this.form_field.selectedIndex,this.selected_item.find("abbr").remove()},c.prototype.result_select=function(a){var b,c,d;return this.result_highlight?(b=this.result_highlight,this.result_clear_highlight(),this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.is_multiple?b.removeClass("active-result"):(this.result_single_selected&&(this.result_single_selected.removeClass("result-selected"),d=this.result_single_selected[0].getAttribute("data-option-array-index"),this.results_data[d].selected=!1),this.result_single_selected=b),b.addClass("result-selected"),c=this.results_data[b[0].getAttribute("data-option-array-index")],c.selected=!0,this.form_field.options[c.options_index].selected=!0,this.selected_option_count=null,this.is_multiple?this.choice_build(c):this.single_set_selected_text(c.text),(a.metaKey||a.ctrlKey)&&this.is_multiple||this.results_hide(),this.search_field.val(""),(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex)&&this.form_field_jq.trigger("change",{selected:this.form_field.options[c.options_index].value}),this.current_selectedIndex=this.form_field.selectedIndex,this.search_field_scale())):void 0},c.prototype.single_set_selected_text=function(a){return null==a&&(a=this.default_text),a===this.default_text?this.selected_item.addClass("chosen-default"):(this.single_deselect_control_build(),this.selected_item.removeClass("chosen-default")),this.selected_item.find("span").text(a)},c.prototype.result_deselect=function(a){var b;return b=this.results_data[a],this.form_field.options[b.options_index].disabled?!1:(b.selected=!1,this.form_field.options[b.options_index].selected=!1,this.selected_option_count=null,this.result_clear_highlight(),this.results_showing&&this.winnow_results(),this.form_field_jq.trigger("change",{deselected:this.form_field.options[b.options_index].value}),this.search_field_scale(),!0)},c.prototype.single_deselect_control_build=function(){return this.allow_single_deselect?(this.selected_item.find("abbr").length||this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>'),this.selected_item.addClass("chosen-single-with-deselect")):void 0},c.prototype.get_search_text=function(){return this.search_field.val()===this.default_text?"":a("<div/>").text(a.trim(this.search_field.val())).html()},c.prototype.winnow_results_set_highlight=function(){var a,b;return b=this.is_multiple?[]:this.search_results.find(".result-selected.active-result"),a=b.length?b.first():this.search_results.find(".active-result").first(),null!=a?this.result_do_highlight(a):void 0},c.prototype.no_results=function(b){var c;return c=a('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>'),c.find("span").first().html(b),this.search_results.append(c)},c.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},c.prototype.keydown_arrow=function(){var a;return this.results_showing&&this.result_highlight?(a=this.result_highlight.nextAll("li.active-result").first())?this.result_do_highlight(a):void 0:this.results_show()},c.prototype.keyup_arrow=function(){var a;return this.results_showing||this.is_multiple?this.result_highlight?(a=this.result_highlight.prevAll("li.active-result"),a.length?this.result_do_highlight(a.first()):(this.choices_count()>0&&this.results_hide(),this.result_clear_highlight())):void 0:this.results_show()},c.prototype.keydown_backstroke=function(){var a;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(a=this.search_container.siblings("li.search-choice").last(),a.length&&!a.hasClass("search-choice-disabled")?(this.pending_backstroke=a,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")):void 0)},c.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},c.prototype.keydown_checker=function(a){var b,c;switch(b=null!=(c=a.which)?c:a.keyCode,this.search_field_scale(),8!==b&&this.pending_backstroke&&this.clear_backstroke(),b){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(a),this.mouse_on_container=!1;break;case 13:a.preventDefault();break;case 38:a.preventDefault(),this.keyup_arrow();break;case 40:a.preventDefault(),this.keydown_arrow()}},c.prototype.search_field_scale=function(){var b,c,d,e,f,g,h,i,j;if(this.is_multiple){for(d=0,h=0,f="position:absolute; left: -1000px; top: -1000px; display:none;",g=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"],i=0,j=g.length;j>i;i++)e=g[i],f+=e+":"+this.search_field.css(e)+";";return b=a("<div />",{style:f}),b.text(this.search_field.val()),a("body").append(b),h=b.width()+25,b.remove(),c=this.container.outerWidth(),h>c-10&&(h=c-10),this.search_field.css({width:h+"px"})}},c}(b)}.call(this),!function(){var a,b,c,d={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};b=function(){function a(){this.options_index=0,this.parsed=[]}return a.prototype.add_node=function(a){return"OPTGROUP"===a.nodeName.toUpperCase()?this.add_group(a):this.add_option(a)},a.prototype.add_group=function(a){var b,c,d,e,f,g;for(b=this.parsed.length,this.parsed.push({array_index:b,group:!0,label:this.escapeExpression(a.label),children:0,disabled:a.disabled}),f=a.childNodes,g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(this.add_option(c,b,a.disabled));return g},a.prototype.add_option=function(a,b,c){return"OPTION"===a.nodeName.toUpperCase()?(""!==a.text?(null!=b&&(this.parsed[b].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:a.value,text:a.text,html:a.innerHTML,selected:a.selected,disabled:c===!0?c:a.disabled,group_array_index:b,classes:a.className,style:a.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1):void 0},a.prototype.escapeExpression=function(a){var b,c;return null==a||a===!1?"":/[\&\<\>\"\'\`]/.test(a)?(b={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},c=/&(?!\w+;)|[\<\>\"\'\`]/g,a.replace(c,function(a){return b[a]||"&amp;"})):a},a}(),b.select_to_array=function(a){var c,d,e,f,g;for(d=new b,g=a.childNodes,e=0,f=g.length;f>e;e++)c=g[e],d.add_node(c);return d.parsed},a=function(){function a(b,c){this.form_field=b,this.options=null!=c?c:{},a.browser_is_supported()&&(this.is_multiple=this.form_field.multiple,this.set_default_text(),this.set_default_values(),this.setup(),this.set_up_html(),this.register_observers())}return a.prototype.set_default_values=function(){var a=this;return this.click_test_action=function(b){return a.test_active_click(b)},this.activate_action=function(b){return a.activate_field(b)},this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.result_single_selected=null,this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text?this.options.allow_single_deselect:!1,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.enable_split_word_search=null!=this.options.enable_split_word_search?this.options.enable_split_word_search:!0,this.group_search=null!=this.options.group_search?this.options.group_search:!0,this.search_contains=this.options.search_contains||!1,this.single_backstroke_delete=null!=this.options.single_backstroke_delete?this.options.single_backstroke_delete:!0,this.max_selected_options=this.options.max_selected_options||1/0,this.inherit_select_classes=this.options.inherit_select_classes||!1,this.display_selected_options=null!=this.options.display_selected_options?this.options.display_selected_options:!0,this.display_disabled_options=null!=this.options.display_disabled_options?this.options.display_disabled_options:!0},a.prototype.set_default_text=function(){return this.default_text=this.form_field.getAttribute("data-placeholder")?this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.options.placeholder_text_multiple||this.options.placeholder_text||a.default_multiple_text:this.options.placeholder_text_single||this.options.placeholder_text||a.default_single_text,this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||a.default_no_result_text},a.prototype.mouse_enter=function(){return this.mouse_on_container=!0},a.prototype.mouse_leave=function(){return this.mouse_on_container=!1},a.prototype.input_focus=function(){var a=this;if(this.is_multiple){if(!this.active_field)return setTimeout(function(){return a.container_mousedown()},50)}else if(!this.active_field)return this.activate_field()},a.prototype.input_blur=function(){var a=this;return this.mouse_on_container?void 0:(this.active_field=!1,setTimeout(function(){return a.blur_test()},100))},a.prototype.results_option_build=function(a){var b,c,d,e,f;for(b="",f=this.results_data,d=0,e=f.length;e>d;d++)c=f[d],b+=c.group?this.result_add_group(c):this.result_add_option(c),(null!=a?a.first:void 0)&&(c.selected&&this.is_multiple?this.choice_build(c):c.selected&&!this.is_multiple&&this.single_set_selected_text(c.text));return b},a.prototype.result_add_option=function(a){var b,c;return a.search_match&&this.include_option_in_results(a)?(b=[],a.disabled||a.selected&&this.is_multiple||b.push("active-result"),!a.disabled||a.selected&&this.is_multiple||b.push("disabled-result"),a.selected&&b.push("result-selected"),null!=a.group_array_index&&b.push("group-option"),""!==a.classes&&b.push(a.classes),c=""!==a.style.cssText?' style="'+a.style+'"':"",'<li class="'+b.join(" ")+'"'+c+' data-option-array-index="'+a.array_index+'">'+a.search_text+"</li>"):""},a.prototype.result_add_group=function(a){return(a.search_match||a.group_match)&&a.active_options>0?'<li class="group-result">'+a.search_text+"</li>":""},a.prototype.results_update_field=function(){return this.set_default_text(),this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.result_single_selected=null,this.results_build(),this.results_showing?this.winnow_results():void 0},a.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},a.prototype.results_search=function(){return this.results_showing?this.winnow_results():this.results_show()},a.prototype.winnow_results=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m;for(this.no_results_clear(),e=0,g=this.get_search_text(),a=g.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),d=this.search_contains?"":"^",c=new RegExp(d+a,"i"),j=new RegExp(a,"i"),m=this.results_data,k=0,l=m.length;l>k;k++)b=m[k],b.search_match=!1,f=null,this.include_option_in_results(b)&&(b.group&&(b.group_match=!1,b.active_options=0),null!=b.group_array_index&&this.results_data[b.group_array_index]&&(f=this.results_data[b.group_array_index],0===f.active_options&&f.search_match&&(e+=1),f.active_options+=1),(!b.group||this.group_search)&&(b.search_text=b.group?b.label:b.html,b.search_match=this.search_string_match(b.search_text,c),b.search_match&&!b.group&&(e+=1),b.search_match?(g.length&&(h=b.search_text.search(j),i=b.search_text.substr(0,h+g.length)+"</em>"+b.search_text.substr(h+g.length),b.search_text=i.substr(0,h)+"<em>"+i.substr(h)),null!=f&&(f.group_match=!0)):null!=b.group_array_index&&this.results_data[b.group_array_index].search_match&&(b.search_match=!0)));return this.result_clear_highlight(),1>e&&g.length?(this.update_results_content(""),this.no_results(g)):(this.update_results_content(this.results_option_build()),this.winnow_results_set_highlight())},a.prototype.search_string_match=function(a,b){var c,d,e,f;if(b.test(a))return!0;if(this.enable_split_word_search&&(a.indexOf(" ")>=0||0===a.indexOf("["))&&(d=a.replace(/\[|\]/g,"").split(" "),d.length))for(e=0,f=d.length;f>e;e++)if(c=d[e],b.test(c))return!0},a.prototype.choices_count=function(){var a,b,c,d;if(null!=this.selected_option_count)return this.selected_option_count;for(this.selected_option_count=0,d=this.form_field.options,b=0,c=d.length;c>b;b++)a=d[b],a.selected&&(this.selected_option_count+=1);return this.selected_option_count},a.prototype.choices_click=function(a){return a.preventDefault(),this.results_showing||this.is_disabled?void 0:this.results_show()},a.prototype.keyup_checker=function(a){var b,c;switch(b=null!=(c=a.which)?c:a.keyCode,this.search_field_scale(),b){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices_count()>0)return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:if(a.preventDefault(),this.results_showing)return this.result_select(a);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}},a.prototype.container_width=function(){return null!=this.options.width?this.options.width:""+this.form_field.offsetWidth+"px"},a.prototype.include_option_in_results=function(a){return this.is_multiple&&!this.display_selected_options&&a.selected?!1:!this.display_disabled_options&&a.disabled?!1:a.empty?!1:!0},a.browser_is_supported=function(){return"Microsoft Internet Explorer"===window.navigator.appName?document.documentMode>=8:/iP(od|hone)/i.test(window.navigator.userAgent)?!1:/Android/i.test(window.navigator.userAgent)&&/Mobile/i.test(window.navigator.userAgent)?!1:!0},a.default_multiple_text="Select Some Options",a.default_single_text="Select an Option",a.default_no_result_text="No results match",a}(),this.Chosen=function(a){function d(){return c=d.__super__.constructor.apply(this,arguments)}return e(d,a),d.prototype.setup=function(){return this.current_selectedIndex=this.form_field.selectedIndex,this.is_rtl=this.form_field.hasClassName("chosen-rtl")},d.prototype.set_default_values=function(){return d.__super__.set_default_values.call(this),this.single_temp=new Template('<a class="chosen-single chosen-default" tabindex="-1"><span>#{default}</span><div><b></b></div></a><div class="chosen-drop"><div class="chosen-search"><input type="text" autocomplete="off" /></div><ul class="chosen-results"></ul></div>'),this.multi_temp=new Template('<ul class="chosen-choices"><li class="search-field"><input type="text" value="#{default}" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chosen-drop"><ul class="chosen-results"></ul></div>'),this.no_results_temp=new Template('<li class="no-results">'+this.results_none_found+' "<span>#{terms}</span>"</li>')},d.prototype.set_up_html=function(){var a,b;return a=["chosen-container"],a.push("chosen-container-"+(this.is_multiple?"multi":"single")),this.inherit_select_classes&&this.form_field.className&&a.push(this.form_field.className),this.is_rtl&&a.push("chosen-rtl"),b={"class":a.join(" "),style:"width: "+this.container_width()+";",title:this.form_field.title},this.form_field.id.length&&(b.id=this.form_field.id.replace(/[^\w]/g,"_")+"_chosen"),this.container=this.is_multiple?new Element("div",b).update(this.multi_temp.evaluate({"default":this.default_text})):new Element("div",b).update(this.single_temp.evaluate({"default":this.default_text})),this.form_field.hide().insert({after:this.container}),this.dropdown=this.container.down("div.chosen-drop"),this.search_field=this.container.down("input"),this.search_results=this.container.down("ul.chosen-results"),this.search_field_scale(),this.search_no_results=this.container.down("li.no-results"),this.is_multiple?(this.search_choices=this.container.down("ul.chosen-choices"),this.search_container=this.container.down("li.search-field")):(this.search_container=this.container.down("div.chosen-search"),this.selected_item=this.container.down(".chosen-single")),this.results_build(),this.set_tab_index(),this.set_label_behavior(),this.form_field.fire("chosen:ready",{chosen:this})},d.prototype.register_observers=function(){var a=this;return this.container.observe("mousedown",function(b){return a.container_mousedown(b)}),this.container.observe("mouseup",function(b){return a.container_mouseup(b)}),this.container.observe("mouseenter",function(b){return a.mouse_enter(b)}),this.container.observe("mouseleave",function(b){return a.mouse_leave(b)}),this.search_results.observe("mouseup",function(b){return a.search_results_mouseup(b)}),this.search_results.observe("mouseover",function(b){return a.search_results_mouseover(b)}),this.search_results.observe("mouseout",function(b){return a.search_results_mouseout(b)}),this.search_results.observe("mousewheel",function(b){return a.search_results_mousewheel(b)}),this.search_results.observe("DOMMouseScroll",function(b){return a.search_results_mousewheel(b)}),this.form_field.observe("chosen:updated",function(b){return a.results_update_field(b)}),this.form_field.observe("chosen:activate",function(b){return a.activate_field(b)}),this.form_field.observe("chosen:open",function(b){return a.container_mousedown(b)}),this.search_field.observe("blur",function(b){return a.input_blur(b)}),this.search_field.observe("keyup",function(b){return a.keyup_checker(b)}),this.search_field.observe("keydown",function(b){return a.keydown_checker(b)}),this.search_field.observe("focus",function(b){return a.input_focus(b)}),this.is_multiple?this.search_choices.observe("click",function(b){return a.choices_click(b)}):this.container.observe("click",function(a){return a.preventDefault()})},d.prototype.destroy=function(){return document.stopObserving("click",this.click_test_action),this.form_field.stopObserving(),this.container.stopObserving(),this.search_results.stopObserving(),this.search_field.stopObserving(),null!=this.form_field_label&&this.form_field_label.stopObserving(),this.is_multiple?(this.search_choices.stopObserving(),this.container.select(".search-choice-close").each(function(a){return a.stopObserving()})):this.selected_item.stopObserving(),this.search_field.tabIndex&&(this.form_field.tabIndex=this.search_field.tabIndex),this.container.remove(),this.form_field.show()},d.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field.disabled,this.is_disabled?(this.container.addClassName("chosen-disabled"),this.search_field.disabled=!0,this.is_multiple||this.selected_item.stopObserving("focus",this.activate_action),this.close_field()):(this.container.removeClassName("chosen-disabled"),this.search_field.disabled=!1,this.is_multiple?void 0:this.selected_item.observe("focus",this.activate_action))},d.prototype.container_mousedown=function(a){return this.is_disabled||(a&&"mousedown"===a.type&&!this.results_showing&&a.stop(),null!=a&&a.target.hasClassName("search-choice-close"))?void 0:(this.active_field?this.is_multiple||!a||a.target!==this.selected_item&&!a.target.up("a.chosen-single")||this.results_toggle():(this.is_multiple&&this.search_field.clear(),document.observe("click",this.click_test_action),this.results_show()),this.activate_field())},d.prototype.container_mouseup=function(a){return"ABBR"!==a.target.nodeName||this.is_disabled?void 0:this.results_reset(a)},d.prototype.search_results_mousewheel=function(a){var b;return b=-a.wheelDelta||a.detail,null!=b?(a.preventDefault(),"DOMMouseScroll"===a.type&&(b=40*b),this.search_results.scrollTop=b+this.search_results.scrollTop):void 0},d.prototype.blur_test=function(){return!this.active_field&&this.container.hasClassName("chosen-container-active")?this.close_field():void 0},d.prototype.close_field=function(){return document.stopObserving("click",this.click_test_action),this.active_field=!1,this.results_hide(),this.container.removeClassName("chosen-container-active"),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},d.prototype.activate_field=function(){return this.container.addClassName("chosen-container-active"),this.active_field=!0,this.search_field.value=this.search_field.value,this.search_field.focus()},d.prototype.test_active_click=function(a){return a.target.up(".chosen-container")===this.container?this.active_field=!0:this.close_field()},d.prototype.results_build=function(){return this.parsing=!0,this.selected_option_count=null,this.results_data=b.select_to_array(this.form_field),this.is_multiple?this.search_choices.select("li.search-choice").invoke("remove"):this.is_multiple||(this.single_set_selected_text(),this.disable_search||this.form_field.options.length<=this.disable_search_threshold?(this.search_field.readOnly=!0,this.container.addClassName("chosen-container-single-nosearch")):(this.search_field.readOnly=!1,this.container.removeClassName("chosen-container-single-nosearch"))),this.update_results_content(this.results_option_build({first:!0})),this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.parsing=!1},d.prototype.result_do_highlight=function(a){var b,c,d,e,f;return this.result_clear_highlight(),this.result_highlight=a,this.result_highlight.addClassName("highlighted"),d=parseInt(this.search_results.getStyle("maxHeight"),10),f=this.search_results.scrollTop,e=d+f,c=this.result_highlight.positionedOffset().top,b=c+this.result_highlight.getHeight(),b>=e?this.search_results.scrollTop=b-d>0?b-d:0:f>c?this.search_results.scrollTop=c:void 0},d.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClassName("highlighted"),this.result_highlight=null},d.prototype.results_show=function(){return this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field.fire("chosen:maxselected",{chosen:this}),!1):(this.container.addClassName("chosen-with-drop"),this.form_field.fire("chosen:showing_dropdown",{chosen:this}),this.results_showing=!0,this.search_field.focus(),this.search_field.value=this.search_field.value,this.winnow_results())},d.prototype.update_results_content=function(a){return this.search_results.update(a)},d.prototype.results_hide=function(){return this.results_showing&&(this.result_clear_highlight(),this.container.removeClassName("chosen-with-drop"),this.form_field.fire("chosen:hiding_dropdown",{chosen:this})),this.results_showing=!1},d.prototype.set_tab_index=function(){var a;return this.form_field.tabIndex?(a=this.form_field.tabIndex,this.form_field.tabIndex=-1,this.search_field.tabIndex=a):void 0},d.prototype.set_label_behavior=function(){var a=this;return this.form_field_label=this.form_field.up("label"),null==this.form_field_label&&(this.form_field_label=$$("label[for='"+this.form_field.id+"']").first()),null!=this.form_field_label?this.form_field_label.observe("click",function(b){return a.is_multiple?a.container_mousedown(b):a.activate_field()}):void 0},d.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices_count()<1&&!this.active_field?(this.search_field.value=this.default_text,this.search_field.addClassName("default")):(this.search_field.value="",this.search_field.removeClassName("default"))},d.prototype.search_results_mouseup=function(a){var b;return b=a.target.hasClassName("active-result")?a.target:a.target.up(".active-result"),b?(this.result_highlight=b,this.result_select(a),this.search_field.focus()):void 0},d.prototype.search_results_mouseover=function(a){var b;return b=a.target.hasClassName("active-result")?a.target:a.target.up(".active-result"),b?this.result_do_highlight(b):void 0},d.prototype.search_results_mouseout=function(a){return a.target.hasClassName("active-result")||a.target.up(".active-result")?this.result_clear_highlight():void 0},d.prototype.choice_build=function(a){var b,c,d=this;return b=new Element("li",{"class":"search-choice"}).update("<span>"+a.html+"</span>"),a.disabled?b.addClassName("search-choice-disabled"):(c=new Element("a",{href:"#","class":"search-choice-close",rel:a.array_index}),c.observe("click",function(a){return d.choice_destroy_link_click(a)}),b.insert(c)),this.search_container.insert({
before:b})},d.prototype.choice_destroy_link_click=function(a){return a.preventDefault(),a.stopPropagation(),this.is_disabled?void 0:this.choice_destroy(a.target)},d.prototype.choice_destroy=function(a){return this.result_deselect(a.readAttribute("rel"))?(this.show_search_field_default(),this.is_multiple&&this.choices_count()>0&&this.search_field.value.length<1&&this.results_hide(),a.up("li").remove(),this.search_field_scale()):void 0},d.prototype.results_reset=function(){return this.form_field.options[0].selected=!0,this.selected_option_count=null,this.single_set_selected_text(),this.show_search_field_default(),this.results_reset_cleanup(),"function"==typeof Event.simulate&&this.form_field.simulate("change"),this.active_field?this.results_hide():void 0},d.prototype.results_reset_cleanup=function(){var a;return this.current_selectedIndex=this.form_field.selectedIndex,a=this.selected_item.down("abbr"),a?a.remove():void 0},d.prototype.result_select=function(a){var b,c,d;return this.result_highlight?(b=this.result_highlight,this.result_clear_highlight(),this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field.fire("chosen:maxselected",{chosen:this}),!1):(this.is_multiple?b.removeClassName("active-result"):(this.result_single_selected&&(this.result_single_selected.removeClassName("result-selected"),d=this.result_single_selected.getAttribute("data-option-array-index"),this.results_data[d].selected=!1),this.result_single_selected=b),b.addClassName("result-selected"),c=this.results_data[b.getAttribute("data-option-array-index")],c.selected=!0,this.form_field.options[c.options_index].selected=!0,this.selected_option_count=null,this.is_multiple?this.choice_build(c):this.single_set_selected_text(c.text),(a.metaKey||a.ctrlKey)&&this.is_multiple||this.results_hide(),this.search_field.value="","function"!=typeof Event.simulate||!this.is_multiple&&this.form_field.selectedIndex===this.current_selectedIndex||this.form_field.simulate("change"),this.current_selectedIndex=this.form_field.selectedIndex,this.search_field_scale())):void 0},d.prototype.single_set_selected_text=function(a){return null==a&&(a=this.default_text),a===this.default_text?this.selected_item.addClassName("chosen-default"):(this.single_deselect_control_build(),this.selected_item.removeClassName("chosen-default")),this.selected_item.down("span").update(a)},d.prototype.result_deselect=function(a){var b;return b=this.results_data[a],this.form_field.options[b.options_index].disabled?!1:(b.selected=!1,this.form_field.options[b.options_index].selected=!1,this.selected_option_count=null,this.result_clear_highlight(),this.results_showing&&this.winnow_results(),"function"==typeof Event.simulate&&this.form_field.simulate("change"),this.search_field_scale(),!0)},d.prototype.single_deselect_control_build=function(){return this.allow_single_deselect?(this.selected_item.down("abbr")||this.selected_item.down("span").insert({after:'<abbr class="search-choice-close"></abbr>'}),this.selected_item.addClassName("chosen-single-with-deselect")):void 0},d.prototype.get_search_text=function(){return this.search_field.value===this.default_text?"":this.search_field.value.strip().escapeHTML()},d.prototype.winnow_results_set_highlight=function(){var a;return this.is_multiple||(a=this.search_results.down(".result-selected.active-result")),null==a&&(a=this.search_results.down(".active-result")),null!=a?this.result_do_highlight(a):void 0},d.prototype.no_results=function(a){return this.search_results.insert(this.no_results_temp.evaluate({terms:a}))},d.prototype.no_results_clear=function(){var a,b;for(a=null,b=[];a=this.search_results.down(".no-results");)b.push(a.remove());return b},d.prototype.keydown_arrow=function(){var a;return this.results_showing&&this.result_highlight?(a=this.result_highlight.next(".active-result"))?this.result_do_highlight(a):void 0:this.results_show()},d.prototype.keyup_arrow=function(){var a,b,c;return this.results_showing||this.is_multiple?this.result_highlight?(c=this.result_highlight.previousSiblings(),a=this.search_results.select("li.active-result"),b=c.intersect(a),b.length?this.result_do_highlight(b.first()):(this.choices_count()>0&&this.results_hide(),this.result_clear_highlight())):void 0:this.results_show()},d.prototype.keydown_backstroke=function(){var a;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.down("a")),this.clear_backstroke()):(a=this.search_container.siblings().last(),a&&a.hasClassName("search-choice")&&!a.hasClassName("search-choice-disabled")?(this.pending_backstroke=a,this.pending_backstroke&&this.pending_backstroke.addClassName("search-choice-focus"),this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClassName("search-choice-focus")):void 0)},d.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClassName("search-choice-focus"),this.pending_backstroke=null},d.prototype.keydown_checker=function(a){var b,c;switch(b=null!=(c=a.which)?c:a.keyCode,this.search_field_scale(),8!==b&&this.pending_backstroke&&this.clear_backstroke(),b){case 8:this.backstroke_length=this.search_field.value.length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(a),this.mouse_on_container=!1;break;case 13:a.preventDefault();break;case 38:a.preventDefault(),this.keyup_arrow();break;case 40:a.preventDefault(),this.keydown_arrow()}},d.prototype.search_field_scale=function(){var a,b,c,d,e,f,g,h,i;if(this.is_multiple){for(c=0,g=0,e="position:absolute; left: -1000px; top: -1000px; display:none;",f=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"],h=0,i=f.length;i>h;h++)d=f[h],e+=d+":"+this.search_field.getStyle(d)+";";return a=new Element("div",{style:e}).update(this.search_field.value.escapeHTML()),document.body.appendChild(a),g=Element.measure(a,"width")+25,a.remove(),b=this.container.getWidth(),g>b-10&&(g=b-10),this.search_field.setStyle({width:g+"px"})}},d}(a)}.call(this),function(a){function b(){return a("<div/>")}var c=Math.abs,d=Math.max,e=Math.min,f=Math.round;a.imgAreaSelect=function(g,h){function i(a){return a+qa.left-ra.left}function j(a){return a+qa.top-ra.top}function k(a){return a-qa.left+ra.left}function l(a){return a-qa.top+ra.top}function m(a){return a.pageX-ra.left}function n(a){return a.pageY-ra.top}function o(a){var b=a||S,c=a||T;return{x1:f(ua.x1*b),y1:f(ua.y1*c),x2:f(ua.x2*b),y2:f(ua.y2*c),width:f(ua.x2*b)-f(ua.x1*b),height:f(ua.y2*c)-f(ua.y1*c)}}function p(a,b,c,d,e){var g=e||S,h=e||T;ua={x1:f(a/g||0),y1:f(b/h||0),x2:f(c/g||0),y2:f(d/h||0)},ua.width=ua.x2-ua.x1,ua.height=ua.y2-ua.y1}function q(){J&&ka.width()&&(qa={left:f(ka.offset().left),top:f(ka.offset().top)},N=ka.innerWidth(),O=ka.innerHeight(),qa.top+=ka.outerHeight()-O>>1,qa.left+=ka.outerWidth()-N>>1,V=f(h.minWidth/S)||0,W=f(h.minHeight/T)||0,X=f(e(h.maxWidth/S||1<<24,N)),Y=f(e(h.maxHeight/T||1<<24,O)),"1.3.2"!=a().jquery||"fixed"!=ta||va.getBoundingClientRect||(qa.top+=d(document.body.scrollTop,va.scrollTop),qa.left+=d(document.body.scrollLeft,va.scrollLeft)),ra=/absolute|relative/.test(P.css("position"))?{left:f(P.offset().left)-P.scrollLeft(),top:f(P.offset().top)-P.scrollTop()}:"fixed"==ta?{left:a(document).scrollLeft(),top:a(document).scrollTop()}:{left:0,top:0},L=i(0),M=j(0),(ua.x2>N||ua.y2>O)&&y())}function r(b){if($){switch(la.css({left:i(ua.x1),top:j(ua.y1)}).add(ma).width(ha=ua.width).height(ia=ua.height),ma.add(na).add(pa).css({left:0,top:0}),na.width(d(ha-na.outerWidth()+na.innerWidth(),0)).height(d(ia-na.outerHeight()+na.innerHeight(),0)),a(oa[0]).css({left:L,top:M,width:ua.x1,height:O}),a(oa[1]).css({left:L+ua.x1,top:M,width:ha,height:ua.y1}),a(oa[2]).css({left:L+ua.x2,top:M,width:N-ua.x2,height:O}),a(oa[3]).css({left:L+ua.x1,top:M+ua.y2,width:ha,height:O-ua.y2}),ha-=pa.outerWidth(),ia-=pa.outerHeight(),pa.length){case 8:a(pa[4]).css({left:ha>>1}),a(pa[5]).css({left:ha,top:ia>>1}),a(pa[6]).css({left:ha>>1,top:ia}),a(pa[7]).css({top:ia>>1});case 4:pa.slice(1,3).css({left:ha}),pa.slice(2,4).css({top:ia})}b!==!1&&(a.imgAreaSelect.onKeyPress!=xa&&a(document).unbind(a.imgAreaSelect.keyPress,a.imgAreaSelect.onKeyPress),h.keys&&a(document)[a.imgAreaSelect.keyPress](a.imgAreaSelect.onKeyPress=xa)),ya&&na.outerWidth()-na.innerWidth()==2&&(na.css("margin",0),setTimeout(function(){na.css("margin","auto")},0))}}function s(a){q(),r(a),_=i(ua.x1),aa=j(ua.y1),ba=i(ua.x2),ca=j(ua.y2)}function t(a,b){h.fadeSpeed?a.fadeOut(h.fadeSpeed,b):a.hide()}function u(a){var b=k(m(a))-ua.x1,c=l(n(a))-ua.y1;ja||(q(),ja=!0,la.one("mouseout",function(){ja=!1})),U="",h.resizable&&(c<=h.resizeMargin?U="n":c>=ua.height-h.resizeMargin&&(U="s"),b<=h.resizeMargin?U+="w":b>=ua.width-h.resizeMargin&&(U+="e")),la.css("cursor",U?U+"-resize":h.movable?"move":""),K&&K.toggle()}function v(b){a("body").css("cursor",""),(h.autoHide||ua.width*ua.height==0)&&t(la.add(oa),function(){a(this).hide()}),a(document).unbind("mousemove",z),la.mousemove(u),h.onSelectEnd(g,o())}function w(b){return 1!=b.which?!1:(q(),U?(a("body").css("cursor",U+"-resize"),_=i(ua[/w/.test(U)?"x2":"x1"]),aa=j(ua[/n/.test(U)?"y2":"y1"]),a(document).mousemove(z).one("mouseup",v),la.unbind("mousemove",u)):h.movable?(Q=L+ua.x1-m(b),R=M+ua.y1-n(b),la.unbind("mousemove",u),a(document).mousemove(B).one("mouseup",function(){h.onSelectEnd(g,o()),a(document).unbind("mousemove",B),la.mousemove(u)})):ka.mousedown(b),!1)}function x(a){Z&&(a?(ba=d(L,e(L+N,_+c(ca-aa)*Z*(ba>_||-1))),ca=f(d(M,e(M+O,aa+c(ba-_)/Z*(ca>aa||-1)))),ba=f(ba)):(ca=d(M,e(M+O,aa+c(ba-_)/Z*(ca>aa||-1))),ba=f(d(L,e(L+N,_+c(ca-aa)*Z*(ba>_||-1)))),ca=f(ca)))}function y(){_=e(_,L+N),aa=e(aa,M+O),c(ba-_)<V&&(ba=_-V*(_>ba||-1),L>ba?_=L+V:ba>L+N&&(_=L+N-V)),c(ca-aa)<W&&(ca=aa-W*(aa>ca||-1),M>ca?aa=M+W:ca>M+O&&(aa=M+O-W)),ba=d(L,e(ba,L+N)),ca=d(M,e(ca,M+O)),x(c(ba-_)<c(ca-aa)*Z),c(ba-_)>X&&(ba=_-X*(_>ba||-1),x()),c(ca-aa)>Y&&(ca=aa-Y*(aa>ca||-1),x(!0)),ua={x1:k(e(_,ba)),x2:k(d(_,ba)),y1:l(e(aa,ca)),y2:l(d(aa,ca)),width:c(ba-_),height:c(ca-aa)},r(),h.onSelectChange(g,o())}function z(a){return ba=/w|e|^$/.test(U)||Z?m(a):i(ua.x2),ca=/n|s|^$/.test(U)||Z?n(a):j(ua.y2),y(),!1}function A(b,c){ba=(_=b)+ua.width,ca=(aa=c)+ua.height,a.extend(ua,{x1:k(_),y1:l(aa),x2:k(ba),y2:l(ca)}),r(),h.onSelectChange(g,o())}function B(a){return _=d(L,e(Q+m(a),L+N-ua.width)),aa=d(M,e(R+n(a),M+O-ua.height)),A(_,aa),a.preventDefault(),!1}function C(){a(document).unbind("mousemove",C),q(),ba=_,ca=aa,y(),U="",oa.is(":visible")||la.add(oa).hide().fadeIn(h.fadeSpeed||0),$=!0,a(document).unbind("mouseup",D).mousemove(z).one("mouseup",v),la.unbind("mousemove",u),h.onSelectStart(g,o())}function D(){a(document).unbind("mousemove",C).unbind("mouseup",D),t(la.add(oa)),p(k(_),l(aa),k(_),l(aa)),this instanceof a.imgAreaSelect||(h.onSelectChange(g,o()),h.onSelectEnd(g,o()))}function E(b){return 1!=b.which||oa.is(":animated")?!1:(q(),Q=_=m(b),R=aa=n(b),a(document).mousemove(C).mouseup(D),!1)}function F(){s(!1)}function G(){J=!0,I(h=a.extend({classPrefix:"imgareaselect",movable:!0,parent:"body",resizable:!0,resizeMargin:10,onInit:function(){},onSelectStart:function(){},onSelectChange:function(){},onSelectEnd:function(){}},h)),la.add(oa).css({visibility:""}),h.show&&($=!0,q(),r(),la.add(oa).hide().fadeIn(h.fadeSpeed||0)),setTimeout(function(){h.onInit(g,o())},0)}function H(a,b){for(var c in b)void 0!==h[c]&&a.css(b[c],h[c])}function I(c){if(c.parent&&(P=a(c.parent)).append(la.add(oa)),a.extend(h,c),q(),null!=c.handles){for(pa.remove(),pa=a([]),fa=c.handles?"corners"==c.handles?4:8:0;fa--;)pa=pa.add(b());pa.addClass(h.classPrefix+"-handle").css({position:"absolute",fontSize:0,zIndex:sa+1||1}),!parseInt(pa.css("width"))>=0&&pa.width(5).height(5),(ga=h.borderWidth)&&pa.css({borderWidth:ga,borderStyle:"solid"}),H(pa,{borderColor1:"border-color",borderColor2:"background-color",borderOpacity:"opacity"})}for(S=h.imageWidth/N||1,T=h.imageHeight/O||1,null!=c.x1&&(p(c.x1,c.y1,c.x2,c.y2),c.show=!c.hide),c.keys&&(h.keys=a.extend({shift:1,ctrl:"resize"},c.keys)),oa.addClass(h.classPrefix+"-outer"),ma.addClass(h.classPrefix+"-selection"),fa=0;fa++<4;)a(na[fa-1]).addClass(h.classPrefix+"-border"+fa);H(ma,{selectionColor:"background-color",selectionOpacity:"opacity"}),H(na,{borderOpacity:"opacity",borderWidth:"border-width"}),H(oa,{outerColor:"background-color",outerOpacity:"opacity"}),(ga=h.borderColor1)&&a(na[0]).css({borderStyle:"solid",borderColor:ga}),(ga=h.borderColor2)&&a(na[1]).css({borderStyle:"dashed",borderColor:ga}),la.append(ma.add(na).add(K)).append(pa),ya&&((ga=(oa.css("filter")||"").match(/opacity=(\d+)/))&&oa.css("opacity",ga[1]/100),(ga=(na.css("filter")||"").match(/opacity=(\d+)/))&&na.css("opacity",ga[1]/100)),c.hide?t(la.add(oa)):c.show&&J&&($=!0,la.add(oa).fadeIn(h.fadeSpeed||0),s()),Z=(ea=(h.aspectRatio||"").split(/:/))[0]/ea[1],ka.add(oa).unbind("mousedown",E),h.disable||h.enable===!1?(la.unbind("mousemove",u).unbind("mousedown",w),a(window).unbind("resize",F)):((h.enable||h.disable===!1)&&((h.resizable||h.movable)&&la.mousemove(u).mousedown(w),a(window).resize(F)),h.persistent||ka.add(oa).mousedown(E)),h.enable=h.disable=void 0}var J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka=a(g),la=b(),ma=b(),na=b().add(b()).add(b()).add(b()),oa=b().add(b()).add(b()).add(b()),pa=a([]),qa={left:0,top:0},ra={left:0,top:0},sa=0,ta="absolute",ua={x1:0,y1:0,x2:0,y2:0,width:0,height:0},va=document.documentElement,wa=navigator.userAgent,xa=function(a){var b,c,f=h.keys,g=a.keyCode;if(b=isNaN(f.alt)||!a.altKey&&!a.originalEvent.altKey?!isNaN(f.ctrl)&&a.ctrlKey?f.ctrl:!isNaN(f.shift)&&a.shiftKey?f.shift:isNaN(f.arrows)?10:f.arrows:f.alt,"resize"==f.arrows||"resize"==f.shift&&a.shiftKey||"resize"==f.ctrl&&a.ctrlKey||"resize"==f.alt&&(a.altKey||a.originalEvent.altKey)){switch(g){case 37:b=-b;case 39:c=d(_,ba),_=e(_,ba),ba=d(c+b,_),x();break;case 38:b=-b;case 40:c=d(aa,ca),aa=e(aa,ca),ca=d(c+b,aa),x(!0);break;default:return}y()}else switch(_=e(_,ba),aa=e(aa,ca),g){case 37:A(d(_-b,L),aa);break;case 38:A(_,d(aa-b,M));break;case 39:A(_+e(b,N-k(ba)),aa);break;case 40:A(_,aa+e(b,O-l(ca)));break;default:return}return!1};this.remove=function(){I({disable:!0}),la.add(oa).remove()},this.getOptions=function(){return h},this.setOptions=I,this.getSelection=o,this.setSelection=p,this.cancelSelection=D,this.update=s;var ya=(/msie ([\w.]+)/i.exec(wa)||[])[1],za=/opera/i.test(wa),Aa=/webkit/i.test(wa)&&!/chrome/i.test(wa);for(da=ka;da.length;)sa=d(sa,isNaN(da.css("z-index"))?sa:da.css("z-index")),"fixed"==da.css("position")&&(ta="fixed"),da=da.parent(":not(body)");sa=h.zIndex||sa,ya&&ka.attr("unselectable","on"),a.imgAreaSelect.keyPress=ya||Aa?"keydown":"keypress",za&&(K=b().css({width:"100%",height:"100%",position:"absolute",zIndex:sa+2||2})),la.add(oa).css({visibility:"hidden",position:ta,overflow:"hidden",zIndex:sa||"0"}),la.css({zIndex:sa+2||2}),ma.add(na).css({position:"absolute",fontSize:0}),g.complete||"complete"==g.readyState||!ka.is("img")?G():ka.one("load",G),!J&&ya&&ya>=7&&(g.src=g.src)},a.fn.imgAreaSelect=function(b){return b=b||{},this.each(function(){a(this).data("imgAreaSelect")?b.remove?(a(this).data("imgAreaSelect").remove(),a(this).removeData("imgAreaSelect")):a(this).data("imgAreaSelect").setOptions(b):b.remove||(void 0===b.enable&&void 0===b.disable&&(b.enable=!0),a(this).data("imgAreaSelect",new a.imgAreaSelect(this,b)))}),b.instance?a(this).data("imgAreaSelect"):this}}(jQuery),function(a){a.fn.hoverIntent=function(b,c,d){var e={interval:100,sensitivity:6,timeout:0};e="object"==typeof b?a.extend(e,b):a.isFunction(c)?a.extend(e,{over:b,out:c,selector:d}):a.extend(e,{over:b,out:b,selector:c});var f,g,h,i,j=function(a){f=a.pageX,g=a.pageY},k=function(b,c){return c.hoverIntent_t=clearTimeout(c.hoverIntent_t),Math.sqrt((h-f)*(h-f)+(i-g)*(i-g))<e.sensitivity?(a(c).off("mousemove.hoverIntent",j),c.hoverIntent_s=!0,e.over.apply(c,[b])):(h=f,i=g,c.hoverIntent_t=setTimeout(function(){k(b,c)},e.interval),void 0)},l=function(a,b){return b.hoverIntent_t=clearTimeout(b.hoverIntent_t),b.hoverIntent_s=!1,e.out.apply(b,[a])},m=function(b){var c=a.extend({},b),d=this;d.hoverIntent_t&&(d.hoverIntent_t=clearTimeout(d.hoverIntent_t)),"mouseenter"===b.type?(h=c.pageX,i=c.pageY,a(d).on("mousemove.hoverIntent",j),d.hoverIntent_s||(d.hoverIntent_t=setTimeout(function(){k(c,d)},e.interval))):(a(d).off("mousemove.hoverIntent",j),d.hoverIntent_s&&(d.hoverIntent_t=setTimeout(function(){l(c,d)},e.timeout)))};return this.on({"mouseenter.hoverIntent":m,"mouseleave.hoverIntent":m},e.selector)}}(jQuery),function(a){"function"==typeof define&&define.amd?define(["moment"],a):"object"==typeof exports?module.exports=a(require("../moment")):a(window.moment)}(function(a){function b(a,b,c,d){var e={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[a+" Tage",a+" Tagen"],M:["ein Monat","einem Monat"],MM:[a+" Monate",a+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[a+" Jahre",a+" Jahren"]};return b?e[c][0]:e[c][1]}return a.defineLocale("de",{months:"Januar_Februar_März_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Febr._Mrz._Apr._Mai_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"),weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm [Uhr]",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[Heute um] LT",sameElse:"L",nextDay:"[Morgen um] LT",nextWeek:"dddd [um] LT",lastDay:"[Gestern um] LT",lastWeek:"[letzten] dddd [um] LT"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",m:b,mm:"%d Minuten",h:b,hh:"%d Stunden",d:b,dd:b,M:b,MM:b,y:b,yy:b},ordinal:"%d.",week:{dow:1,doy:4}})}),angular.module("bsTable",[]).directive("bsTable",function(){return{restrict:"A",scope:!0,compile:function(a,b){var c=0,d=a.find("tbody:first"),e=d.find("tr:first"),f=void 0!==e.attr("ng-repeat")?e.attr("ng-repeat"):d.attr("ng-repeat"),g=" | bsTableSkip:bsTablePagination.skipAt | limitTo:bsTablePagination.pageSize";void 0!==e.attr("ng-repeat")?e.attr("ng-repeat",f+g):d.attr("ng-repeat",f+g),c=e.children("td").size();var h='<tfoot><tr><td colspan="'+c+'"><ul class="pagination"></ul><select ng-model="bsTablePagination.pageSize" class="form-control select-page-size"><option value="5" >5</option><option value="10">10</option><option value="20" selected="selected">20</option><option value="40">40</option></select></td></tr></tfoot>';return a.append(h),function(a,b){function c(){for(var c="",f=0;f<Math.ceil(j/a.bsTablePagination.pageSize);f++)c+="<li "+(e.page==f+1?'class="active"':"")+'><a ng-href="#">'+(f+1)+"</a></li>";b.find(".pagination").html(c),b.find(".pagination").find("li").bind("click",d)}function d(){var b=parseInt($(this).find("a").text());$(this).parent().find("li").removeClass("active"),$(this).addClass("active"),e.page=b,e.skipAt=(e.page-1)*e.pageSize,a.$digest()}var e=a.bsTablePagination={},g=b.find("td"),h=f.match(/^\s*(.+)\s+in\s+(.*)\s*$/)[2],i=a.$eval(h),j=i.length;a.$watchCollection(h,function(){j=a.$eval(h).length,e.lastPage=Math.ceil(j/e.pageSize),c()}),a.$watch("bsTablePagination.pageSize",function(){c()}),e.pageSize=20,e.lastPage=Math.ceil(j/e.pageSize),e.page=1,e.skipAt=(e.page-1)*e.pageSize,g.children(".select-page-size").change(function(){var b=parseInt($(this).val());e.lastPage=Math.ceil(j/b),e.page=1,e.skipAt=(e.page-1)*b,a.$digest()})}}}}).filter("bsTableSkip",function(){return function(a,b){return a.slice(b)}}),function(){var a,b;a=this.jQuery||window.jQuery,b=a(window),a.fn.stick_in_parent=function(c){var d,e,f,g,h,i,j,k,l,m;for(null==c&&(c={}),j=c.sticky_class,e=c.inner_scrolling,i=c.recalc_every,h=c.parent,g=c.offset_top,f=c.spacer,d=c.bottoming,null==g&&(g=0),null==h&&(h=void 0),null==e&&(e=!0),null==j&&(j="is_stuck"),null==d&&(d=!0),k=function(c,k,l,m,n,o,p,q){var r,s,t,u,v,w,x,y,z,A,B;if(!c.data("sticky_kit")){if(c.data("sticky_kit",!0),w=c.parent(),null!=h&&(w=w.closest(h)),!w.length)throw"failed to find stick parent";if(r=t=!1,(A=null!=f?f&&c.closest(f):a("<div />"))&&A.css("position",c.css("position")),x=function(){var a,b,d;return!q&&(a=parseInt(w.css("border-top-width"),10),b=parseInt(w.css("padding-top"),10),k=parseInt(w.css("padding-bottom"),10),l=w.offset().top+a+b,m=w.height(),t&&(r=t=!1,null==f&&(c.insertAfter(A),A.detach()),c.css({position:"",top:"",width:"",bottom:""}).removeClass(j),d=!0),n=c.offset().top-parseInt(c.css("margin-top"),10)-g,o=c.outerHeight(!0),p=c.css("float"),A&&A.css({width:c.outerWidth(!0),height:o,display:c.css("display"),"vertical-align":c.css("vertical-align"),"float":p}),d)?B():void 0},x(),o!==m)return u=void 0,v=g,z=i,B=function(){var a,h,s,y;return!q&&(null!=z&&(--z,0>=z&&(z=i,x())),s=b.scrollTop(),null!=u&&(h=s-u),u=s,t?(d&&(y=s+o+v>m+l,r&&!y&&(r=!1,c.css({position:"fixed",bottom:"",top:v}).trigger("sticky_kit:unbottom"))),n>s&&(t=!1,v=g,null==f&&("left"!==p&&"right"!==p||c.insertAfter(A),A.detach()),a={position:"",width:"",top:""},c.css(a).removeClass(j).trigger("sticky_kit:unstick")),e&&(a=b.height(),o+g>a&&!r&&(v-=h,v=Math.max(a-o,v),v=Math.min(g,v),t&&c.css({top:v+"px"})))):s>n&&(t=!0,a={position:"fixed",top:v},a.width="border-box"===c.css("box-sizing")?c.outerWidth()+"px":c.width()+"px",c.css(a).addClass(j),null==f&&(c.after(A),"left"!==p&&"right"!==p||A.append(c)),c.trigger("sticky_kit:stick")),t&&d&&(null==y&&(y=s+o+v>m+l),!r&&y))?(r=!0,"static"===w.css("position")&&w.css({position:"relative"}),c.css({position:"absolute",bottom:k,top:"auto"}).trigger("sticky_kit:bottom")):void 0},y=function(){return x(),B()},s=function(){return q=!0,b.off("touchmove",B),b.off("scroll",B),b.off("resize",y),a(document.body).off("sticky_kit:recalc",y),c.off("sticky_kit:detach",s),c.removeData("sticky_kit"),c.css({position:"",bottom:"",top:"",width:""}),w.position("position",""),t?(null==f&&("left"!==p&&"right"!==p||c.insertAfter(A),A.remove()),c.removeClass(j)):void 0},b.on("touchmove",B),b.on("scroll",B),b.on("resize",y),a(document.body).on("sticky_kit:recalc",y),c.on("sticky_kit:detach",s),setTimeout(B,0)}},l=0,m=this.length;m>l;l++)c=this[l],k(a(c));return this}}.call(this),function(a){function b(a){var b,c="";for(b in a)a.hasOwnProperty(b)&&"undefined"!=typeof a[b]&&(c+=b+"="+a[b]+"&");return c.replace(/&$/,"")}function c(a,c,f){for(var h=+new Date,i=document.createElement("script");"undefined"!=typeof g.__jsonp_callbacks[h];)h+=Math.random();g.__jsonp_callbacks[h]=function(){delete g.__jsonp_callbacks[h],c.apply(f,arguments)},a="?format=jsonp&callback="+encodeURIComponent("yourls.__jsonp_callbacks["+h+"]")+"&"+a,a+="&"+b(e),i.setAttribute("src",d+a),document.getElementsByTagName("head")[0].appendChild(i)}var d="",e={},f=a.yourls,g={};g.__jsonp_callbacks={},g.VERSION="1.0.0",g.connect=function(a,b){return d=a,e={},b&&(b.signature?e.signature=b.signature:(e.password=b.password,e.username=b.username)),this},g.shorten=function(a,d,e,f,g){var h={action:"shorturl",url:a,title:e,keyword:d};return c(b(h),f,g),this},g["delete"]=function(a,d,e){var f={action:"delete",keyword:a};return c(b(f),d,e),this},g.stats=function(a,d,e,f){var g={action:"stats"},h=typeof a;switch(h){case"number":g.limit=a,e=d;break;case"function":e=a;break;default:g.filter=a,"function"==typeof d?e=d:g.limit=d}return c(b(g),e,f),this},g.url=function(a){return this instanceof g.url?void(this.url=a):new g.url(a)},g.url.prototype.expand=function(a,d){return c(b({action:"expand",shorturl:this.url}),a,d),this},g.url.prototype.stats=function(a,d){return c(b({action:"url-stats",shorturl:this.url}),a,d),this},g.noConflict=function(){return a.yourls=f,this},"function"==typeof define&&define.amd?define("yourls",function(){return g}):a.yourls=g}(this),angular.module("osApp",["ngCookies","ngResource","ngSanitize","ui.router","wu.masonry","ngAnimate","angular-loading-bar","infinite-scroll","ngTouch","duScroll","angular-inview","ng-context-menu","autocomplete","angulartics","angulartics.google.analytics","djds4rce.angular-socialshare","mgcrea.ngStrap.helpers.dateParser","mgcrea.ngStrap.tooltip","mgcrea.ngStrap.modal","mgcrea.ngStrap.alert","mgcrea.ngStrap.datepicker","mgcrea.ngStrap.timepicker","mgcrea.ngStrap.dropdown","mgcrea.ngStrap.aside","mgcrea.ngStrap.collapse","pascalprecht.translate","angularMoment","froala","angularFileUpload","localytics.directives","xeditable","ct.ui.router.extras","ui.calendar","ui.sortable","bsTable","ui.checkbox","FBAngular"]).value("froalaConfig",{inlineMode:!1,toolbarFixed:!1,placeholder:"",language:"de",fileUploadURL:"/upload_file",buttons:["formatBlock","bold","italic","underline","align","insertOrderedList","insertUnorderedList","createLink","insertImage","insertVideo","removeFormat"]}).config(["$analyticsProvider",function(a){a.virtualPageviews(!1)}]).run(["editableOptions",function(a){a.theme="bs3"}]).run(["$FB",function(a){a.init("593221674063771")}]).run(["amMoment",function(a){a.changeLocale("de")}]).config(["$modalProvider",function(a){angular.extend(a.defaults,{animation:"am-slide-top"})}]).config(["$datepickerProvider",function(a){angular.extend(a.defaults,{dateFormat:"dd.MM.yyyy",startWeek:1,autoclose:!0,modelDateFormat:"yyyy-MM-dd HH:mm:ss",useNative:!0,dateType:"string"})}]).config(["$timepickerProvider",function(a){angular.extend(a.defaults,{timeFormat:"HH:mm",length:7})}]).config(["$translateProvider",function(a){a.translations("de",{WHO:"Wer wir sind",WHAT:"Was wir tun",FUNDING:"Fördergeber",SCIENCE_UPDATES:"Wissen",PROJECTS:"Projekte",SCHULCORNER:"Schulcorner",MEMBERS:"Mitgliedsgesellschaften",FUNDED:"Unsere aktuellen Fördergeber",READ_MORE:"mehr lesen",MORE:"Weiterführendes",HANDS_ON:"Das Molekularbiologische Mitmachlabor",FIND_MORE:"mehr erfahren",INITIATIVE:"Eine gemeinsame Initiative von",SORT:"sortieren nach",CURRENT:"Laufend",PAST:"Abgeschlossen",AGE:"Alter",BOOKINGS:"Kalender",SOLO_REGISTRATION:"Einzelanmeldung",GROUP_REGISTRATION:"Gruppenbuchung",CAMPS:"Summer Science Camp",FAQ:"FAQ",IMPRESSUM:"Impressum",CONTACT:"Kontakt",GUESTBOOK:"Gästebuch",VISITORS:"BesucherInnnen",AVAILABLE_DATES:"freie Einzeltermine",AVAILABLE_DATES_GROUPS:"freie Gruppentermine",FULLY_BOOKED:"Ausgebucht",TODAY:"Heute",FULL_DAY:"Ganztags",REGISTRATION:"Anmeldung",ABOUT_US:"Über uns",IDEA:"Konzept",TEAM:"Team",ORGANIZATION:"Organisation",FACTS:"Zahlen und Fakten",THE_TEAM:"Das Team",OUR_TEAM:"Unser Team",ADVISORY_BOARD:"Der Vorstand",WORKSHOPS:"Kurse/Seminare",GALLERY:"Bildgalerie",PHOTO_GALLERY:"Fotogalerie",MATERIALS:"Kursunterlagen",LOADING_COURSE:"Kurse werden geladen",NO_DATES:"im Moment ist leider kein Termin verfügbar",LOADING_DATES:"Termine werden geladen",CHOOSE_COURSE:"Kurs auswählen",FEES:"Kosten",DURATION:"Dauer",SELECT_DATE:"Termin auswählen",SOLO_DATES:"Einzeltermine",SEND:"Buchen",BOOK:"Buchen",BOOK_WAIT:"Anfrage wird gesendet...",BOOK_SUCCESS:"Kursbuchung eingelangt",BOOK_SUCCESS_MESSAGE:"Vielen Dank für ihre Anmeldung. Sie erhalten in Kürze eine Bestätigung zur Anmeldung an die E-Mailadresse:",BOOK_ERROR:"Anfrageproblem",BOOK_ERROR_MESSAGE:"Leider konnte die Anmeldung nicht versendet werden. Bitte versuchen es nochmal. Sollte dass Problem weiterhin auftreten kontaktieren Sie uns bitte unter:",GROUP:"Gruppe",SEARCHING_TIME_SLOT:"Freie Termine werden gesucht",NOT_AVAILABLE:"Derzeit ist leider kein Termin verfügbar!",WHEN:"Wann?",SELECT_PARTICIPANTS:"Teilnehmeranzahl wählen",NUMBER_PARTICIPANTS:"Wie viele Teilnehmer?",FILL_DETAILS:"Füllen Sie das Kontaktformular aus",FIRSTNAME:"Vorname",LASTNAME:"Nachname",ADDRESS:"Adresse",COMPANY:"Institution",ZIP:"PLZ/Ort",PHONE:"Telefon",MAIL:"E-Mail",REMARKS:"Nachricht",SEND_REG:"Anmelden",REG_SEND_ERROR:"Leider konnte die Anmeldung nicht versendet werden.",REG_SEND_SUCCESS:"Vielen Dank für Ihr Interesse. Ihre Kursanmeldung ist erfolgreich eingelangt.",SEARCH:"Suche nach Themen oder Begriffen",SEARCHRESULT:"Suche nach",TAG:"Schlagwort",NEW_ENTRY:"Neuer Eintrag",MORNING_AFTERNOON:"Vor- & Nachmittags",SUBJECT:"Betreff",POST:"Senden",HOURS:"Stunden",AND:"und",SECURITY_QUESTION:"Sicherheitsabfrage",SECURITY_WRONG:"Das Ergebnis ist leider falsch!",CANCEL:"Abbrechen",NEXT:"Weiter",SEAT:"Platz",SEATS:"Plätze",LEFT:"frei"}),a.translations("en",{WHO:"Who we are",WHAT:"What we do",FUNDING:"Funding",SCIENCE_UPDATES:"Science Updates",PROJECTS:"Projects",SCHULCORNER:"School Corner",MEMBERS:"Members",FUNDED:"We are funded by",READ_MORE:"read more",MORE:"more",HANDS_ON:"The hands-on lab that allows everybody to participate in practical work in life sciences",FIND_MORE:"Find out more",INITIATIVE:"Vienna Open Lab is a joint initiative of",SORT:"sort by ",CURRENT:"Current",PAST:"Past",AGE:"Age",BOOKINGS:"Current Bookings",SOLO_REGISTRATION:"Individual Registration",GROUP_REGISTRATION:"Group Registration ",CAMPS:"Summer Science Camps",FAQ:"FAQ",IMPRESSUM:"Impressum",CONTACT:"Contact",GUESTBOOK:"Guestbook",VISITORS:"Visitors",AVAILABLE_DATES:"Dates available for individuals",AVAILABLE_DATES_GROUPS:"Dates available for groups",FULLY_BOOKED:"Fully booked",TODAY:"Today",FULL_DAY:"Full Day",REGISTRATION:"Registration",ABOUT_US:"About Us",IDEA:"Idea",TEAM:"Team",ORGANIZATION:"Organization",FACTS:"Facts & Numbers",THE_TEAM:"Team",OUR_TEAM:"Our Team",ADVISORY_BOARD:"Advisory Board",WORKSHOPS:"Workshops/Trainings",GALLERY:"Gallery",PHOTO_GALLERY:"Gallery",MATERIALS:"Materials",LOADING_COURSE:"Loading",LOADING_DATES:"Loading",NO_DATES:"at the moment there are no dates available",CHOOSE_COURSE:"Choose Workshop",FEES:"Fees",DURATION:"Duration",SELECT_DATE:"Select Date",SOLO_DATES:"Dates for Individuals",SEND:"send",BOOK:"book",BOOK_WAIT:"Registration is on the way...",BOOK_SUCCESS:"Registration success",BOOK_SUCCESS_MESSAGE:"Thank you for your registration. A confirmation email with all the details has been sent to:",BOOK_ERROR:"Registration failed",BOOK_ERROR_MESSAGE:"Something didnt work. There has been a problem sending your registration. Please try again or contact us:",GROUP:"Group",SEARCHING_TIME_SLOT:"Searching for open time slot",NOT_AVAILABLE:"Currently Not Available!",WHEN:"Which date?",SELECT_PARTICIPANTS:"Select the number of participants",NUMBER_PARTICIPANTS:"Number of Participants?",FILL_DETAILS:"Fill in your contact details",FIRSTNAME:"First name",LASTNAME:"Last name",COMPANY:"Company",ADDRESS:"Address",ZIP:"Zip code/City",PHONE:"Telephone",MAIL:"Email",REMARKS:"Remarks",SEND_REG:"Send",REG_SEND_ERROR:"Sorry, registration could not be processed. Please try again or call +43 1 79044 4591",REG_SEND_SUCCESS:"Thank you for your registration. We will contact you soon.",SEARCH:"Search",SEARCHRESULT:"Search",TAG:"TAG",NEW_ENTRY:"New Entry",MORNING_AFTERNOON:"Morning and Afternoon",SUBJECT:"Subject",POST:"send",HOURS:"hours",AND:"and",SECURITY_QUESTION:"Security question",SECURITY_WRONG:"Your answer is wrong!",CANCEL:"Cancel",NEXT:"Next",SEAT:"Place",SEATS:"Places",LEFT:"left"}),a.preferredLanguage("de"),a.useCookieStorage()}]).constant("SETTINGS",{apiUri:"http://www.openscience.or.at/api",baseUri:""}).constant("AUTH_EVENTS",{loginSuccess:"auth-login-success",loginFailed:"auth-login-failed",logoutSuccess:"auth-logout-success",sessionTimeout:"auth-session-timeout",notAuthenticated:"auth-not-authenticated",notAuthorized:"auth-not-authorized"}).constant("USER_ROLES",{all:"*",admin:"admin",editor:"editor",customer:"customer",guest:"guest"}).run(["$rootScope","$state","$location","$analytics","AuthService","FlashService","AUTH_EVENTS","$timeout",function(a,b,c,d,e,f,g,h){a.$on("$stateChangeStart",function(b,c,d,f,h){a.lastState={state:f,params:h},"true"==e.isLoggedIn()&&(a.isLoggedIn=!0);var i=[];"undefined"!=typeof c.data&&"undefined"!=typeof c.data.authorizedRoles&&(i=c.data.authorizedRoles,e.isAuthorized(i)?a.role=e.getUserRole():(b.preventDefault(),e.isLoggedIn()?a.$broadcast(g.notAuthorized):a.$broadcast(g.notAuthenticated)))}),a.$on("$stateChangeSuccess",function(a,b){h(function(){d.pageTrack(c.path());
},500)}),a.$on(g.notAuthorized,function(a,c){f.show("Zugriff nicht erlaubt!","Sie haben leider keine Rechte, um auf diesen Inhalt zuzugreifen!","danger"),b.go("home")}),a.$on(g.notAuthenticated,function(c,d){delete a.role,f.show("Zugriff nicht erlaubt!","Sie müssen sich zuerst anmelden","danger"),b.go("login")})}]),angular.module("osApp").config(["$stateProvider","$urlRouterProvider","USER_ROLES","AUTH_EVENTS","$locationProvider",function(a,b,c,d,e){b.otherwise("/"),a.state("home",{url:"/",views:{"":{controller:"MainCtrl",templateUrl:"views/main.html"}},data:{pageTitle:"Open Science"}}).state("login",{url:"/login",views:{login:{controller:"LoginCtrl",templateUrl:"views/login.html"}},data:{pageTitle:"Anmelden // Open Science"}}).state("calendar",{url:"/admin/calendar?action",views:{admin:{templateUrl:"views/admin/calendar.html",controller:"CalendarCtrl"}},data:{authorizedRoles:c.admin,pageTitle:"Kalender // OpenScience"}}).state("event",{url:"/admin/event/:id/:type",views:{admin:{templateUrl:"views/admin/event.html",controller:"EventCtrl"}},data:{authorizedRoles:c.admin,pageTitle:"Event // OpenScience"}}).state("events",{url:"/admin/events",views:{admin:{templateUrl:"views/admin/events.html",controller:"EventsCtrl"}},data:{authorizedRoles:c.admin,pageTitle:"Veranstaltungen // OpenScience"}}).state("bookings",{url:"/admin/bookings",views:{admin:{templateUrl:"views/admin/bookings.html",controller:"BookingsCtrl"}},data:{authorizedRoles:c.admin,pageTitle:"Buchungen // OpenScience"}}).state("emailconfig",{url:"/admin/emailconfig",views:{admin:{templateUrl:"views/admin/emailconfig.html",controller:"EmailconfigCtrl"}},data:{authorizedRoles:c.admin,pageTitle:"E-Mails // Buchungen // OpenScience"}}).state("shorturls",{url:"/admin/shorturls",views:{admin:{templateUrl:"views/admin/shorturls.html",controller:"ShorturlsCtrl"}},data:{authorizedRoles:c.admin,pageTitle:"ShortUrls // OpenScience"}}).state("classes",{url:"/admin/classes",views:{admin:{templateUrl:"views/admin/classes.html",controller:"ClassesCtrl"}},data:{authorizedRoles:c.admin,pageTitle:"Kurse // OpenScience"}}).state("class",{url:"/admin/classes/:id",views:{admin:{templateUrl:"views/admin/class.html",controller:"ClassCtrl"}},data:{authorizedRoles:c.admin,pageTitle:"Kurs // OpenScience"}}).state("team",{url:"/admin/team",views:{admin:{templateUrl:"views/admin/team.html",controller:"TeamCtrl"}},data:{authorizedRoles:c.admin,pageTitle:"Team // OpenScience"}}).state("member",{url:"/admin/team/:id",views:{admin:{templateUrl:"views/admin/member.html",controller:"MemberCtrl"}},data:{authorizedRoles:c.admin,pageTitle:"TeamMember // OpenScience"}}).state("partners",{url:"/admin/förderer",views:{admin:{templateUrl:"views/admin/partners.html",controller:"PartnersCtrl"}},data:{authorizedRoles:c.admin,pageTitle:"Förderer // OpenScience"}}).state("partner",{url:"/admin/förderer/:id",views:{admin:{templateUrl:"views/admin/partner.html",controller:"PartnerCtrl"}},data:{authorizedRoles:c.admin,pageTitle:"Förderer // OpenScience"}}).state("coops",{url:"/admin/mitglieder",views:{admin:{templateUrl:"views/admin/coops.html",controller:"CoopsCtrl"}},data:{authorizedRoles:c.admin,pageTitle:"Mitglieder // OpenScience"}}).state("coop",{url:"/admin/mitglieder/:id",views:{admin:{templateUrl:"views/admin/coop.html",controller:"CoopCtrl"}},data:{authorizedRoles:c.admin,pageTitle:"Mitglied // OpenScience"}}).state("tags",{url:"/admin/tags",views:{admin:{templateUrl:"views/admin/tags.html",controller:"TagsCtrl"}},data:{authorizedRoles:c.admin,pageTitle:"Schlagwörter // OpenScience"}}).state("glossar",{url:"/admin/glossar",views:{admin:{templateUrl:"views/admin/glossar.html",controller:"GlossarCtrl"}},data:{authorizedRoles:c.admin,pageTitle:"Glossar // OpenScience"}}).state("quiz",{url:"/admin/quiz",views:{admin:{templateUrl:"views/admin/quiz.html",controller:"QuizCtrl"}},data:{authorizedRoles:c.admin,pageTitle:"Quiz // OpenScience"}}).state("quizdetails",{url:"/admin/quiz/:id",views:{admin:{templateUrl:"views/admin/quizdetails.html",controller:"QuizdetailsCtrl"}},data:{authorizedRoles:c.admin,pageTitle:"Quiz // OpenScience"}}).state("guestbook",{url:"/admin/guestbook",views:{admin:{templateUrl:"views/admin/guestbook.html",controller:"GuestbookCtrl"}},data:{authorizedRoles:c.admin,pageTitle:"Gästebuch // OpenScience"}}).state("faqs",{url:"/admin/faqs",views:{admin:{templateUrl:"views/admin/faqs.html",controller:"FaqsCtrl"}},data:{authorizedRoles:c.admin,pageTitle:"FAQs // OpenScience"}}).state("users",{url:"/admin/accounts",views:{admin:{templateUrl:"views/admin/users.html",controller:"UserCtrl"}},data:{authorizedRoles:c.admin,pageTitle:"Accounts // OpenScience"}}).state("newsletters",{url:"/admin/newsletters",views:{admin:{templateUrl:"views/admin/newsletters.html",controller:"NewslettersCtrl"}},data:{authorizedRoles:c.admin,pageTitle:"Newsletters // OpenScience"}}).state("newslettersConfig",{url:"/admin/newsletters/config",views:{admin:{templateUrl:"views/admin/newsletters-config.html",controller:"NewsletterconfigCtrl"}}}).state("newsletter",{url:"/admin/newsletters/:id",views:{admin:{templateUrl:"views/admin/newsletter.html",controller:"NewsletterCtrl"}},data:{authorizedRoles:c.admin,pageTitle:"Newsletter // OpenScience"}}).state("elabs",{url:"/admin/elabs",views:{admin:{templateUrl:"views/admin/elabs.html",controller:"ElabsCtrl"}},data:{authorizedRoles:c.admin,pageTitle:"eLabs // OpenScience"}}).state("elab",{url:"/admin/elabs/:id",views:{admin:{templateUrl:"views/admin/elab.html",controller:"ElabCtrl"}},data:{authorizedRoles:c.admin,pageTitle:"eLabs // OpenScience"}}).state("tag",{url:"/tag/:name",views:{"":{controller:"TagCtrl",templateUrl:"views/tag.html"}}}).state("search",{url:"/search/:name",views:{"":{controller:"SearchCtrl",templateUrl:"views/search.html"}}}).state("uns",{url:"/uns",views:{"":{templateUrl:"views/uns/index.html",controller:"UnsCtrl"},"content@uns":{templateUrl:"views/uns/main.html",controller:"UnsmainCtrl"}},data:{pageTitle:"Über uns // OpenScience"}}).state("uns.wer",{url:"/wer-wir-sind",views:{"content@uns":{templateUrl:"views/uns/wer.html",controller:"UnswerCtrl"}},data:{pageTitle:"Wer wir sind // OpenScience"}}).state("uns.was",{url:"/was-wir-tun",views:{"content@uns":{templateUrl:"views/uns/was.html",controller:"UnswasCtrl"}},data:{pageTitle:"Was wir tun // OpenScience"}}).state("uns.foerderer",{url:"/fördergeber",views:{"content@uns":{templateUrl:"views/uns/partners.html",controller:"UnspartnerCtrl"}},data:{pageTitle:"Fördergeber // OpenScience"}}).state("uns.mitglieder",{url:"/mitgliedsgesellschaften",views:{"content@uns":{templateUrl:"views/uns/coops.html",controller:"UnscoopsCtrl"}},data:{pageTitle:"Mitgliedsgesellschaften // OpenScience"}}).state("uns.kontakt",{url:"/kontakt",views:{"content@uns":{templateUrl:"views/uns/contact.html",controller:"UnscontactCtrl"}},data:{pageTitle:"Kontakt // OpenScience"}}).state("uns.impressum",{url:"/impressum",views:{"content@uns":{templateUrl:"views/uns/impressum.html",controller:"UnsimpressumCtrl"}},data:{pageTitle:"Impressum // OpenScience"}}).state("uns.wer.person",{url:"/:name"}).state("vol",{url:"/vol",views:{"":{templateUrl:"views/vol/vol.html",controller:"VolCtrl"},"content@vol":{templateUrl:"views/section.main.html",controller:"VolmainCtrl"}},data:{pageTitle:"Vienna Open Lab"}}).state("vol.quiz",{url:"/quiz",views:{"":{templateUrl:"views/vol/vol.html",controller:"VolCtrl"},"content@vol":{templateUrl:"views/section.quiz.html",controller:"SectionquizCtrl"}}}).state("vol.quiz.start",{url:"/:name",views:{"":{templateUrl:"views/vol/vol.html",controller:"VolCtrl"},"content@vol":{templateUrl:"views/section.quiz.start.html",controller:"SectionquizstartCtrl"}}}).state("vol.kurse",{url:"/kurse",views:{"content@vol":{templateUrl:"views/vol/vol.kurse.html",controller:"VolkurseCtrl"}}}).state("vol.kurse.kurs",{url:"/:kurs"}).state("vol.kalender",{url:"/kalender",views:{"content@vol":{templateUrl:"views/vol/vol.kalender.html",controller:"VolkalenderCtrl"}},data:{pageTitle:"Kalender // ViennaOpenLab"}}).state("vol.kalender.lab",{url:"/:lab"}).state("vol.kalender.lab.date",{url:"/:date"}).state("vol.einzelanmeldung",{url:"/einzelanmeldung",views:{"content@vol":{templateUrl:"views/vol/vol.einzelanmeldung.html",controller:"VoleinzelanmeldungCtrl"}},data:{pageTitle:"Einzelanmeldung // ViennaOpenLab"}}).state("vol.einzelanmeldung.kurs",{url:"/:kurs"}).state("vol.einzelanmeldung.kurs.date",{url:"/:date"}).state("vol.gruppenbuchung",{url:"/gruppenbuchung",views:{"content@vol":{templateUrl:"views/vol/vol.gruppenbuchung.html",controller:"VolgruppenbuchungCtrl"}},data:{pageTitle:"Gruppenbuchung // ViennaOpenLab"}}).state("vol.gruppenbuchung.kurs",{url:"/:kurs"}).state("vol.gruppenbuchung.kurs.date",{url:"/:date"}).state("vol.gruppenbuchung.kurs.date.places",{url:"/:places"}).state("vol.seminare",{url:"/seminare",views:{"content@vol":{templateUrl:"views/vol/vol.seminare.html",controller:"VolseminareCtrl"}},data:{pageTitle:"Seminare // ViennaOpenLab"}}).state("vol.seminare.seminar",{url:"/:seminar"}).state("vol.camps",{url:"/summer-science-camps",views:{"content@vol":{templateUrl:"views/vol/vol.camps.html",controller:"VolcampsCtrl"}},data:{pageTitle:"Summer Science Camps // ViennaOpenLab"}}).state("vol.camps.camp",{url:"/:camp"}).state("vol.faq",{url:"/faq",views:{"content@vol":{templateUrl:"views/vol/vol.faq.html",controller:"VolfaqCtrl"}},data:{pageTitle:"FAQ // ViennaOpenLab"}}).state("vol.guestbook",{url:"/gaestebuch",views:{"content@vol":{templateUrl:"views/vol/vol.guestbook.html",controller:"VolguestbookCtrl"}},data:{pageTitle:"Gästebuch // ViennaOpenLab"}}).state("vol.gallery",{url:"/fotogalerie",views:{"content@vol":{templateUrl:"views/vol/vol.gallery.html",controller:"VolgalleryCtrl"}},data:{pageTitle:"Fotogalerie // ViennaOpenLab"}}).state("vol.gallery.details",{url:"/:id"}).state("vol.kontakt",{url:"/kontakt",views:{"content@vol":{templateUrl:"views/vol/vol.kontakt.html",controller:"VolkontaktCtrl"}},data:{pageTitle:"Kontakt // ViennaOpenLab"}}).state("voluns",{url:"/vol/über-uns",views:{"":{templateUrl:"views/vol/vol.uns.html",controller:"VolunsCtrl"},"content@voluns":{templateUrl:"views/vol/vol.uns.main.html",controller:"VolunsmainCtrl"}},data:{pageTitle:"Über uns // ViennaOpenLab"}}).state("voluns.konzept",{url:"/konzept",views:{"content@voluns":{templateUrl:"/views/vol/vol.uns.konzept.html",controller:"VolunskonzeptCtrl"}},data:{pageTitle:"Konzept // ViennaOpenLab"}}).state("voluns.team",{url:"/team",views:{"content@voluns":{templateUrl:"/views/vol/vol.uns.team.html",controller:"VolunsteamCtrl"}},data:{pageTitle:"Team // ViennaOpenLab"}}).state("voluns.team.person",{url:"/:name"}).state("voluns.organisation",{url:"/organisation",views:{"content@voluns":{templateUrl:"views/vol/vol.uns.organisation.html",controller:"VolunsoranisationCtrl"}},data:{pageTitle:"Organisation // ViennaOpenLab"}}).state("voluns.fakten",{url:"/fakten",views:{"content@voluns":{templateUrl:"views/vol/vol.uns.fakten.html",controller:"VolunsfaktenCtrl"}},data:{pageTitle:"Fakten // ViennaOpenLab"}}).state("vol.elab",{url:"/elab",views:{"content@vol":{templateUrl:"views/vol/vol.elab.html",controller:"VolelabCtrl"}},data:{pageTitle:"eLAB // ViennaOpenLab"}}).state("vol.elab.section",{url:"/:id",views:{"content@vol":{templateUrl:"views/vol/vol.elab.section.html",controller:"VolelabsectionCtrl"}},data:{pageTitle:"eLAB // ViennaOpenLab"}}).state("vol.elab.section.details",{url:"/:name",views:{"content@vol":{templateUrl:"views/vol/vol.elab.details.html",controller:"VolelabdetailsCtrl"}},data:{pageTitle:"eLAB // ViennaOpenLab"}}).state("vol.categorie",{url:"/:categorie",views:{"content@vol":{templateUrl:"views/section.categorie.html",controller:"WissencategorieCtrl"}},data:{section:"vol"}}).state("vol.categorie.article",{url:"/:article"}).state("section",{url:"/:section",views:{"":{templateUrl:"views/section.html",controller:"WissenCtrl"},"content@section":{templateUrl:"views/section.main.html",controller:"WissenmainCtrl"}}}).state("section.quiz",{url:"/quiz",views:{"":{templateUrl:"views/section.html",controller:"WissenCtrl"},"content@section":{templateUrl:"views/section.quiz.html",controller:"SectionquizCtrl"}}}).state("section.quiz.start",{url:"/:name",views:{"":{templateUrl:"views/section.html",controller:"WissenCtrl"},"content@section":{templateUrl:"views/section.quiz.start.html",controller:"SectionquizstartCtrl"}}}).state("section.categorie",{url:"/:categorie",views:{"content@section":{templateUrl:"views/section.categorie.html",controller:"WissencategorieCtrl"}}}).state("section.categorie.article",{url:"/:article"}),e.html5Mode(!0).hashPrefix("!")}]),angular.module("osApp").controller("MainCtrl",["$scope","Article","Categorie","Classes",function(a,b,c,d){a.ready={wissen:!1,projekte:!1,schulcorner:!1,vol:!1},a.wissen=c.get({categorieName:"wissen",type:"articles",limit:4,active:1,"new":!0},function(){a.ready.wissen=!0}),a.projekte=c.get({categorieName:"projekte",type:"articles",limit:4,active:1,"new":!0},function(){a.ready.projekte=!0}),a.schulcorner=c.get({categorieName:"schulcorner",type:"articles",limit:4,active:1,"new":!0},function(){a.ready.schulcorner=!0}),a.vol=c.volarticles({categorieName:"vol",type:"articles",limit:4,active:1,order:"main_position"},function(){a.ready.vol=!0}),a.wer=b.get({articleId:542}),a.was=b.get({articleId:543}),a.moreItems=function(){var b=[],d=[],e=[],f=[];a.ready.wissen&&(a.ready.wissen=!1,angular.forEach(a.wissen,function(a){b.push(a.id)}),c.articles({categorieName:"wissen",active:1,limit:4,order:"RAND()",parent:0,not:b.join()},function(b){a.ready.wissen=!0,angular.forEach(b,function(b){a.wissen.push(b)})})),a.ready.projekte&&(a.ready.projekte=!1,angular.forEach(a.projekte,function(a){d.push(a.id)}),c.articles({categorieName:"projekte",active:1,limit:4,order:"RAND()",parent:0,not:d.join()},function(b){a.ready.projekte=!0,angular.forEach(b,function(b){a.projekte.push(b)})})),a.ready.schulcorner&&(a.ready.schulcorner=!1,angular.forEach(a.schulcorner,function(a){e.push(a.id)}),c.articles({categorieName:"schulcorner",active:1,limit:4,order:"RAND()",parent:0,not:e.join()},function(b){a.ready.schulcorner=!0,angular.forEach(b,function(b){a.schulcorner.push(b)})})),a.ready.vol&&(a.ready.vol=!1,angular.forEach(a.vol,function(a){f.push(a.id)}),c.volarticles({categorieName:"vol",active:1,limit:4,order:"RAND()",parent:0,not:f.join()},function(b){a.ready.vol=!0,angular.forEach(b,function(b){a.vol.push(b)})}))}}]),angular.module("osApp").controller("IndexCtrl",["$scope","$rootScope","$state","$document","$timeout","$stateParams","$location","$modal","$alert","$translate","AuthService","FlashService","Question","Article","Search","File","Classes","Email","Newsletter",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){b.opened=!1,a.stop=!1,a.lang=j.use(),a.scrolling=!1,a.search="",a.searchresult=[],a.connections=[],a.fbLink="https://de-de.facebook.com/OpenScience.or.at",a.sectionFilter="",a.langAlert="",a.setArticle={},a["goto"]=function(a,b){c.go(a,b)},a.goBack=function(){b.fromState&&"^"!=b.fromState.url?c.go(b.fromState.name,b.fromParams):c.go("home")},a.gotoSection=function(){var a="home";"vol"==c.current.name.substring(0,c.current.name.indexOf("."))&&(a="vol"),c.go(a)},a.setSectionFilter=function(b){a.sectionFilter===b?a.sectionFilter="":a.sectionFilter=b},a.setFilterUrl=function(b,d){a.sectionFilter=b,c.params.categorie!==d&&c.go("section.categorie",{section:c.params.section,categorie:d})},a.resetFilter=function(){a.sectionFilter=""},a.updateSearchresult=function(b){a.search&&(a.search.length>2?o.search({query:a.search},function(b){a.searchresult=b.suggestions}):a.searchresult=[])},a.selectSearch=function(a){"object"==typeof a&&c.go("section.categorie.article",{section:a.data.section.name,categorie:a.data.categorie.name,article:a.data.name})},a.goSearch=function(a){a.length>2&&c.go("search",{name:a})},a.$on("$stateChangeStart",function(c,d,f,g,h){a.section=f.section,a.catName=f.categorie,"abgeschlossen"!==a.sectionFilter&&"laufend"!==a.sectionFilter||"projekte-a-z"===f.categorie||(a.sectionFilter=""),a.connections=[],a.section||(-1!==d.name.indexOf("vol")?(a.section="vol",a.fbLink="https://www.facebook.com/ViennaOpenLab"):a.fbLink="https://de-de.facebook.com/OpenScience.or.at"),f.section!==h.section&&(a.question=m.query()),"undefined"!=typeof f.article&&(e(function(){a.connections=n.query({articleId:f.article,type:"connectionsbyname",cat:f.categorie,sect:f.section,view:"full"})}),a.activeArticle=f.article),b.$broadcast("nextConnection",-1)}),a.$on("$stateChangeSuccess",function(e,f,g,h,i){if(b.menuOpened=!1,-1==h.url.indexOf("/admin")&&(b.fromState=h,b.fromParams=i),a.state=c,h===f&&!a.scrolling){if("undefined"!=typeof g.article&&g.categorie===i.categorie){var j=angular.element(document.getElementById(g.article));d.scrollToElement(j,70),a.setArticle=angular.element(j).scope().article}if("undefined"!=typeof g.name&&g.categorie===i.categorie){var k=angular.element(document.getElementById(g.name));d.scrollToElement(k,70)}}a.checkLanguage()}),b.activateArticle=function(b){a.setArticle=b},a.checkLanguage=function(){-1!==c.current.name.indexOf("section")&&"en"===a.lang?"object"!=typeof a.langAlert&&(a.langAlert=i({title:"This content is not available in English.",content:' However, an English translation of the <a href="/uns" style="text-decoration:underline">About us</a> and <a href="/vol"  style="text-decoration:underline">Vienna Open Lab</a> section is just waiting to be discovered.',placement:"bottom",animation:"am-slide-bottom",type:"info",show:!0})):"object"==typeof a.langAlert&&(a.langAlert.hide(),a.langAlert.destroy(),a.langAlert="")},a.inThaView=function(d,e,f,g,h,i){if(e&&!b.isLoading){var j=!0,k="section",l="categorie",m="",n="",o={};if("undefined"!=typeof i&&"false"===i)return j=!1,void(a.setArticle=g);if("undefined"!=typeof h)if("team"===h)n=-1!==c.current.name.indexOf("vol")?"voluns.team.person":"uns.wer.person",o.name=g.name;else{var p={section:"kurse",name:"kurs"};switch(g.section.name){case"summercamp":p.section="camps",p.name="camp";break;case"lehrerinnenseminar":p.section="seminare",p.name="seminar";break;case"kurs":}g.dates||(g.dates=q.dates({classId:g.id})),g.files||(g.files=q.files({classId:g.id})),"kalender"==h&&(j=!1),n="vol."+p.section+"."+p.name,o[p.name]=g.name}else m=g.categorie.name,o={section:g.section.name,categorie:m,article:g.name},"undefined"==typeof c.params.section&&(k=c.current.data.section),n=k+"."+l+".article";"bottom"!==f&&(a.setArticle=g,a.scrolling=!0,j&&c.transitionTo(n,o,{}).then(function(){a.scrolling=!1}))}},a.downloadFile=function(a){},a.downloadZip=function(a,b){var c={};"undefined"!=typeof b?(angular.forEach(a,function(a,b){c[b]=a}),p.zip({name:b.name,files:c},function(a){window.location.assign("http://www.openscience.or.at/temp/"+a.filename)})):(angular.forEach(a.files,function(a,b){c[b]=a}),p.zip({name:a.name,files:c},function(a){window.location.assign("http://www.openscience.or.at/temp/"+a.filename)}))},a.sendToEmail=function(b){a.messenger={},a.thisArticle=b,a.mailModal=h({scope:a,template:"views/modal/contentToMail.html",show:!1}),a.mailModal.$promise.then(a.mailModal.show)},a.sendArticleToMail=function(b,c){a.doLoad=!0,r.sendArticle({id:a.thisArticle.id},{from_name:a.messenger.name,from_mail:a.messenger.email,to_mail:a.messenger.receiver_email,from_text:a.messenger.text},function(b){a.doLoad=!1,1==b.success?(a.mailModal.hide(),l.show("Die Email wurde erfolgreich an "+a.messenger.receiver_email+" gesendet!","","success")):l.show("Leider ist ein Fehler beim versenden des Artikels aufgetreten!","","danger")})},a.showNewsletterModal=function(){a.newsletter={},a.newsletter.os=!0,a.newsletter.vol=!0,a.newsletterModal=h({scope:a,template:"views/modal/newsletter.html",show:!1}),a.newsletterModal.$promise.then(a.newsletterModal.show)},a.sendNewsletterRegistartion=function(b){a.doLoad=!0,s.registration({},a.newsletter,function(b){a.doLoad=!1,1==b.success?(a.newsletterModal.hide(),l.show(b.msg,"","success")):l.show(b.msg,"","danger")})},a.changeLanguage=function(b){j.use(b),a.lang=b,a.checkLanguage()},a.setContext=function(b){a.article=b},a.editArticle=function(){a.article.edit=!0},a.abortArticle=function(){a.article.edit=!1,0==a.article.id&&a.articles.splice(a.articles.indexOf(a.article),1),a.article={}},a.saveArticle=function(){a.article.id?n.update({articleId:a.article.id},a.article,function(b){0==b.status?l.show("Fehlgeschlagen","","danger"):(a.article.edit=!1,l.show(b.message,"","success"))}):n.create(a.article,function(b){0==b.status?l.show("Fehlgeschlagen","","danger"):(a.article.id=b.article.id,l.show(b.message,"","success"))})},a.deleteImage=function(){delete a.article.image,a.article.image_id=0},a.question=m.query()}]),angular.module("osApp").factory("Question",["$resource",function(a){return a("http://www.openscience.or.at/api/question",{},{query:{method:"GET"}})}]),angular.module("osApp").controller("WissenCtrl",["$scope","$modal","$stateParams","Categorie","Article","FlashService","Quiz",function(a,b,c,d,e,f,g){var h=0;switch(a.quiz=[],a.color="523C7C",a.section=c.section,c.section){case"wissen":h=611,a.color="523C7C";break;case"projekte":h=609,a.color="1DA9C7";break;case"schulcorner":h=610,a.color="858D1E"}a.article=e.get({articleId:h}),a.categorie=d.categorie({categorieName:c.section},function(){a.categorie=a.categorie[0]}),a.quiz=g.byCategorie({typeId:c.section}),a.editCategorie={},a.doSorting=!1,a.showOffline=!1,a.setCatContext=function(b){a.editCategorie=b},a.editCat=function(){a.catModal=b({scope:a,show:!1,template:"views/admin/modal/categorie.html"}),a.catModal.$promise.then(a.catModal.show)},a.newCat=function(){a.editCategorie={},console.log(a.categorie),a.catModal=b({scope:a,show:!1,template:"views/admin/modal/categorie.html"}),a.catModal.$promise.then(a.catModal.show)},a.editCat=function(){a.catModal=b({scope:a,show:!1,template:"views/admin/modal/categorie.html"}),a.catModal.$promise.then(a.catModal.show)},a.toggleActivation=function(b){a.editCategorie.active=b,a.saveCat(!0)},a.saveCat=function(b){b&&(a.editCategorie.id?d.update({categorieName:a.editCategorie.id},{title:a.editCategorie.title,active:a.editCategorie.active,title_en:a.editCategorie.title_en},function(b){1==b.status?("undefined"!=typeof a.catModal&&a.catModal.hide(),f.show(b.message,"","success")):f.show("Speichern Fehlgeschlagen","","danger",5)}):d.create({},{title:a.editCategorie.title,active:a.editCategorie.active,parent_id:a.categorie.id,title_en:a.editCategorie.title_en},function(b){1==b.status?(a.categorie.categories.push(b.categorie),"undefined"!=typeof a.catModal&&a.catModal.hide(),f.show(b.message,"","success")):f.show("Speichern Fehlgeschlagen","","danger",5)}))},a.deleteCat=function(){a.articles=d.get({categorieName:a.categorie.name,type:a.editCategorie.name,action:"articles",order:"position"},function(b){a.articles.length>0?alert("Diese Kategorie beinhaltet "+a.articles.length+" Beitrage!\nLöschen nicht möglich!"):confirm("Die Kategorie\n"+a.editCategorie.title+"\nentgültig entfernen?")&&d.remove({categorieName:a.editCategorie.id},function(b){1==b.status?(a.categorie.categories.splice(a.categorie.categories.indexOf(a.editCategorie),1),f.show(b.message,"","success")):f.show("Löschen Fehlgeschlagen","","danger",5)})})},a.toggleSorting=function(){a.doSorting=0==a.doSorting?!0:!1},a.sortCategories={orderChanged:function(b){var c=[];angular.forEach(a.categorie.categories,function(a){c.push(a.id)}),d.sort({list:c},function(b){0==b.status?f.show("Fehlgeschlagen","","danger"):(a.article.edit=!1,f.show(b.message,"","success"))})}},a.toggleOffline=function(b){a.showOffline=b}}]),angular.module("osApp").controller("WissenmainCtrl",["$scope","$state","$stateParams","Categorie",function(a,b,c,d){a.ready=!1,a.articles=d.articles({categorieName:c.section,"new":"true",active:1},function(){a.ready=!0}),a.moreItems=function(){if(a.ready){a.ready=!1;var b=[];angular.forEach(a.articles,function(a){b.push(a.id)}),d.articles({categorieName:c.section,active:1,limit:12,order:"RAND()",parent:0,not:b.join()},function(b){a.ready=!0,angular.forEach(b,function(b){a.articles.push(b)})})}},a.$watchCollection("filtered",function(b){"undefined"!=typeof b&&b.length<6&&a.moreItems()})}]),angular.module("osApp").factory("Categorie",["$resource",function(a){return a("http://www.openscience.or.at/api/categorie/:categorieName/:type/:action",{},{query:{method:"GET",params:{categorieName:""}},get:{method:"GET",params:{categorieName:""},isArray:!0},vol:{method:"GET",params:{categorieName:""},isArray:!0},articles:{method:"GET",params:{categorieName:"",type:"articles"},isArray:!0},volarticles:{method:"GET",params:{categorieName:"",type:"articles",action:"volarticles"},isArray:!0},categorie:{method:"GET",params:{categorieName:"",type:""},isArray:!0},update:{method:"PUT",params:{categorieName:""}},create:{method:"POST"},remove:{method:"DELETE"},sort:{method:"PUT",params:{categorieName:"position"}}})}]),angular.module("osApp").filter("htmlToPlaintext",function(){return function(a){var b=String(a).replace(/<[^>]+>/gm,"");return b.substring(0,b.indexOf(".")+1)}}).filter("htmlToPlain",function(){return function(a){return String(a).replace(/<[^>]+>/gm,"")}}),angular.module("osApp").controller("WissencategorieCtrl",["$scope","$rootScope","$state","$timeout","$document","$location","$modal","Categorie","Article","Person","Partner","FileUploader","FileEdit","AuthService","FlashService","ImageEdit","Glossar","Tags","$stateParams",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){a.activeCategorie="",a.activeSection="",s.categorie?a.activeCategorie=s.categorie:c.current.data.categorie&&(a.activeCategorie=c.current.data.categorie),s.section?a.activeSection=s.section:c.current.data.section&&(a.activeSection=c.current.data.section),a.isLoaded=!1,a.article={},a.articles=h.get({categorieName:a.activeSection,type:a.activeCategorie,action:"articles",order:"position"},function(){a.isLoaded=!0,b.isLoading=!0,"undefined"!=typeof c.params.article?d(function(){d(function(){var d=angular.element(document.getElementById(c.params.article));e.scrollToElement(d,70),b.isLoading=!1,angular.forEach(a.articles,function(a){a.name==c.params.article&&b.activateArticle(a)})})}):b.isLoading=!1}),a.showQuestion=!1,a.showAutor=!1,a.showShort=!1,a.showPartners=!1,a.showTags=!1,a.authors=[],a.images=[],a.image={},a.files=[],a.partners=[],a.parts=[],a.tags=[],a.doSorting=!1,a.showAllSchachtel=!1,a.allCategories=[],a.glossar={},a.overview=[],a.sortFilter="",a.hasSection=function(b){var c=!1;if("undefined"!=typeof a.article.sections){var d=a.article.sections.split(",");angular.forEach(d,function(a,d){a==b.name&&(c=!0)})}return c},a.setSection=function(b){if(""==a.article.sections)a.article.sections=b.name;else{var c=a.article.sections.split(",");-1==c.indexOf(b.name)?c.push(b.name):c.splice(c.indexOf(b.name),1),0!=c.length?a.article.sections=c.join(","):a.article.sections=""}i.update({articleId:a.article.id},{sections:a.article.sections},function(b){0==b.status?o.show("Fehlgeschlagen","","danger"):(a.article.edit=!1,o.show(b.message,"","success"))})},a.getSelectionText=function(){var a="";return window.getSelection?a=window.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(a=document.selection.createRange().text),a},a.toggleSorting=function(){a.doSorting=0==a.doSorting?!0:!1},a.toggleSortFilter=function(b){a.sortFilter==b?a.sortFilter="":a.sortFilter=b},a.toggleSchachtel=function(){a.showAllSchachtel=0==a.showAllSchachtel?!0:!1},a.sortController={orderChanged:function(b){var c=[];angular.forEach(a.articles,function(a){c.push(a.id)}),i.sort({list:c},function(b){0==b.status?o.show("Fehlgeschlagen","","danger"):(a.article.edit=!1,o.show(b.message,"","success"))})}},a.savePartners=function(){var b=[];console.log(a.article.partners),angular.forEach(a.article.partners,function(a){b.push(a.id)}),i.partners({articleId:a.article.id},{partners:b},function(b){0==b.status?o.show(b.message,"","danger"):(a.showPartners=!1,o.show(b.message,"","success"))})},a.saveTags=function(){var b=[];console.log(a.article.tags),angular.forEach(a.article.tags,function(a){b.push(a.id)}),i.tags({articleId:a.article.id},{tags:b},function(b){0==b.status?o.show(b.message,"","danger"):(a.showPartners=!1,o.show(b.message,"","success"))})},a.addTag=function(){},a.addGlossar=function(){a.glossar.word=a.textSelection,a.glossarModal=g({scope:a,template:"views/admin/modal/glossar.html",show:!1}),a.glossarModal.$promise.then(a.glossarModal.show)},a.saveGlossar=function(){a.glossar.active=1,q.create(a.glossar,function(b){0==b.status?o.show("Fehlgeschlagen","","danger"):(a.glossarModal.hide(),o.show(b.message,"","success"))})},a.openConnectionModal=function(){0==a.overview.length&&(a.overview=i.overview()),a.article.connections=i.connections({articleId:a.article.name}),a.connectionModal=g({scope:a,template:"views/admin/modal/connections.html"})},a.toggleConnection=function(b){var c=!1;angular.forEach(a.article.connections,function(d,e){d.id==b.id&&(c=!0,a.article.connections.splice(e,1),i.removeConnection({articleId:a.article.id,data:b.id}))}),c||(a.article.connections.push(b),i.addConnection({articleId:a.article.id,data:b.id},{}))},a.saveAuthor=function(){a.updateArticleField("person_id",a.article.person_id),a.showAutor=!1},a.toggleActivation=function(b){a.article.active=b,a.updateArticleField("active",b)},a.saveQuestion=function(){a.updateArticleField("question",a.article.question),a.showQuestion=!1},a.setIntro=function(){a.article.intro=a.textSelection,a.updateArticleField("intro",a.article.intro)},a.updateArticleField=function(b,c){var d={};return d[b]=c,i.update({articleId:a.article.id},d,function(a){0==a.status?o.show("Fehlgeschlagen","","danger"):o.show(a.message,"","success")})},a.setContext=function(b){a.article.edit||(a.article=b),a.textSelection=a.getSelectionText()},a.editArticle=function(){a.article.edit=!0,d(function(){var b=angular.element(document.getElementById(a.article.name));e.scrollToElement(b,70,200)})},a.saveArticle=function(){a.article.id?i.update({articleId:a.article.id},a.article,function(b){0==b.status?o.show("Fehlgeschlagen","","danger"):(a.article.edit=!1,o.show(b.message,"","success"))}):i.create(a.article,function(b){0==b.status?o.show("Fehlgeschlagen","","danger"):(a.article.id=b.article.id,o.show(b.message,"","success"))})},a.abortArticle=function(){a.article.edit=!1,0==a.article.id&&a.articles.splice(a.articles.indexOf(a.article),1),a.article={}},a.deleteArticle=function(){confirm("Den Artikel\n"+a.article.title+"\nendgültig löschen?")&&i.remove({articleId:a.article.id},function(b){a.articles.splice(a.articles.indexOf(a.article),1),a.article={}})},a.switchNew=function(){1===a.article.is_new?a.article.is_new=0:a.article.is_new=1,a.saveArticle()},a.froalaOptions={},a.getText=function(){},a.newArticle=function(){a.article.edit=!1,a.article={id:0,title:"Neuer Artikel",name:"neuer-artikel",text:"",image_id:0,parent_id:0,active:1,categorie_id:a.articles[0].categorie_id,categorie:a.articles[0].categorie,section:a.articles[0].section},a.articles.push(a.article),a.editArticle()},a.deleteImage=function(){delete a.article.image,a.article.image_id=0};var t=function(b){"author"!=b&&(a.showAutor=!1),"short"!=b&&(a.showShort=!1),"partners"!=b&&(a.showPartners=!1),"tags"!=b&&(a.showTags=!1),"question"!=b&&(a.showQuestion=!1)};a.toggleQuestion=function(){t("question"),a.showQuestion=0==a.showQuestion?!0:!1},a.toggleShort=function(){t("short"),a.showShort=0==a.showShort?!0:!1},a.toggleAutor=function(){0==a.authors.length&&0==a.isLoading&&(a.isLoading=!0,a.authors=j.query(function(){a.isLoading=!1})),t("author"),a.showAutor=0==a.showAutor?!0:!1},a.togglePartners=function(){0==a.partners.length&&0==a.isLoading&&(a.isLoading=!0,a.partners=k.query(function(){a.isLoading=!1})),t("partners"),a.showPartners=0==a.showPartners?!0:!1},a.toggleTags=function(){0==a.tags.length&&(a.isLoading=!0,a.tags=r.query(function(){a.isLoading=!1})),t("tags"),a.showTags=0==a.showTags?!0:!1;
},a.setPerson=function(){0!=a.article.person_id&&""!=a.article.person_id&&null!=a.article.person_id?angular.forEach(a.authors,function(b){b.id==a.article.person_id&&(a.article.person=b)}):(a.article.person_id=0,delete a.article.person)},a.cropImage=function(){t(),a.cropModal=g({scope:a,template:"views/admin/modal/cropImage.html",show:!1}),a.cropModal.$promise.then(a.cropModal.show)},a.hideCropping=function(){a.cropModal.hide(),$(".imgareaselect-selection").parent().remove(),$(".imgareaselect-outer").remove()},a.setCrop=function(b,c){a.article.image.thumb_coords=JSON.stringify(c)},a.editImages=function(){t();var b=g({scope:a,template:"views/admin/modal/images.html",show:!1});b.$promise.then(b.show)},a.openImagesModal=function(b){u.clearQueue(),a.images=[],a.image={},a.uploadMultiple=b,b?u.queueLimit=20:(u.queueLimit=1,a.image.id=0),a.uploadImagesModal=g({scope:a,template:"views/admin/modal/uploadImages.html",show:!1}),a.uploadImagesModal.$promise.then(a.uploadImagesModal.show)},a.addImages=function(b){a.uploadMultiple?(null==a.article.images&&(a.article.images=[]),angular.forEach(a.images,function(b){i.addImage({image_id:b.id,article_id:a.article.id},function(){a.article.images.push(b)})}),a.images=[]):(a.article.image=a.image,a.article.image_id=a.image.id,a.image={}),a.uploadImagesModal.hide()},a.removeImage=function(b){i.removeImage({articleId:a.article.id,data:b.id},function(c){1==c.status&&a.article.images.splice(a.article.images.indexOf(b),1)})},a.saveImageData=function(b){b&&p.update({imageId:a.article.image.id},{title:a.article.image.title,thumb_coords:a.article.image.thumb_coords,source:a.article.image.source},function(b){1==b.status&&a.hideCropping()})};var u=a.uploader=new l({url:"http://www.openscience.or.at/assets/ajax/uploadImages.php",alias:"qqfile",queueLimit:20});u.formData=[{cat:"articles",id:"new"}],u.filters.push({name:"imageFilter",fn:function(a,b){var c="|"+a.type.slice(a.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(c)}}),u.onWhenAddingFileFailed=function(a,b,c){},u.onAfterAddingFile=function(b){u.formData[0].id=a.article.id,b.formData[0].id=a.article.id},u.onSuccessItem=function(b,c,d,e){a.uploadMultiple?a.images.push(c.image):a.image=c.image},a.editFiles=function(){t();var b=g({scope:a,template:"views/admin/modal/files.html",show:!1});b.$promise.then(b.show)},a.openFilesModal=function(){v.clearQueue(),a.files=[],a.uploadFilesModal=g({scope:a,template:"views/admin/modal/uploadFiles.html",show:!1}),a.uploadFilesModal.$promise.then(a.uploadFilesModal.show)},a.addFiles=function(b){null==a.article.files&&(a.article.files=[]),angular.forEach(a.files,function(b){i.addFile({file_id:b.id,article_id:a.article.id},function(){a.article.files.push(b)})}),a.files=[],a.uploadFilesModal.hide()},a.removeFile=function(b){i.removeFile({articleId:a.article.id,data:b.id},function(c){1==c.status&&a.article.files.splice(a.article.files.indexOf(b),1)})},a.updateFileName=function(a,b){m.update({fileId:a.id},{name:b},function(a){})};var v=a.uploaderFiles=new l({url:"http://www.openscience.or.at/assets/ajax/uploadFiles.php",alias:"qqfile"});v.formData=[{cat:"articles",id:"new"}],v.onAfterAddingFile=function(b){v.formData[0].id=a.article.id,b.formData[0].id=a.article.id},v.onSuccessItem=function(b,c,d,e){a.files.push(c.file)}}]),angular.module("osApp").factory("Article",["$resource",function(a){return a("http://www.openscience.or.at/api/article/:articleId/:type/:data",{},{query:{method:"GET",params:{articleId:""},isArray:!0},get:{method:"GET"},addFile:{method:"POST",params:{articleId:"file"}},removeFile:{method:"DELETE",params:{type:"file"}},addImage:{method:"POST",params:{articleId:"image"}},removeImage:{method:"DELETE",params:{type:"image"}},update:{method:"PUT",params:{articleId:""}},create:{method:"POST"},remove:{method:"DELETE",params:{articleId:""}},sort:{method:"PUT",params:{articleId:"position"}},partners:{method:"POST",params:{articleId:"",type:"partners"}},tags:{method:"POST",params:{articleId:"",type:"tags"}},overview:{method:"GET",params:{articleId:"overview"},isArray:!0},connections:{method:"GET",params:{type:"connectionsbyname",view:"full"},isArray:!0},addConnection:{method:"POST",params:{articleId:"",type:"connection",data:""}},removeConnection:{method:"DELETE",params:{type:"connection"}}})}]).factory("MainSort",["$resource",function(a){return a("http://www.openscience.or.at/api/:type/main_position",{},{sortArticles:{method:"PUT",params:{type:"articles"}},sortClasses:{method:"PUT",params:{type:"classes"}}})}]).factory("Ajax",["$resource",function(a){return a("http://www.openscience.or.at/assets/ajax/:action",{},{contentToEmail:{method:"GET",params:{action:"contentToEmail.php",id:""}}})}]),angular.module("osApp").factory("Classes",["$resource",function(a){return a("http://www.openscience.or.at/api/:kind/:classId/:action/:actionId",{},{query:{method:"GET",params:{kind:"classes",classId:""},isArray:!0},get:{method:"GET",params:{kind:"class"}},dates:{method:"GET",params:{kind:"class",action:"dates"},isArray:!0},files:{method:"GET",params:{kind:"class",action:"files"},isArray:!0},seminare:{method:"GET",params:{kind:"seminare"},isArray:!0},camps:{method:"GET",params:{kind:"summercamps"},isArray:!0},"class":{method:"GET",params:{kind:"class"}},dayfree:{medthod:"GET",params:{kind:"freeonday"},isArray:!0},labfree:{method:"GET",params:{kind:"freecal"},isArray:!0},update:{method:"PUT",params:{kind:"class",classId:""}},remove:{method:"DELETE",params:{kind:"class"}},create:{method:"POST",params:{kind:"class"}},addFile:{method:"POST",params:{kind:"class",action:"file"}},removeFile:{method:"DELETE",params:{kind:"class",action:"file"}},sections:{method:"GET",params:{kind:"classes",classId:"sections"},isArray:!0}})}]),angular.module("osApp").directive("articlethumb",["$timeout",function(a){return{restrict:"E",replace:!0,templateUrl:"views/directive/articles.html",link:function(a){a.colors={wissen:"523C7C",schulcorner:"858D1E",projekte:"1DA9C7",vol:"A31031"}}}}]).directive("classthumb",function(){return{restrict:"E",scope:{articles:"=",color:"="},replace:!0,templateUrl:"views/directive/classes.html"}}),angular.module("osApp").directive("article",function(){return{restrict:"E",replace:!0,templateUrl:"views/directive/article.html"}}),angular.module("osApp").controller("ArticleCtrl",["$scope","$stateParams",function(a,b){}]),angular.module("osApp").directive("connections",["$timeout","$document","$rootScope",function(a,b,c){return{restrict:"E",templateUrl:"views/directive/connections.html",replace:!0,scope:{articles:"=",article:"="},link:function(b){b.colors={wissen:"523C7C",schulcorner:"858D1E",projekte:"1DA9C7",vol:"A31031"},b.$watch("articles",function(a,c){a!==c&&b.reset()}),b.currentIndex=0;var d,e=function(){d=a(function(){b.next(),d=a(e,5e3)},5e3)};b.reset=function(){a.cancel(d),"undefined"!=typeof b.articles.$promise&&b.articles.$promise.then(function(){b.articles.forEach(function(a){a.visible=!1}),b.articles.length>0&&(b.articles[0].visible=!0,b.currentIndex=0,e(),b.setLiner())})},b.next=function(c){b.currentIndex<b.articles.length-1?b.currentIndex++:b.currentIndex=0,c&&(a.cancel(d),e())},b.prev=function(c){b.currentIndex>0?b.currentIndex--:b.currentIndex=b.articles.length-1,c&&(a.cancel(d),e())},b.setLiner=function(){},b.$watch("currentIndex",function(a){b.articles.length>0&&(b.articles.forEach(function(a){a.visible=!1}),b.articles[a].visible=!0,b.setLiner(),c.$broadcast("nextConnection",a))}),b.reset(),b.$on("$destroy",function(){a.cancel(d)}),c.$on("slyscroll",function(){})}}}]),angular.module("osApp").controller("UnsCtrl",["$scope",function(a){a.page=!0}]),angular.module("osApp").controller("UnsmainCtrl",["$scope","Article","Person",function(a,b,c){a.article=b.get({articleId:542}),a.persons=c.query({order:"position"})}]),angular.module("osApp").factory("Person",["$resource",function(a){return a("http://www.openscience.or.at/api/persons/:personId/:type",{},{query:{method:"GET",params:{personId:""},isArray:!0},get:{method:"GET"},sections:{method:"GET",params:{personId:"sections"},isArray:!0},update:{method:"PUT"},create:{method:"POST"},remove:{method:"DELETE"},sort:{method:"PUT",params:{personId:"sort"}}})}]),angular.module("osApp").filter("section",function(){return function(a,b){return a.filter(function(a){return angular.forEach(b,function(b){return a.section.id===b?!0:void 0}),!1})}}),angular.module("osApp").controller("UnswerCtrl",["$scope","$document","$timeout","$state","Person",function(a,b,c,d,e){a.persons=e.query({order:"position"},function(){c(function(){c(function(){var a=angular.element(document.getElementById(d.params.name));a.length&&b.scrollToElement(a,70)})})})}]),angular.module("osApp").directive("persons",function(){return{restrict:"E",replace:!0,templateUrl:"views/directive/persons.html"}}),angular.module("osApp").controller("UnswasCtrl",["$scope","Article","Marker",function(a,b,c){a.article=b.get({articleId:543}),a.markers=c.query()}]),angular.module("osApp").factory("Marker",["$resource",function(a){return a("http://www.openscience.or.at/api/markers/:markerId/:type",{},{query:{method:"GET",params:{markerId:""},isArray:!0},get:{method:"GET"}})}]),angular.module("osApp").factory("Partner",["$resource",function(a){return a("http://www.openscience.or.at/api/partners/:partnerId/:type",{},{query:{method:"GET",params:{partnerId:""},isArray:!0},get:{method:"GET"},update:{method:"PUT"},create:{method:"POST"},remove:{method:"DELETE"},sort:{method:"PUT",params:{partnerId:"sort"}}})}]),angular.module("osApp").controller("UnspartnerCtrl",["$scope","Partner",function(a,b){a.partners=b.query({order:"position",online:1})}]),angular.module("osApp").factory("Coop",["$resource",function(a){return a("http://www.openscience.or.at/api/coops/:coopId/:type",{},{query:{method:"GET",params:{coopId:""},isArray:!0},get:{method:"GET"},update:{method:"PUT"},create:{method:"POST"},remove:{method:"DELETE"},sort:{method:"PUT",params:{coopId:"sort"}}})}]),angular.module("osApp").controller("UnscoopsCtrl",["$scope","Coop",function(a,b){a.coops=b.query({order:"position",online:1})}]),angular.module("osApp").controller("UnscontactCtrl",["$scope","Article",function(a,b){a.article=b.get({articleId:583})}]),angular.module("osApp").controller("UnsimpressumCtrl",["$scope","Article",function(a,b){a.article=b.get({articleId:593})}]),angular.module("osApp").directive("redactor",["$timeout",function(a){return{restrict:"A",require:"ngModel",link:function(b,c,d,e){var f,g=function(a){b.$apply(function(){e.$setViewValue(a)})},h=function(){b.$apply(function(){e.$setViewValue(c.getCode())})},i=function(){b.$apply(function(){e.$setViewValue(c.getCode())})},j={changeCallback:g,keyupCallback:h,execCommandCallback:i},k=d.redactor?b.$eval(d.redactor):{},l=angular.element(c);angular.extend(j,k),a(function(){f=l.redactor(j),e.$render()}),e.$render=function(){angular.isDefined(f)&&a(function(){l.setCode(e.$viewValue)})}}}}]),angular.module("osApp").directive("contenteditable",function(){return{restrict:"A",require:"?ngModel",link:function(a,b,c,d){function e(){if(f){var a=b.text();d.$setViewValue(a)}}if(d){var f=!1;d.$render=function(){b.html(d.$viewValue||"")},b.on("blur keyup change",function(){f=!0,a.$apply(e)}),e()}}}}),angular.module("osApp").controller("VolmainCtrl",["$scope","Categorie","$modal","MainSort","FlashService",function(a,b,c,d,e){a.ready=!1,a.articles=b.volarticles({categorieName:"vol","new":"true",active:1,order:"main_position",limit:12},function(){a.ready=!0}),a.moreItems=function(){if(a.ready){a.ready=!1;var c=[],d=[];angular.forEach(a.articles,function(a){"article"==a.type?c.push(a.id):d.push(a.id)}),b.volarticles({categorieName:"vol",active:1,limit:12,order:"main_position",parent:0,not:c.join(),classnot:d.join()},function(b){a.ready=!0,angular.forEach(b,function(b){a.articles.push(b)})})}},a.openVolSorterModal=function(){a.catModal=c({scope:a,show:!1,template:"views/admin/modal/volsort.html"}),a.catModal.$promise.then(a.catModal.show)},a.sortController={orderChanged:function(b){var c=999,f=[],g=[];angular.forEach(a.articles,function(a){var b={id:a.id,position:c};"article"==a.type?f.push(b):"kurs"==a.type&&g.push(b),c--}),d.sortArticles({},{list:f},function(a){1==a.status?e.show(a.message,"","success"):e.show("Speichern Fehlgeschlagen","","danger",5)}),d.sortClasses({},{list:g},function(a){1==a.status?e.show(a.message,"","success"):e.show("Speichern Fehlgeschlagen","","danger",5)})}}}]),angular.module("osApp").controller("VolCtrl",["$scope","$modal","Categorie","FlashService","Quiz",function(a,b,c,d,e){a.color="A31031",a.categorie=c.categorie({categorieName:"vol"},function(){a.categorie=a.categorie[0]}),a.quiz=e.byCategorie({typeId:"vol"}),a.editCategorie={},a.doSorting=!1,a.showOffline=!1,a.setCatContext=function(b){console.log(b),a.editCategorie=b},a.editCat=function(){a.catModal=b({scope:a,show:!1,template:"views/admin/modal/categorie.html"}),a.catModal.$promise.then(a.catModal.show)},a.newCat=function(){a.editCategorie={},console.log(a.categorie),a.catModal=b({scope:a,show:!1,template:"views/admin/modal/categorie.html"}),a.catModal.$promise.then(a.catModal.show)},a.editCat=function(){a.catModal=b({scope:a,show:!1,template:"views/admin/modal/categorie.html"}),a.catModal.$promise.then(a.catModal.show)},a.toggleActivation=function(b){a.editCategorie.active=b,a.saveCat(!0)},a.saveCat=function(b){b&&(a.editCategorie.id?c.update({categorieName:a.editCategorie.id},{title:a.editCategorie.title,active:a.editCategorie.active,title_en:a.editCategorie.title_en},function(b){1==b.status?("undefined"!=typeof a.catModal&&a.catModal.hide(),d.show(b.message,"","success")):d.show("Speichern Fehlgeschlagen","","danger",5)}):c.create({},{title:a.editCategorie.title,active:a.editCategorie.active,parent_id:a.categorie.id,title_en:a.editCategorie.title_en},function(b){1==b.status?(a.categorie.categories.push(b.categorie),"undefined"!=typeof a.catModal&&a.catModal.hide(),d.show(b.message,"","success")):d.show("Speichern Fehlgeschlagen","","danger",5)}))},a.deleteCat=function(){a.articles=c.get({categorieName:a.categorie.name,type:a.editCategorie.name,action:"articles",order:"position"},function(b){a.articles.length>0?alert("Diese Kategorie beinhaltet "+a.articles.length+" Beitrage!\nLöschen nicht möglich!"):confirm("Die Kategorie\n"+a.editCategorie.title+"\nentgültig entfernen?")&&c.remove({categorieName:a.editCategorie.id},function(b){1==b.status?(a.categorie.categories.splice(a.categorie.categories.indexOf(a.editCategorie),1),d.show(b.message,"","success")):d.show("Löschen Fehlgeschlagen","","danger",5)})})},a.toggleSorting=function(){a.doSorting=0==a.doSorting?!0:!1},a.sortCategories={orderChanged:function(b){var e=[];angular.forEach(a.categorie.categories,function(a){e.push(a.id)}),c.sort({list:e},function(b){0==b.status?d.show("Fehlgeschlagen","","danger"):(a.article.edit=!1,d.show(b.message,"","success"))})}},a.toggleOffline=function(b){a.showOffline=b}}]),angular.module("osApp").controller("VolcategorieCtrl",["$scope","$state","$document","$location","Categorie","$stateParams",function(a,b,c,d,e,f){a.article={},a.activeCategorie=f.categorie,a.articles=e.get({categorieName:"vol",type:f.categorie,action:"articles",order:"position"}),a.setContext=function(b){a.article.edit||(a.article=b)},a.editArticle=function(){a.article.edit=!0;var b=angular.element(document.getElementById(a.article.name));c.scrollToElement(b,70,200)},a.saveArticle=function(){a.article.edit=!0,console.log(a.article)},a.abortArticle=function(){a.article.edit=!1},a.deleteArticle=function(){a.articles.splice(a.articles.indexOf(a.article),1),a.article={}},a.switchNew=function(){1===a.article.isNew?a.article.isNew=0:a.article.isNew=1}}]),angular.module("osApp").controller("VolkurseCtrl",["$scope","$rootScope","$document","$timeout","$state","Classes",function(a,b,c,d,e,f){a.register=!0,a.kurse=f.query({active:1,order:"position",kurse:1},function(){b.isLoading=!0,"undefined"!=typeof e.params.kurs?d(function(){d(function(){var a=angular.element(document.getElementById(e.params.kurs));c.scrollToElement(a,215),b.isLoading=!1})}):b.isLoading=!1}),a.$watch("selectedDate",function(a){})}]),angular.module("osApp").controller("VolkalenderCtrl",["$scope","$state","Events","Classes","$modal",function(a,b,c,d,e){a.events=[],a.courses=[],a.user={selectedCourse:"",selectedPlaces:""},a.specialDates=[],b.params.lab&&b.params.date?(a.selectedLab=b.params.lab,a.selectedDate=moment(b.params.date,"DD-MM-YYYY").toDate()):(a.selectedDate=new Date,a.selectedLab=1),a.kurse=[],a.$watch("selectedDate",function(f){"undefined"!=typeof f&&(a.kurse=[],a.eventList=c.query({kind:"day",start:f.getTime()/1e3,end:f.getTime()/1e3+86400,text:1,free:1,labor:a.selectedLab},function(b){var c=moment(f);a.gap=0;var e=120;if(c.set("hour",9).set("minute",30),angular.forEach(b,function(b){if(b.date=new Date(1e3*b.start),6!=c.weekday()&&7!=c.weekday()&&c.isAfter(moment())){var f=moment(b.date),g=f.diff(c,"minutes");g>=e&&(c.hour()>9&&c.add(30,"minutes"),a.gap=Math.max(a.gap,f.subtract(30,"minutes").diff(c,"minutes")),a.gap>=e&&a.eventList.push({date_start:c,type:"register",start:c.unix(),fullDay:!1}))}c=moment(new Date(1e3*b.end)),"undefined"!=typeof b["class"]&&a.kurse.push(d["class"]({classId:b["class"].id}))}),5!=c.weekday()&&6!=c.weekday()&&c.isAfter(moment())){var g=moment(f).set("hour",18);if(g.diff(c,"minutes")>=e){c.hour()>9&&c.add(30,"minutes");var h={date_start:c,type:"register",start:c.unix()};a.gap=Math.max(a.gap,g.diff(c,"minutes")),0==a.eventList.length&&(h.fullDay=!0,h.title="Labor ganztags frei"),a.eventList.push(h)}}}),a.preBooking=function(b){a.ev=b,0==a.courses.length&&(a.courses=d.query({active:1,order:"title",kurse:1})),a.prebookModal=e({scope:a,template:"views/modal/prebooking.html",show:!1}),a.prebookModal.$promise.then(a.prebookModal.show)},a.prebook=function(){a.prebookModal.hide(),b.go("vol.gruppenbuchung.kurs.date.places",{kurs:a.user.selectedCourse.name,date:moment(a.ev.date_start).unix(),places:a.user.selectedPlaces})})})}]),angular.module("osApp").controller("VoleinzelanmeldungCtrl",["$scope","$timeout","$document","$location","$state","Classes","Events","Email","Article",function(a,b,c,d,e,f,g,h,i){a.dates=[],a.files=[],a.direct=!0,a.formLoading=!1,a.bookingSuccess=!1,a.bookingError=!1,a.selectedPlaces="",a.selectedDate="",a.customer={firstname:"",lastname:"",email:""},a.loading={dates:!1},a.classes=f.query({type:"solo",active:1},function(b){e.params.kurs&&angular.forEach(b,function(b){e.params.kurs===b.title&&(a.selectedClass=b,a.direct=!1)})}),a.limitBooks=function(a){return a>5?5:a},a.$watch("selectedClass",function(g,h){g!==h&&"undefined"!=typeof g&&(a.dates=[],a.files=[],a.selectedPlaces="",a.selectedDate="",a.loading.dates=!0,a.dates=f.dates({classId:g.id},function(b){a.loading.dates=!1,e.params.date&&angular.forEach(b,function(b){b.date_start===e.params.date&&(a.selectedDate=b,a.direct=!1)})}),a.files=f.files({classId:g.id}),a.direct&&d.path("/vol/einzelanmeldung/"+a.selectedClass.title),b(function(){var a=angular.element(document.getElementById("choose_date"));a.length&&c.scrollToElement(a,0,100)}))}),a.$watch("selectedDate",function(e,f){e!==f&&e&&(a.direct&&"undefined"!=typeof a.selectedDate.date_start&&d.path("/vol/einzelanmeldung/"+a.selectedClass.title+"/"+a.selectedDate.date_start),b(function(){var b=angular.element(document.getElementById("choose_places"));c.scrollToElement(b,0,100),a.direct=!0}))}),a.$watch("selectedPlaces",function(a,d){a!==d&&0!==a&&b(function(){var a=angular.element(document.getElementById("fill_form"));c.scrollToElement(a,0,100)})}),a.fillTestData=function(){a.customer.firstname="Test",a.customer.lastname="Test",a.customer.email="test@test.com"},a.sendAnmeldung=function(d){if(d){var e={event_id:a.selectedDate.event_id,places:a.selectedPlaces,customer:a.customer};console.log(e)}d&&(b(function(){var a=angular.element(document.getElementById("response_message"));c.scrollToElement(a,0,100)}),a.formLoading=!0,a.bookingSuccess=!1,a.bookingError=!1,g.createTicket({event_id:a.selectedDate.event_id,labor_id:1,firstname:a.customer.firstname,lastname:a.customer.lastname,street:a.customer.street,zip:a.customer.zip,city:a.customer.city,email:a.customer.email,phone:a.customer.phone,text:a.customer.text,places:a.selectedPlaces,solo:1,groups:0,confirmed:"0"},function(d){1==d.status?h.regmail({id:d.id},{},function(d){a.bookingSuccess=!0,a.formLoading=!1,b(function(){var a=angular.element(document.getElementById("response_message"));c.scrollToElement(a,0,100)})}):(a.bookingError=!0,a.contact=i.get({articleId:584}),b(function(){var a=angular.element(document.getElementById("response_message"));c.scrollToElement(a,0,100)}))}))}}]),angular.module("osApp").controller("VolgruppenbuchungCtrl",["$scope","$state","$document","$timeout","Classes","Events","Article","Email",function(a,b,c,d,e,f,g,h){a.site=!0,a.formLoading=!1,a.bookingSuccess=!1,a.bookingError=!1,a.dates=[],a.files=[],a.direct=!0,a.selectedPlaces="",a.selectedDate="",a.selectedClass="",a.hours={selectedHours:"",selectedSecondHours:""},a.loading={dates:!1},a.customer={firstname:"",lastname:"",company:"",email:""},a.classes=e.query({type:"groups",active:1},function(c){b.params.kurs&&angular.forEach(c,function(c){b.params.kurs===c.name&&(a.selectedClass=c,a.direct=!1)}),b.params.places&&d(function(){a.selectedPlaces=parseInt(b.params.places)})}),a.$watch("selectedClass",function(b){a.selectedPlaces="",a.selectedDate="",a.deleteDate(0),a.deleteDate(1),d(function(){var a=angular.element(document.getElementById("choose_places"));c.scrollToElement(a,0,100)})}),a.$watch("selectedPlaces",function(b){0!=b&&""!=b&&(a.deleteDate(0),a.deleteDate(1),d(function(){d(function(){var a=angular.element(document.getElementById("choose_date"));c.scrollToElement(a,0,100)})}))}),a.$watch("selectedSecond",function(a){"undefined"!=typeof a&&d(function(){var a=angular.element(document.getElementById("fill_form"));c.scrollToElement(a,0,100)})}),a.deleteDate=function(b){0==b?(a.selectedDate=[],a.hours.selectedHours="",delete a.selectedFirstDate):1==b&&(a.selectedSecond=[],a.hours.selectedSecondHours="",delete a.selectedSecondDate)},a.fillTestData=function(){a.customer.firstname="Test",a.customer.lastname="Test",a.customer.company="Test-Institut",a.customer.email="test@test.com"},a.showCalendar=function(){return a.selectedClass.id&&a.selectedPlaces&&(!a.selectedFirstDate||!a.selectedSecondDate)},a.sendAnmeldung=function(b){if(b){d(function(){var a=angular.element(document.getElementById("response_message"));c.scrollToElement(a,0,100)}),a.formLoading=!0,a.bookingSuccess=!1,a.bookingError=!1;var e={company:a.customer.company,class_id:a.selectedClass.id,labor_id:a.hours.selectedHours.lab,firstname:a.customer.firstname,lastname:a.customer.lastname,street:a.customer.street,zip:a.customer.zip,city:a.customer.city,email:a.customer.email,phone:a.customer.phone,fax:a.customer.fax,text:a.customer.text,places:a.selectedPlaces,groups:1,date_first:moment(a.selectedFirstDate,"DD.MM.YYYY").format("YYYY-MM-DD")+" "+a.hours.selectedHours.time,date_second:moment(a.selectedSecondDate,"DD.MM.YYYY").format("YYYY-MM-DD")+" "+a.hours.selectedSecondHours.time,confirmed:"0"};f.createTicket(e,function(b){1==b.status?h.regmail({id:b.id},{group:1},function(b){a.formLoading=!1,a.bookingSuccess=!0,d(function(){var a=angular.element(document.getElementById("response_message"));c.scrollToElement(a,0,100)})}):(a.bookingError=!0,a.contact=g.get({articleId:584}),d(function(){var a=angular.element(document.getElementById("response_message"));c.scrollToElement(a,0,100)}))})}}}]),angular.module("osApp").controller("VolseminareCtrl",["$scope","$state","$timeout","$document","$rootScope","Classes","Article",function(a,b,c,d,e,f,g){a.kurse=f.seminare({active:1,order:"position"},function(){e.isLoading=!0,"undefined"!=typeof b.params.seminar?c(function(){c(function(){var a=angular.element(document.getElementById(b.params.seminar));d.scrollToElement(a,70),e.isLoading=!1},200)}):e.isLoading=!1}),a.article=g.get({articleId:594})}]),angular.module("osApp").controller("VolcampsCtrl",["$scope","$state","$timeout","$document","$rootScope","Article","Classes",function(a,b,c,d,e,f,g){a.article=f.get({articleId:595},function(){e.isLoading=!0,"undefined"!=typeof b.params.camp?c(function(){c(function(){var a=angular.element(document.getElementById(b.params.camp));d.scrollToElement(a,70),e.isLoading=!1},200)}):e.isLoading=!1}),a.kurse=g.camps({active:1,order:"position"})}]),angular.module("osApp").controller("VolfaqCtrl",["$scope","Faq",function(a,b){a.faqs=b.query({section:"vol",online:1}),a["switch"]=function(a){a.show?a.show=!1:a.show=!0}}]),angular.module("osApp").controller("VolguestbookCtrl",["$scope","Guestbook",function(a,b){a.gb={},a.sent=!1,a.entries=b.query({active:1}),a.newEntry=function(c){a.message="",c&&b.add(a.gb,function(b){1==b.status?(a.sent=!0,a.message="Vielen lieben Dank. Der Eintrag wurde erfolgreich gespeichert!"):a.message="Ups, da ist was schiefgelaufen!<br>Bitte versuchen Sie es nochmal"})}}]),angular.module("osApp").controller("VolgalleryCtrl",["$scope","$state","Gallery",function(a,b,c){a.dates=c.dates(),a.selectedAlbum=[],a.ready=!1,a.dateFilter="",a.page=1,a.selectedDate={set:""},a.galleries=[],a.getActive=function(b){angular.forEach(a.galleries,function(c){c.id===b&&(a.selectedAlbum=c)})},"undefined"!=typeof b.params.id?(a.selectedAlbum=!0,c.get({id:"all",action:b.params.id},function(c){a.galleries.push(c),a.ready=!0,a.getActive(b.params.id)})):a.galleries=c.query({id:"all"},function(){a.ready=!0,a.page++}),a.$on("$stateChangeSuccess",function(b,c,d,e,f){"undefined"!=typeof d.id?a.getActive(d.id):delete a.selectedAlbum}),a.fetchAlbums=function(){var b="";""!=a.selectedDate.set&&(b=a.selectedDate.set.substring(0,7)+"-01"),c.query({limit:12,page:a.page,id:"all",date:b},function(c){angular.forEach(c,function(b){var c=!1;angular.forEach(a.galleries,function(a){a.id==b.id&&(c=!0)}),c||a.galleries.push(b)}),""==b&&a.page++,a.ready=!0})},a.moreItems=function(){a.ready&&""==a.selectedDate.set&&(a.ready=!1,a.fetchAlbums())},a.$watchCollection("selectedDate.set",function(b,c){b!=c&&a.fetchAlbums()})}]),angular.module("osApp").controller("VolelabCtrl",["$scope","Elab",function(a,b){a.elabs=b.sections({online:1})}]).controller("VolelabsectionCtrl",["$scope","$stateParams","Elab",function(a,b,c){a.elab=c.section({id:b.id}),a.elabs=c.elabs({type:b.id,id:"elabs",online:1})}]).controller("VolelabdetailsCtrl",["$scope","$stateParams","Elab",function(a,b,c){a.elab=c.get({id:b.name})}]),angular.module("osApp").filter("range",function(){return function(a,b,c){b=parseInt(b),c=parseInt(c);for(var d=b;c>=d;d++)a.push(d);return a}}).filter("labcount",function(){return function(a,b,c,d){if(c&&"undefined"!=typeof c){"undefined"==typeof d&&(d=!1);var e=20;1!=c.labor_2||2!=d&&0!=d||(e=30);for(var f=b;e>=f;f++)a.push(f);return a}}}).filter("coursedur",function(){return function(a,b,c,d){var e=[];return d="undefined"!=typeof d?"labor_"+d:!1,angular.forEach(a,function(a){a.duration<=b/60&&1==a[c]&&(d?1==a[d]&&e.push(a):e.push(a))}),e}}).filter("hours",function(){return function(a,b,c){if("undefined"!=typeof b&&0!=b.length){var d=30,e=[];return angular.forEach(b,function(a){var b=1e3*a.from_time,f=1e3*a.to_time,g=moment(1e3*a.from_time);do e.push({hour:g.format("HH:mm"),lab:a.lab}),b+=60*d*1e3,g=moment(b);while(b<=f-36e5*c.duration)}),e}}}),angular.module("osApp").directive("kurse",["Classes",function(a){return{restrict:"E",replace:!0,templateUrl:"views/directive/kurse.html",link:function(a,b,c){a.locate=c.locate,a.offset=c.offset,a.section=c.section}}}]),angular.module("osApp").factory("Faq",["$resource",function(a){return a("http://www.openscience.or.at/api/faqs/:faqId/:type",{},{query:{method:"GET",params:{faqId:""},isArray:!0},get:{method:"GET"},update:{method:"PUT"},create:{method:"POST"},remove:{method:"DELETE"},sort:{method:"PUT",params:{faqId:"position"}}})}]),angular.module("osApp").factory("Guestbook",["$resource",function(a){return a("http://www.openscience.or.at/api/guestbook/:id/:type",{},{query:{method:"GET",params:{id:""},isArray:!0},get:{method:"GET"},update:{method:"PUT"},remove:{method:"DELETE"},add:{method:"POST"}})}]),angular.module("osApp").filter("badDateToIso",function(){return function(a){var b=a.replace(/(.+) (.+)/,"$1T$2Z");return b}}).filter("timestampToISO",function(){return function(a){return a=new Date(a).toISOString()}}),angular.module("osApp").directive("datepicker",["$location","Events",function(a,b){return{restrict:"A",require:"ngModel",link:function(c,d,e,f){var g=[],h=d.glDatePicker({prevArrow:'<span class="os-icon prev-icon"></span>',nextArrow:'<span class="os-icon next-icon" style="margin-left:-5px"></span>',showAlways:!0,cssName:"flatwhite",dowNames:["S","M","D","M","D","F","S"],dowOffset:1,monthNames:["J&auml;nner","Februar","M&auml;rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],onClick:function(b,d,g){var h=new Date(g);a.path("/vol/kalender/"+e.lab+"/"+moment(g).format("DD-MM-YYYY")),c.$apply(function(){f.$setViewValue(g),c.selectedDate=h,c.urlDate=moment(h).format("DD-MM-YYYY"),c.selectedLab=e.lab,c.selected=!0})},selectedDate:c.selectedDate}).glDatePicker(!0);b.query({kind:"calendarstyle",labor:e.lab,date:moment(c.selectedDate).format("YYYY-MM-DD")},function(a){g=[],angular.forEach(a,function(a){a.date=new Date(1e3*a.time),g.push(a)}),h.options.specialDates=g,h.render(function(){})}),f.$render=function(){d.val(f.$modelValue),d.change()}}}}]),angular.module("osApp").factory("Events",["$resource",function(a){return a("http://www.openscience.or.at/api/:kind/:eventId/:action/:actionKind",{},{query:{method:"GET",params:{eventId:""},isArray:!0},get:{method:"GET"},list:{params:{kind:"plus",eventId:"events.php"},isArray:!0},check:{params:{kind:"dates"}},update:{method:"PUT",params:{kind:"events",eventId:""}},create:{method:"POST",params:{kind:"events"}},createTicket:{method:"POST",params:{kind:"ticket"}},updateTicket:{method:"PUT",params:{kind:"ticket"}},createClosed:{method:"POST",params:{kind:"closed"}},deleteGroupEvent:{method:"DELETE",params:{kind:"ticket"}},deleteTicket:{method:"DELETE",params:{kind:"ticket"}},deleteClosedEvent:{method:"DELETE",params:{kind:"closed"}},addImage:{method:"POST",params:{kind:"events",eventId:"",action:"images",actionKind:""}},removeImage:{method:"DELETE",params:{kind:"events",eventId:"",action:"images",actionKind:""}},sortimages:{method:"PUT",params:{kind:"events",eventId:"",action:"images",actionKind:"sort"}},bookings:{mehtod:"GET",params:{kind:"bookings",type:"all"},isArray:!0}})}]),angular.module("osApp").controller("VolunsCtrl",["$scope",function(a){a.site=!0}]),angular.module("osApp").controller("VolunskonzeptCtrl",["$scope","Article",function(a,b){a.article=b.get({articleId:596})}]),angular.module("osApp").controller("VolunsteamCtrl",["$scope","$state","$document","$timeout","Person",function(a,b,c,d,e){a.persons=e.query({order:"position",section:3},function(){d(function(){d(function(){var a=angular.element(document.getElementById(b.params.name));c.scrollToElement(a,70)})})})}]),angular.module("osApp").controller("VolunsoranisationCtrl",["$scope","Article",function(a,b){a.article=b.get({articleId:608})}]),angular.module("osApp").controller("VolunsfaktenCtrl",["$scope","Article",function(a,b){a.article=b.get({articleId:607})}]),angular.module("osApp").controller("VolunsmainCtrl",["$scope","Article","Person",function(a,b,c){a.article=b.get({articleId:596}),a.persons=c.query({order:"position",section:3})}]),angular.module("osApp").controller("VolkontaktCtrl",["$scope","Article",function(a,b){a.article=b.get({articleId:584})}]),angular.module("osApp").directive("stick",["$document","$window","$timeout","$rootScope",function(a,b,c,d){return{restrict:"A",link:function(e,f){var g=angular.element(document.getElementById("header")),h=angular.element(document.getElementById("navigation")),i=angular.element(document.getElementById("content_container")),j=f.find(".scrollbar"),k=f.find(".items"),l=f.find(".functions_menu"),m=f.find("#cat_articles"),n=!1,o=f.parent().parent().find(".article"),p=new Sly(k,{
speed:100,smart:1,activateOn:"click",activatePageOn:"click",scrollBar:f.find(".scrollbar"),scrollBy:100,dragHandle:1,mouseDragging:0,touchDragging:1,dynamicHandle:1,clickBar:1,releaseSwing:!0,prev:angular.element(document.getElementById("articlesToPreview")),keyboardNavBy:"items"});p.on("load",function(){n=!0}),p.on("move",function(){d.$broadcast("slyscroll")}),e.checkPosition=function(){n&&c(function(){var a=f.find(".active"),b=f.find(".scroll_menu");c(function(){a.position().top>b.innerHeight()/2?p.toEnd():p.toStart()},300)})},e.checkDim=function(){var c=parseInt(a.scrollTop()),d=0;l.length&&(d=l.innerHeight()),b.innerWidth>960?c>g.innerHeight()-h.innerHeight()+i.innerHeight()-20+o.innerHeight()?(f.addClass("headroom--not-top").css({transform:"translateY(-"+(g.innerHeight()-h.innerHeight()+i.innerHeight()-20+o.innerHeight())+"px)","-webkit-transform":"translateY(-"+(g.innerHeight()-h.innerHeight()+i.innerHeight()-20+o.innerHeight())+"px)"}),m.innerHeight()+d+50>b.innerHeight-h.innerHeight()+20?(k.css({height:b.innerHeight-h.innerHeight()-30-d+"px"}),j.css({height:b.innerHeight-h.innerHeight()-30-d+"px"}),n?p.reload():p.init(),j.show()):(n=!1,j.hide(),p.initialized&&"undefined"!=typeof p.frame&&p.destroy())):f.removeClass("headroom--not-top").css({transform:"translateY(0px)","-webkit-transform":"translateY(0px)"}):k.css({height:b.innerHeight-h.innerHeight()-41+"px"})},a.on("scroll",function(){e.checkDim()}),j.hide(),c(function(){e.checkDim()}),angular.element(b).bind("resize",function(){e.checkDim()})}}}]),angular.module("osApp").directive("stickhead",["$document",function(a){return{restrict:"A",link:function(b,c){var d=angular.element(document.getElementById("navigation")),e=angular.element(document.getElementById("body"));a.on("scroll",function(){var b=parseInt(a.scrollTop());b>c.innerHeight()-d.innerHeight()?(e.addClass("fixed"),$("#wrapper").css({"padding-top":c.innerHeight()}).trigger("click"),c.css({transform:"translateY(-"+(c.innerHeight()-d.innerHeight())+"px)","-webkit-transform":"translateY(-"+(c.innerHeight()-d.innerHeight())+"px)"}).addClass("headroom--not-top")):(e.removeClass("fixed"),c.removeClass("headroom--not-top").css({transform:"translateY(0px)","-webkit-transform":"translateY(0px)"}),$("#wrapper").css({"padding-top":0}))})}}}]),angular.module("osApp").directive("imageloaded",["$timeout",function(a){return{restrict:"A",link:function(a,b){b.bind("load",function(){var a=b.parent();b.css({"margin-top":(b.innerHeight()-250)/2*-1}),a.hoverIntent({over:function(){a.hasClass("editing")||(a.css({height:b.innerHeight()}),b.css({"margin-top":0}))},out:function(){a.hasClass("editing")||(b.css({"margin-top":(b.innerHeight()-250)/2*-1}),a.css({height:250}))},timeout:350})})}}}]),angular.module("osApp").controller("TagCtrl",["$scope","$state","Tag",function(a,b,c){a.tag=c.query({name:b.params.name},function(b){a.articles=b.articles})}]),angular.module("osApp").factory("Tag",["$resource",function(a){return a("http://www.openscience.or.at/api/tag/:name",{},{query:{method:"GET",params:{name:""}}})}]).factory("Tags",["$resource",function(a){return a("http://www.openscience.or.at/api/tags/:tagId",{},{query:{method:"GET",params:{tagId:""},isArray:!0},update:{method:"PUT"},remove:{method:"DELETE"},create:{method:"POST"}})}]),angular.module("osApp").factory("Search",["$resource",function(a){return a("http://www.openscience.or.at/api/:type/:action",{},{query:{method:"GET",params:{type:"fullsearching",action:""},isArray:!0},search:{method:"GET",params:{type:"search",query:""}}})}]),angular.module("osApp").directive("updateTitle",["$rootScope","$timeout",function(a,b){function c(a){return a.charAt(0).toUpperCase()+a.slice(1).toLowerCase()}return{link:function(d,e){var f=function(a,d,f,g,h){var i="OpenScience";d.data&&d.data.pageTitle&&(i=d.data.pageTitle),f.section&&(i=c(f.section),f.categorie&&(i=c(f.categorie)+" // "+c(f.section),f.article&&(i=c(f.article.replace(new RegExp("-","g")," "))+" // "+c(f.categorie)+" // "+c(f.section)))),b(function(){e.text(i)})};a.$on("$stateChangeStart",f)}}}]).directive("scrolltop",function(){return{link:function(a,b){b.on("click",function(){$("html,body").animate({scrollTop:0})})}}}).directive("scrollprev",function(){return{link:function(a,b){b.on("click",function(){var b=0;angular.forEach(a.articles,function(c){if(c.name==a.activeArticle){var d=a.articles.indexOf(c);d>0&&(b=$("#"+a.articles[d-1].name).offset().top-70)}}),$("html,body").animate({scrollTop:b})})}}}).directive("btnSwitch",function(){return{restrict:"EAC",template:'<span class="boolean" ng-click="toggle()"><span class="btn on btn-success" ng-show="model == 1" style="width: 40px;text-align: center"><i class="fa fa-check"></i></span><span class="btn off btn-danger" ng-hide="model == 1" style="width: 40px;text-align: center"><i class="fa fa-times"></i></span></span>',replace:!0,scope:{model:"=?ngModel"},link:function(a){a.toggle=function(){1==a.model?a.model=0:a.model=1}}}}).directive("btnSwitchArray",function(){return{restrict:"EAC",template:'<span class="boolean" ng-click="toggle()"><span class="btn on btn-success" ng-show="found()" style="width: 40px;text-align: center"><i class="fa fa-check"></i></span><span class="btn off btn-danger" ng-hide="found()" style="width: 40px;text-align: center"><i class="fa fa-times"></i></span></span>',replace:!0,scope:{model:"=?ngModel",value:"=?ngValue"},link:function(a){a.found=function(){return"undefined"!=typeof a.model&&a.model&&a.model.indexOf(a.value)>-1?!0:!1},a.toggle=function(){var b=!1,c=0;angular.forEach(a.model,function(d,e){d==a.value&&(b=!0,c=e)}),b?a.model.splice(c,1):a.model.push(a.value)}}}}),angular.module("osApp").directive("favicon",function(){return{template:"<div></div>",restrict:"E",link:function(a,b,c){b.text("this is the favicon directive")}}}),angular.module("osApp").factory("File",["$resource",function(a){return a("http://www.openscience.or.at/ajax/:action",{},{zip:{method:"GET",params:{action:"downloadZip.php"}},file:{method:"GET",params:{action:"downloadFile.php"}}})}]).factory("FileEdit",["$resource",function(a){return a("http://www.openscience.or.at/api/file/:fileId",{},{update:{method:"PUT",params:{fileId:""}}})}]).factory("ImageEdit",["$resource",function(a){return a("http://www.openscience.or.at/api/image/:imageId",{},{update:{method:"PUT",params:{imageId:""}}})}]),angular.module("osApp").filter("bysection",["$timeout",function(a){return function(a,b,c){if("undefined"==typeof b)return a;var d=[];return angular.forEach(a,function(a,c){"undefined"!=typeof a.sections?-1!==a.sections.indexOf(b)&&d.push(a):d.push(a)}),d}}]).filter("toint",function(){return function(a){return parseInt(a)}}).filter("insection",function(){return function(a,b,c){var d="";return angular.forEach(b,function(b,c){a.id==b.id&&(d="selected")}),d}}).filter("inlist",function(){return function(a,b,c){var d="";return angular.forEach(b,function(b,c){a.id==b&&(d="selected")}),d}}).filter("byid",function(){return function(a,b,c){var d=[];return angular.forEach(a,function(a,c){angular.forEach(b,function(b,c){a.id==b&&d.push(a)})}),d}}).filter("section",function(){return function(a,b,c){if("undefined"==typeof b||""==b)return a;var d=[];return angular.forEach(a,function(a,c){"undefined"!=typeof a.section?a.section.name==b&&d.push(a):d.push(a)}),d}}).filter("orderbycat",["orderByFilter",function(a){return function(b,c,d){return b.length>0&&"projekte-a-z"==b[0].categorie.name&&(b=a(b,"+name")),b}}]).filter("bydater",["$timeout",function(a){return function(a,b,c){if(0==a.length||!b)return a;if("undefined"==typeof b)return a;var d=[];return angular.forEach(a,function(a,c){-1!==a.date.indexOf(b.substring(0,7))&&d.push(a)}),d}}]),angular.module("osApp").directive("loader",function(){return{restrict:"E",templateUrl:"views/directive/loader.html",replace:!0,scope:{content:"=",section:"="}}}),angular.module("osApp").directive("translationtext",["$translate",function(a){return{restrict:"A",require:"ngModel",replace:!0,template:'<div ng-bind-html="text"></div>',link:function(a,b,c,d){a.text=d.text,console.log(d)}}}]).directive("translationTitle",function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){}}}),angular.module("osApp").factory("Gallery",["$resource",function(a){return a("http://www.openscience.or.at/api/galleries/:id/:action",{},{query:{method:"GET",params:{id:""},isArray:!0},dates:{method:"GET",params:{id:"dates"},isArray:!0},get:{method:"GET"}})}]),angular.module("osApp").directive("mfp",function(){return{restrict:"A",link:function(a,b,c){b.magnificPopup({type:"image",delegate:"a",gallery:{enabled:!0,tPrev:"Zurück (Link Pfeiltaste)",tNext:"Weiter (Rechte Pfeiltaste)",tCounter:'<span class="mfp-counter">%curr% von %total%</span>'},mainClass:"mfp-with-zoom",zoom:{enabled:!0,duration:300,easing:"ease-in-out"}})}}}),angular.module("osApp").directive("totext",function(){return{template:"<div></div>",restrict:"E",link:function(a,b,c){b.text("this is the totext directive")}}}),angular.module("osApp").factory("Elab",["$resource",function(a){return a("http://www.openscience.or.at/api/elab/:type/:id/:action",{},{sections:{method:"GET",params:{type:"sections"},isArray:!0},section:{method:"GET",params:{type:"sections"}},sectionLabs:{method:"GET",params:{id:"elabs"},isArray:!0},elabs:{method:"GET",isArray:!0},get:{method:"GET",params:{type:"name"}},create:{method:"POST",params:{type:"sections"}},update:{method:"PUT",params:{type:"sections"}},remove:{method:"DELETE",params:{type:"sections"}},sort:{method:"PUT",params:{type:"sections",action:"sort"}},updateElabentry:{method:"PUT"},addElabentry:{method:"POST"},removeElabentry:{method:"DELETE"},sortEntries:{method:"PUT",params:{type:"sections",action:"sort"}}})}]),angular.module("osApp").directive("elab",function(){return{restrict:"E",replace:!0,scope:{elab:"="},link:function(a,b,c){c.$observe("src",function(a){a?b.html('<object width="100%" type="application/pdf" data="'+a+'"><param value="http://www.openscience.or.at'+a+'" name="movie"><param name="quality" value="high" /><param name="bgcolor" value="#ffffff" /><param value="transparent" name="wmode"><param value="noscale" name="scale"><embed src="http://www.openscience.or.at'+a+'" quality="high" bgcolor="#ffffff" width="720" height="570"  align="middle" allowScriptAccess="always" pluginspage="http://www.macromedia.com/go/getflashplayer" /></object>'):b.html("<div></div>")})}}}),angular.module("osApp").directive("thesaurus",["$timeout",function(a){return{restrict:"A",link:function(b,c,d){a(function(){c.Thesaurus({caseSensitive:!1,effect:"fade"})})}}}]),angular.module("osApp").controller("SearchCtrl",["$scope","$state","Search",function(a,b,c){a.query=b.params.name,a.search=c.query({action:b.params.name},function(b){a.articles=b})}]),angular.module("osApp").directive("captcha",function(){return{require:"ngModel",link:function(a,b,c,d){function e(c){return Number(b.val())==a.numCapOne+a.numCapTwo?d.$setValidity("captcha",!0):d.$setValidity("captcha",!1),c}d.$parsers.unshift(e),a.numCapOne=Math.floor(10*Math.random())+1,a.numCapTwo=Math.floor(10*Math.random())+1}}}),Array.prototype.sortOn=function(a){this.sort(function(b,c){return b[a]<c[a]?-1:b[a]>c[a]?1:0})},angular.module("osApp").directive("datepickersolo",["Classes",function(a){return{restrict:"A",require:"ngModel",link:function(b,c,d,e){var f=c.glDatePicker({prevArrow:'<span class="os-icon prev-icon"></span>',nextArrow:'<span class="os-icon next-icon" style="margin-left:-5px"></span>',showAlways:!0,cssName:"flatwhite",dowNames:["S","M","D","M","D","F","S"],dowOffset:1,monthNames:["J&auml;nner","Februar","M&auml;rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],selectableDates:[],specialDates:[],onClick:function(a,c,d,e){var f=[];angular.forEach(e.hours,function(a){var c=moment(1e3*a.from_time),d=moment(1e3*a.to_time).subtract(b.selectedClass.duration,"hours").add(30,"minutes");do{var e={time:c.format("HH:mm"),lab:a.labor,full:c.valueOf()},g=!1;angular.forEach(f,function(a){a.full==e.full&&(g=!0,a.lab=1)}),g||f.push(e),c.add(30,"minutes")}while(c.isBefore(d))}),f.sortOn("full"),e.free=f,b.$apply(function(){"undefined"==typeof b.selectedFirstDate?(b.selectedDate=e,b.selectedFirstDate=moment(d).format("DD.MM.YYYY")):(b.selectedSecond=e,b.selectedSecondDate=moment(d).format("DD.MM.YYYY"))})}}).glDatePicker(!0);b.$watch("selectedPlaces",function(c){return 0==c?(f.options.selectableDates=[],void f.render()):(b.fetching=!0,void(b.fetchdates=a.labfree({class_id:b.selectedClass.id,places:b.selectedPlaces},function(a){f.options.selectableDates=[],f.options.specialDates=[],angular.forEach(a,function(a){var b={date:new Date(1e3*a.time),data:a,cssClass:a.cssClass};f.options.selectableDates.push(b),f.options.specialDates.push(b)}),b.fetching=!1,f.render()})))})}}}]),angular.module("osApp").filter("unsafe",["$sce",function(a){return function(b){return a.trustAsHtml(b)}}]),angular.module("osApp").directive("question",function(){return{template:'<div><input type="text" ng-model="question" /></div>',restrict:"A",replace:!1,link:function(a,b,c){}}}),angular.module("osApp").directive("ngThumb",["$window",function(a){var b={support:!(!a.FileReader||!a.CanvasRenderingContext2D),isFile:function(b){return angular.isObject(b)&&b instanceof a.File},isImage:function(a){var b="|"+a.type.slice(a.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(b)}};return{restrict:"A",template:"<canvas/>",link:function(a,c,d){function e(a){var b=new Image;b.onload=f,b.src=a.target.result}function f(){var a=g.width||this.width/this.height*g.height,b=g.height||this.height/this.width*g.width;h.attr({width:a,height:b}),h[0].getContext("2d").drawImage(this,0,0,a,b)}if(b.support){var g=a.$eval(d.ngThumb);if(b.isFile(g.file)&&b.isImage(g.file)){var h=c.find("canvas"),i=new FileReader;i.onload=e,i.readAsDataURL(g.file)}}}}}]),angular.module("osApp").directive("imagearea",["$timeout",function(a){return{restrict:"A",link:function(b,c,d){a(function(){b.coords={x1:0,y1:0,x2:460,y2:250},b.article.image.thumb_coords&&(b.coords=JSON.parse(b.article.image.thumb_coords));var a=angular.element(c).imgAreaSelect({minWidth:460,minHeight:250,maxHeight:250,handles:!0,resizable:!1,x1:b.coords.x1,y1:b.coords.xy,x2:b.coords.x2,y2:b.coords.y2,onSelectEnd:b.setCrop,instance:!0});b.$watch("coords",function(c){a.setSelection(b.coords.x1,b.coords.y1,b.coords.x2,b.coords.y2),a.update()},!0)})}}}]),angular.module("osApp").directive("startup",function(){return{restrict:"A",link:function(a,b,c){b.removeClass("waiting-for-angular")}}}),angular.module("osApp").controller("LoginCtrl",["$rootScope","$location","$scope","$state","$modal","AuthService","FlashService",function(a,b,c,d,e,f,g){c.doLogin=function(b){b&&f.login(c.user).success(function(b){c.loading=!1,1==b.success?(g.show("",b.message,"success"),console.log(a.lastState.state.name),a.lastState.state.name?d.go(a.lastState.state.name,a.lastState.params):d.go("home")):g.show("",b.message,"danger")}).error(function(a){g.show("",a.message,"danger")})},c.back=function(){a.lastState.state.name?d.go(a.lastState.state.name,a.lastState.params):d.go("home")}}]),angular.module("osApp").config(["$httpProvider",function(a){a.interceptors.push(["$injector",function(a){return a.get("AuthInterceptor")}])}]).factory("SessionService",function(){return{get:function(a){return sessionStorage.getItem(a)},set:function(a,b){return sessionStorage.setItem(a,b)},unset:function(a){return sessionStorage.removeItem(a)}}}).factory("FlashService",["$alert","$rootScope",function(a,b){return{show:function(c,d,e,f){var g=3;"undefined"!=typeof f?g=f:"danger"==e&&(g=6);a({title:c,content:d,type:e,placement:"bottom-right",show:!0,duration:g});b.flash=d},clear:function(){b.flash=""}}}]).factory("AuthInterceptor",["$rootScope","$q","AUTH_EVENTS","SessionService",function(a,b,c,d){var e=0;return{request:function(b){return e++,a.isLoading=!0,a.$broadcast("loader_show"),b},response:function(c){return 0===--e&&(a.$broadcast("loader_hide"),a.isLoading=!1),c||b.when(c)},responseError:function(d){return--e||a.$broadcast("loader_hide"),401===d.status&&a.$broadcast(c.notAuthenticated,d),403===d.status&&a.$broadcast(c.notAuthorized,d),(419===d.status||440===d.status)&&a.$broadcast(c.sessionTimeout,d),500===d.status&&a.$broadcast("no_connection",d),b.reject(d)}}}]).factory("AuthService",["$http","$rootScope","$location","$sanitize","SessionService","SETTINGS","FlashService","AuthInterceptor",function(a,b,c,d,e,f,g,h){var i=function(a){1==a.role&&(a.role="admin"),e.set("authenticated",!0),e.set("role",a.role)},j=function(){e.unset("authenticated"),e.unset("role")},k=function(a){g.show(a.flash,a.message,"danger")},l=function(a){return{username:d(a.username),password:d(a.password),remember:a.remember}};return{login:function(b){var c=a.post(f.apiUri+"/login",l(b));return c.success(i),c.success(g.clear),c.error(k),c},autoLogin:function(){if(!this.isLoggedIn()){var b=a.get(f.apiUri+"/remember/me");return b.success(i),b.success(g.clear),b.success(c.path("/")),b.error(k),b}return!1},logout:function(){var b=a.get(f.apiUri+"/logout");return b.success(j),b},isLoggedIn:function(){return e.get("authenticated")},isAuthorized:function(a){return angular.isArray(a)||(a=[a]),this.isLoggedIn()&&-1!==a.indexOf(e.get("role"))},getUserRole:function(){return e.get("role")},isLoading:function(){return b.isLoading}}}]),angular.module("osApp").directive("login",["$rootScope","$state",function(a,b){return function(c,d,e){d.bind("contextmenu",function(d){c.$apply(function(){a.isLoggedIn||(d.preventDefault(),b.go("login"))})})}}]),angular.module("osApp").controller("AdminCtrl",["$scope","$state","$rootScope","AuthService","FlashService","$modal","$alert",function(a,b,c,d,e,f,g){a.showMenu=!0,a.logout=function(){d.logout().success(function(){c.isLoggedIn=!1,-1!=b.current.url.indexOf("/admin")&&b.go("home")})},a.toggleMenu=function(){a.showMenu=!a.showMenu},a.toggleAdminMenu=function(){c.showAdminFullSize=!c.showAdminFullSize},a.toggleBigMenu=function(){};var h=[];c.$on("modal.show",function(a,b){-1===h.indexOf(b)&&h.push(b)}),c.$on("modal.hide",function(a,b){var c=h.indexOf(b);h.splice(c,1)}),c.$on("$stateChangeStart",function(){h.length&&(angular.forEach(h,function(a){a.$promise.then(a.hide)}),h=[])})}]),angular.module("osApp").controller("CalendarCtrl",["$scope","$state","$timeout","$modal","$cookies","Classes","Events","FlashService",function(a,b,c,d,e,f,g,h){var i=new Date;e.calendarDate&&""!=e.calendarDate&&"undefined"!=typeof e.calendarDate&&"Invalid Date"!=e.calendarDate&&(i=new Date(e.calendarDate)),a.activeLab=e.activeLab||1,a.classes=f.query(),a.selectedClass={},a.event={},a.dateError=!0,a.fetched=!1,a.totalPlaces=new Array(20),a.totalPlaces30=new Array(30),a.labor1_data=[{url:"http://www.openscience.or.at/api/events"},{url:"http://www.openscience.or.at/api/groupevents"},{url:"http://www.openscience.or.at/api/groupevents?type=query"},{url:"http://www.openscience.or.at/api/closed"}],a.labor2_data=[{url:"http://www.openscience.or.at/api/events?labor=2"},{url:"http://www.openscience.or.at/api/groupevents?labor=2"},{url:"http://www.openscience.or.at/api/groupevents?type=query&labor=2"},{url:"http://www.openscience.or.at/api/closed?labor=2"}],a.eventSource=a.labor1_data,a.eventModal=d({scope:a,template:"views/admin/modal/event.html",show:!1}),a.$watch("event.class_id",function(b,c){b!=c&&0!=a.classes.length&&(angular.forEach(a.classes,function(b){a.event.class_id==b.id&&(a.selectedClass=b)}),a.event.start&&(a.event.end=moment(a.event.start).add(a.selectedClass.duration,"hours")))}),a.$watch("event.start",function(b,c){b!=c&&a.event.start&&a.event.class_id&&(a.event.end=moment(a.event.start).add(a.selectedClass.duration,"hours"))}),a.showEventModal=function(){a.eventModal.$promise.then(a.eventModal.show)},a.alertOnEventClick=function(b,c,d){a.dateError=!1,a.edit=!1,a.event=b,"group"==a.event.type&&"0"==a.event.confirmed&&(a.edit=!0),a.showEventModal()},a.newEventDialog=function(b){"undefined"==typeof b&&(b=Date()),a.edit=!0,a.event={},a.event.start=b,a.dateError=!1,a.event.labor_id=a.activeLab,a.newEventModal=d({show:!1,scope:a,template:"views/admin/modal/newEvent.html"}),a.newEventModal.$promise.then(a.newEventModal.show)},a.$watchCollection("event",function(b,c){if(b!=c&&b.id==c.id&&a.edit&&(b.type!=c.type||b.start!=c.start||b.end!=c.end||b.labor_id!=c.labor_id||b.date_confirmed!=c.date_confirmed)&&(a.event.class_id&&angular.forEach(a.classes,function(b){b.id==a.event.class_id&&(a["class"]=b)}),a.event.type&&a.event.class_id&&a.event.start||"closed"==a.event.type&&a.event.start)){var d=moment(a.event.start).subtract(5,"minutes").valueOf()/1e3;if("closed"!=a.event.type)if("group"==a.event.type&&"0"==a.event.confirmed){if("0000-00-00 00:00:00"==a.event.date_confirmed)return;var d=moment(a.event.date_confirmed).subtract(5,"minutes").valueOf()/1e3,e=moment(a.event.date_confirmed).add(a.event["class"].duration,"hours").add(5,"minutes").valueOf()/1e3}else var e=moment(a.event.start).add(a["class"].duration,"hours").add(5,"minutes").valueOf()/1e3;else var e=moment(a.event.end).add(5,"minutes").valueOf()/1e3;g.check({start:d,end:e,labor_id:b.labor_id},function(b){a.fetched=!0,b.match>0?a.dateError=!0:a.dateError=!1})}}),a.gotoEvent=function(a){b.go("event",{id:a.id,type:a.type})},a.createEvent=function(b){if(b)if(a.event.date_start=moment(a.event.start).format("YYYY-MM-DD HH:mm:ss"),a.event.date_end=moment(a.event.end).format("YYYY-MM-DD HH:mm:ss"),"solo"==a.event.type)g.create(a.event,function(b){1==b.status&&(h.show(b.message,"","success"),a.volCalendar.fullCalendar("refetchEvents"),a.newEventModal.hide())});else if("group"==a.event.type){var c={company:a.event.company,class_id:a.event.class_id,labor_id:a.event.labor_id,firstname:a.event.firstname,lastname:a.event.lastname,street:a.event.street,zip:a.event.zip,city:a.event.city,email:a.event.email,phone:a.event.phone,fax:a.event.fax,text:a.event.text,places:a.event.booked,groups:1,date_first:a.event.date_start,date_confirmed:a.event.date_start,confirmed:"1"};console.log(c),g.createTicket(c,function(b){1==b.status&&(h.show(b.message,"","success"),a.volCalendar.fullCalendar("refetchEvents"),a.newEventModal.hide())})}else if("closed"==a.event.type){var d=0;a.event.full_day?(d=24,a.event.date_start=moment(a.event.date_start).startOf("day").format("YYYY-MM-DD HH:mm:ss")):d=moment(a.event.date_end).diff(moment(a.event.date_start),"hours",!0),g.createClosed({date:a.event.date_start,full_day:a.event.full_day,title:a.event.title,text:a.event.text,duration:d,labor_id:a.event.labor_id},function(b){1==b.status&&(h.show(b.message,"","success"),a.volCalendar.fullCalendar("refetchEvents"),a.newEventModal.hide())})}},a.uiConfig={calendar:{axisFormat:"H:mm",firstHour:8,minTime:8,maxTime:22,weekends:!0,weekNumbers:!0,timeFormat:{agenda:"H:mm{ - H:mm}","":"H:mm"},columnFormat:{month:"ddd",week:"ddd d.M",day:"dddd d.M"},titleFormat:{month:"MMMM yyyy",week:"d[ yyyy] { '-' d [ MMM] MMMM yyyy}",day:"dddd, d MMMM , yyyy"},monthNames:["J&auml;nner","Februar","M&auml;rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],monthNamesShort:["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],dayNames:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],dayNamesShort:["So","Mo","Di","Mi","Do","Fr","Sa"],allDayText:"Ganztags",header:{left:"today prev,next month,agendaWeek,agendaDay",center:"title",right:"labor1,labor2"},buttonText:{today:"Heute",month:"Monat",week:"Woche",day:"Tag",labor1:"Labor 1",labor2:"Labor 2"},customButtons:{labor1:function(b){a.setEventSource(1)},labor2:function(b){a.setEventSource(2)}},firstDay:1,editable:!1,eventClick:a.alertOnEventClick,dayClick:function(b,c){a.volCalendar.fullCalendar("gotoDate",b);var d=a.volCalendar.fullCalendar("getView").name;"agendaWeek"==d?a.volCalendar.fullCalendar("changeView","agendaDay"):"month"==d?a.volCalendar.fullCalendar("changeView","agendaWeek"):"agendaDay"==d&&a.newEventDialog(b)},viewRender:function(b,c){e.calendarView=b.name,e.calendarDate=b.start,e.activeLab=a.activeLab},defaultView:e.calendarView||"month",year:i.getFullYear(),month:i.getMonth(),date:i.getDate()}},a.setEventSource=function(b){angular.forEach(a.eventSource,function(b){a.volCalendar.fullCalendar("removeEventSource",b)}),1==b?(a.eventSource=a.labor1_data,a.activeLab=1):(a.eventSource=a.labor2_data,a.activeLab=2),e.activeLab=a.activeLab,angular.forEach(a.eventSource,function(b){a.volCalendar.fullCalendar("addEventSource",b)}),a.$$phase||a.$apply()},"new"==b.params.action&&a.newEventDialog(Date()),a.confirmDate=function(b){g.update({eventId:b.id,type:"group"},{date_confirmed:b.date_confirmed,confirmed:"1",labor_id:b.labor_id},function(b){(b.status=!0)&&(a.edit=!1,h.show(b.message,"","success"),a.volCalendar.fullCalendar("refetchEvents"))})},a.deleteEvent=function(b){if(confirm("Termin: "+moment(b.start).format("DD.MM.YYYY HH:mm")+"\nim Labor "+b.labor_id+"\nentgültig entfernen?"))if("solo"==b.type){if(b.booked&&!confirm("Es sind bereits Plätze verbucht.\nTermin trotzdem löschen?"))return!1;g.update({eventId:b.id,type:b.type},{is_deleted:1},function(c){1==c.status&&(h.show("Termin erfolgreich entfernt","","success"),a.volCalendar.fullCalendar("removeEvents",b.id),a.eventModal.hide())})}else"group"==b.type?g.deleteGroupEvent({eventId:b.id},function(c){1==c.status&&(h.show(c.message,"","success"),a.volCalendar.fullCalendar("removeEvents",b.id),a.eventModal.hide())}):"closed"==b.type&&g.deleteClosedEvent({eventId:b.id},function(c){1==c.status&&(h.show(c.message,"","success"),a.volCalendar.fullCalendar("removeEvents",b.id),a.eventModal.hide())})}}]),angular.module("osApp").controller("EventCtrl",["$scope","$state","$modal","FlashService","Events","Classes","FileUploader",function(a,b,c,d,e,f,g){function h(b){"undefined"==typeof b?1==a.event.groups?(a.event.start=a.event.date_confirmed,a.event.end=moment(a.event.date_confirmed,"YYYY-MM-DD HH:mm:ss").add(a.event["class"].duration,"hours")):1==a.event.solo?(a.event.start=a.event.date_start,a.event.end=moment(a.event.date_start,"YYYY-MM-DD HH:mm:ss").add(a.event["class"].duration,"hours"),a.places=0,angular.forEach(a.event.tickets.query,function(b){a.places+=parseInt(b.places)})):"closed"==a.event.type&&("1"==a.event.full_day?(a.event.start=moment(a.event.date,"YYYY-MM-DD HH:mm:ss").startOf("day").format("YYYY-MM-DD HH:mm:ss"),a.event.end=moment(a.event.date,"YYYY-MM-DD HH:mm:ss").endOf("day").format("YYYY-MM-DD HH:mm:ss")):(a.event.start=a.event.date,a.event.end=moment(a.event.date,"YYYY-MM-DD HH:mm:ss").add(a.event.duration,"hours"))):1==a.event.groups?(a.event.date_confirmed=b,a.event.end=moment(a.event.date_confirmed,"YYYY-MM-DD HH:mm:ss").add(a.event["class"].duration,"hours")):1==a.event.solo?(a.event.date_start=b,a.event.end=moment(a.event.date_start,"YYYY-MM-DD HH:mm:ss").add(a.event["class"].duration,"hours")):"closed"==a.event.type&&(a.event.full_day?(a.event.date=b,a.event.end=moment(a.event.date,"YYYY-MM-DD HH:mm:ss").endOf("day")):(a.event.date=b,a.event.end=moment(a.event.date,"YYYY-MM-DD HH:mm:ss").add(a.event.duration,"hours")))}a.places=0,a.ticket={},a.images=[],a.image={},a.classes=f.query(),a.edit={event:!1,contact:!1},a.event=e.get({kind:"event",eventId:b.params.id,type:b.params.type},function(c){a.event.type=b.params.type,"closed"==b.params.type&&(a.event.full_day=parseInt(a.event.full_day)),h()}),a.toggleEventEdit=function(){a.edit.event?a.edit.event=!1:a.edit.event=!0},a.toggleContactEdit=function(){a.edit.contact?a.edit.contact=!1:a.edit.contact=!0},a.$watchCollection("event",function(c,d){if(c!=d&&"undefined"!=typeof d&&"undefined"!=typeof d.id){if(c.start!=d.start||c.labor_id!=d.labor_id){if(h(c.start),"closed"==c.type)if(c.full_day)var f=moment(c.start,"YYYY-MM-DD HH:mm:ss").startOf("day").valueOf()/1e3,g=moment(c.start,"YYYY-MM-DD HH:mm:ss").endOf("day").valueOf()/1e3;else var f=moment(c.start,"YYYY-MM-DD HH:mm:ss").subtract(5,"minutes").valueOf()/1e3,g=moment(c.start,"YYYY-MM-DD HH:mm:ss").add(a.event.duration,"hours").add(5,"minutes").valueOf()/1e3;else var f=moment(c.start,"YYYY-MM-DD HH:mm:ss").subtract(5,"minutes").valueOf()/1e3,g=moment(c.start,"YYYY-MM-DD HH:mm:ss").add(a.event["class"].duration,"hours").add(5,"minutes").valueOf()/1e3;e.check({start:f,end:g,labor_id:c.labor_id,event_id:c.id,type:b.params.type},function(b){b.match>0?a.dateError=!0:a.dateError=!1})}if(c.class_id!=d.class_id&&(angular.forEach(a.classes,function(b){b.id==a.event.class_id&&(a.event["class"]=b)}),h()),c.labor_id!=d.labor_id){var i=20;2==c.labor_id?i=30:1==c.labor_id&&(i=20),c.labor.places=i,h()}}}),a.$watchCollection("ticket",function(b,c){b.places!=c.places&&(b.places>a.event.labor.places-a.places&&(b.places=a.event.labor.places-a.places,d.show("Nicht genügend Plätze vorhanden","Es sind maximal "+(a.event.labor.places-a.places)+" Plätze verfügbar","danger")),b.places<1&&(b.places=1))}),a.calcPlaces=function(){1==a.event.solo&&(a.places=0,angular.forEach(a.event.tickets.query,function(b){a.places+=parseInt(b.places)}))},a.inFuture=function(){var b=moment(),c=moment();return 1==a.event.groups?b=moment(a.event.date_confirmed,"YYYY-MM-DD HH:mm:ss"):1==a.event.solo?b=moment(a.event.date_start,"YYYY-MM-DD HH:mm:ss"):"closed"==a.event.type&&(b=moment(a.event.date,"YYYY-MM-DD HH:mm:ss")),b.isBefore(c)?!1:!0},a.showTicket=function(b){a.ticket=b,console.log(b),a.ticket.places=parseInt(a.ticket.places),a.ticketModal=c({scope:a,template:"views/admin/modal/ticket.html",show:!1}),a.ticketModal.$promise.then(function(){a.ticketModal.show()})},a.addTicket=function(){a.ticket={},a.ticket.places=1,a.ticketModal=c({scope:a,template:"views/admin/modal/ticket.html",show:!1}),a.ticketModal.$promise.then(function(){a.ticketModal.show()})},a.saveTicket=function(b){b&&(a.ticket.id?(a.ticket.event_id=a.event.id,a.ticket.labor_id=a.event.labor_id,a.ticket.solo=1,e.updateTicket({eventId:a.ticket.id},a.ticket,function(b){1==b.status&&(a.ticketModal.hide(),a.calcPlaces(),d.show("Buchung erfolgreich gespeichert","","success"))})):(a.ticket.event_id=a.event.id,a.ticket.labor_id=a.event.labor_id,a.ticket.solo=1,e.createTicket(a.ticket,function(b){1==b.status&&(a.ticket.id=b.event.id,a.event.tickets.query.push(b.event),a.ticketModal.hide(),a.calcPlaces(),d.show("Buchung erfolgreich gespeichert","","success"))})))},a.deleteTicket=function(b){confirm("#"+b.id+"\nTeilnehmer: "+b.lastname+" "+b.firstname+"\nentgültig entfernen?")&&e.deleteTicket({eventId:b.id},function(c){1==c.status&&(a.ticketModal.hide(),a.event.tickets.query.splice(a.event.tickets.query.indexOf(b),1),d.show("Teilnehmer erfolgreich entfernt!","","success"),a.calcPlaces())})},a.saveEvent=function(){"closed"==a.event.type&&(a.event.full_day?(a.event.duration=24,a.event.start=moment(a.event.start).startOf("day"),a.event.end=moment(a.event.start).endOf("day")):a.event.duration=moment(a.event.end).diff(moment(a.event.start),"hours",!0)),e.update({eventId:a.event.id,type:b.params.type},a.event,function(b){1==b.status&&(d.show(b.message,"","success"),a.edit.event=!1,a.edit.contact=!1)})},a.sortController={orderChanged:function(c){var f=[];angular.forEach(a.event.images,function(a){f.push(a.id)}),console.log(f),e.sortimages({eventId:a.event.id},{list:f,type:b.params.type},function(a){0==a.status?d.show("Fehlgeschlagen","","danger"):d.show(a.message,"","success")})}},a.openImagesModal=function(b){i.clearQueue(),a.images=[],a.image={},a.uploadMultiple=b,b?i.queueLimit=20:(i.queueLimit=1,a.image.id=0),a.uploadImagesModal=c({scope:a,template:"views/admin/modal/uploadImages.html",show:!1}),a.uploadImagesModal.$promise.then(a.uploadImagesModal.show)},a.addImages=function(c){a.uploadMultiple?(null==a.event.images&&(a.event.images=[]),angular.forEach(a.images,function(c){e.addImage({eventId:a.event.id},{type:b.params.type,imageId:c.id},function(b){1==b.status?(a.event.images.push(c),d.show(b.message,"","success")):d.show("Fehler beim hinzufügen des Bildes!","","danger");
})}),a.images=[]):(a.event.image=a.image,a.event.image_id=a.image.id,a.image={}),a.uploadImagesModal.hide()},a.removeImage=function(c){e.removeImage({eventId:a.event.id,actionKind:c.id,type:b.params.type},function(b){1==b.status&&a.event.images.splice(a.event.images.indexOf(c),1)})};var i=a.uploader=new g({url:"http://www.openscience.or.at/assets/ajax/uploadImages.php",alias:"qqfile",queueLimit:20});i.formData=[{cat:"events",id:"new"}],i.filters.push({name:"imageFilter",fn:function(a,b){var c="|"+a.type.slice(a.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(c)}}),i.onWhenAddingFileFailed=function(a,b,c){},i.onAfterAddingFile=function(b){i.formData[0].id=a.event.id,b.formData[0].id=a.event.id},i.onSuccessItem=function(b,c,d,e){a.uploadMultiple?a.images.push(c.image):a.image=c.image}}]),angular.module("osApp").directive("edit",function(){return{templateUrl:"views/directive/edit.html",restrict:"E",replace:!0,link:function(a,b,c){a.noDelete=!1,"true"==c.nodelete&&(a.noDelete=!0)}}}),angular.module("osApp").directive("articleoptions",function(){return{template:"views/directive/articleoptions.html",restrict:"E",replace:!0}}),angular.module("osApp").directive("editfull",function(){return{templateUrl:"views/directive/editfull.html",restrict:"E",replace:!0}}),angular.module("osApp").factory("Glossar",["$resource",function(a){return a("http://www.openscience.or.at/api/glossar/:glossarId/:type",{},{query:{method:"GET",params:{glossarId:""},isArray:!0},get:{method:"GET",params:{glossarId:""}},create:{method:"POST"},update:{method:"PUT"},remove:{method:"DELETE"}})}]),angular.module("osApp").filter("linkify",function(){return function(a){var b=/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim,c=a.replace(b,'<a href="$1" target="_blank">$1</a>'),d=/(^|[^\/])(www\.[\S]+(\b|$))/gim,c=c.replace(d,'$1<a href="http://$2" target="_blank">$2</a>'),e=/(\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,6})/gim,c=c.replace(e,'<a href="mailto:$1">$1</a>');return c}}),angular.module("osApp").factory("Shorturls",["$resource",function(a){return a("http://www.openscience.or.at/api/shorturls/:id/:action",{},{query:{method:"GET",isArray:!0},update:{method:"PUT",params:{id:""}},create:{method:"POST"},remove:{method:"DELETE"}})}]),angular.module("osApp").controller("ShorturlsCtrl",["$scope","$modal","FlashService","Shorturls",function(a,b,c,d){a.url={},a.predicate="title",a.shorturls=d.query(),a.urlModal=b({scope:a,template:"views/admin/modal/shorturl.html",show:!1}),a.qrModal=b({scope:a,template:"views/admin/modal/qrcode.html",show:!1}),a.showModal=function(){a.urlModal.$promise.then(a.urlModal.show)},a.showQrCode=function(){a.qrModal.$promise.then(a.qrModal.show)},a.hideModal=function(){a.urlModal.hide()},a.editUrl=function(b){a.edit=!0,a.keyword=b.keyword,a.url=b,a.showModal()},a.newUrl=function(){a.edit=!1,a.url={},a.showModal()},a.getQrCode=function(b){a.url=b,a.showQrCode()},a.deleteUrl=function(b){confirm("ShortURL: "+b.title+"\nentgültig entfernen?")&&d.remove({id:b.keyword},{},function(d){1==d.status?(a.shorturls.splice(a.shorturls.indexOf(b),1),c.show("ShortUrl erfolgreich entfernt!","","success")):c.show("Löschen fehlgeschlagen","","danger")})},a.saveUrl=function(b){if(b)if(a.edit)d.update({id:a.keyword},a.url,function(b){1==b.success?(c.show("ShortUrl erfolgreich gespeichert!","","success"),a.hideModal()):c.show("Speichern fehlgeschlagen","","danger")});else{var e=yourls.connect("http://www.openscience.or.at/shorturls/yourls-api.php",{username:"short",password:"12ShortItDown"});e.shorten(a.url.url,a.url.keyword,a.url.title,function(b){b.url?(c.show("ShortUrl erfolgreich gespeichert!","","success"),a.hideModal(),b.url.clicks=0,a.shorturls.push(b.url)):c.show("Speichern fehlgeschlagen","","danger")})}}}]),angular.module("osApp").controller("ClassesCtrl",["$scope","FlashService","Classes",function(a,b,c){a.classes=c.query(),a.predicate="title",a.activation=function(a){a.active=1==a.active?0:1,c.update({classId:a.id},{active:parseInt(a.active)},function(a){1==a.status?b.show(a.message,"","success"):b.show("Speichern fehlgeschlagen","","danger")})},a.deleteClass=function(d){confirm("Kurs:\n"+d.title+"\nentgültig entfernen?")&&c.remove({classId:d.id},function(c){1==c.status?(a.classes.splice(a.classes.indexOf(d),1),b.show(c.message,"","success")):b.show("Löschen fehlgeschlagen","","danger")})}}]),angular.module("osApp").controller("ClassCtrl",["$scope","$state","$stateParams","$modal","$alert","FlashService","FileEdit","Classes","FileUploader",function(a,b,c,d,e,f,g,h,i){a.course={},"new"!=c.id&&(a.course=h.get({classId:c.id},function(a){a.id||b.go("classes")})),a.sections=h.sections(),a.image={},a.files=[],a.uploadMultiple=!1,a.saveClass=function(c){console.log(c),c&&(a.course.id?h.update({classId:a.course.id},a.course,function(a){1==a.status?f.show(a.message,"","success"):f.show("Speicher fehlgeschlagen!","","danger")}):h.create(a.course,function(a){1==a.status?(f.show(a.message,"","success"),b.go("class",{id:a["class"].id})):f.show("Speicher fehlgeschlagen!","","danger")}))};var j=a.uploader=new i({url:"http://www.openscience.or.at/assets/ajax/uploadImages.php",alias:"qqfile",queueLimit:20});j.formData=[{cat:"class",id:"new"}],j.filters.push({name:"imageFilter",fn:function(a,b){var c="|"+a.type.slice(a.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(c)}}),j.onWhenAddingFileFailed=function(a,b,c){},j.onAfterAddingFile=function(b){j.formData[0].id=a.course.id,b.formData[0].id=a.course.id},j.onSuccessItem=function(b,c,d,e){a.uploadMultiple?a.images.push(c.image):a.image=c.image},a.openImagesModal=function(b){j.clearQueue(),a.images=[],a.image={},a.uploadMultiple=b,b?j.queueLimit=20:(j.queueLimit=1,a.image.id=0),a.uploadImagesModal=d({scope:a,template:"views/admin/modal/uploadImages.html",show:!1}),a.uploadImagesModal.$promise.then(a.uploadImagesModal.show)},a.deleteImage=function(){delete a.course.image,a.course.image_id=0},a.openFilesModal=function(){k.clearQueue(),a.files=[],a.uploadFilesModal=d({scope:a,template:"views/admin/modal/uploadFiles.html",show:!1}),a.uploadFilesModal.$promise.then(a.uploadFilesModal.show)},a.addFiles=function(b){null==a.course.files&&(a.course.files=[]),angular.forEach(a.files,function(b){h.addFile({file_id:b.id,class_id:a.course.id},function(){a.course.files.push(b)})}),a.files=[],a.uploadFilesModal.hide()},a.removeFile=function(b){h.removeFile({classId:a.course.id,actionId:b.id},function(c){1==c.status&&a.course.files.splice(a.course.files.indexOf(b),1)})},a.updateFileName=function(a,b){g.update({fileId:a.id},{name:b},function(a){})};var k=a.uploaderFiles=new i({url:"http://www.openscience.or.at/assets/ajax/uploadFiles.php",alias:"qqfile"});k.formData=[{cat:"class",id:"new"}],k.onAfterAddingFile=function(b){k.formData[0].id=a.course.id,b.formData[0].id=a.course.id},k.onSuccessItem=function(b,c,d,e){a.files.push(c.file)},a.addImages=function(b){a.course.image=a.image,a.course.image_id=a.image.id,a.image={},a.uploadImagesModal.hide()}}]),angular.module("osApp").controller("TeamCtrl",["$scope","Person","FlashService",function(a,b,c){a.members=b.query({order:"position"}),a.deleteMember=function(d){confirm("Person:\n"+d.firstname+" "+d.lastname+"\nentgültig entfernen?")&&b.remove({personId:d.id},function(b){1==b.status?(c.show(b.message,"","success"),a.members.splice(a.members.indexOf(d),1)):c.show("Löschen fehlgeschlagen!","","danger")})},a.sortController={additionalPlaceholderClass:"col-lg-2 col-md-4 col-sm-6 col-xs-12 no-pad",orderChanged:function(d){var e=[];angular.forEach(a.members,function(a){e.push(a.id)}),b.sort({list:e},function(a){0==a.status?c.show("Fehlgeschlagen","","danger"):c.show(a.message,"","success")})}}}]),angular.module("osApp").factory("team",function(){var a=42;return{someMethod:function(){return a}}}),angular.module("osApp").controller("MemberCtrl",["$scope","$state","$stateParams","Person","FileUploader","$modal","FlashService",function(a,b,c,d,e,f,g){a.member={},a.sections=d.sections(),"new"!=c.id&&(a.member=d.get({personId:c.id},function(c){a.member.sections?a.member.sections=JSON.parse(a.member.sections):a.member.sections=[],c.id||b.go("classes")})),a.image={},a.files=[],a.uploadMultiple=!1,a.saveMember=function(c){c&&(a.member.id?(0==a.member.sections.length&&(a.member.sections=""),d.update({personId:a.member.id},a.member,function(a){1==a.status?g.show(a.message,"","success"):g.show("Speicher fehlgeschlagen!","","danger")})):d.create(a.member,function(a){1==a.status?(g.show(a.message,"","success"),b.go("member",{id:a.person.id})):g.show("Speicher fehlgeschlagen!","","danger")}))};var h=a.uploader=new e({url:"http://www.openscience.or.at/assets/ajax/uploadImages.php",alias:"qqfile",queueLimit:20});h.formData=[{cat:"team",id:"new"}],h.filters.push({name:"imageFilter",fn:function(a,b){var c="|"+a.type.slice(a.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(c)}}),h.onWhenAddingFileFailed=function(a,b,c){},h.onAfterAddingFile=function(b){h.formData[0].id=a.member.id,b.formData[0].id=a.member.id},h.onSuccessItem=function(b,c,d,e){a.uploadMultiple?a.images.push(c.image):a.image=c.image},a.openImagesModal=function(b){h.clearQueue(),a.images=[],a.image={},a.uploadMultiple=b,b?h.queueLimit=20:(h.queueLimit=1,a.image.id=0),a.uploadImagesModal=f({scope:a,template:"views/admin/modal/uploadImages.html",show:!1}),a.uploadImagesModal.$promise.then(a.uploadImagesModal.show)},a.deleteImage=function(){delete a.member.image,a.member.image_id=0},a.addImages=function(b){a.member.image=a.image,a.member.image_id=a.image.id,a.image={},a.uploadImagesModal.hide()}}]),angular.module("osApp").controller("PartnersCtrl",["$scope","Partner","FlashService",function(a,b,c){a.partners=b.query({order:"position"}),a.deletePartner=function(d){confirm("Förderer:\n"+d.title+"\nentgültig entfernen?")&&b.remove({partnerId:d.id},function(b){1==b.status?(c.show(b.message,"","success"),a.partners.splice(a.partners.indexOf(d),1)):c.show("Löschen fehlgeschlagen!","","danger")})},a.sortController={additionalPlaceholderClass:"col-lg-2 col-md-4 col-sm-6 col-xs-12 no-pad",orderChanged:function(d){var e=[];angular.forEach(a.partners,function(a){e.push(a.id)}),b.sort({list:e},function(a){0==a.status?c.show("Fehlgeschlagen","","danger"):c.show(a.message,"","success")})}},a.setOnline=function(a,d){b.update({partnerId:a.id},{online:d},function(b){1==b.status?(c.show(b.message,"","success"),a.online=d):c.show("Speicher fehlgeschlagen!","","danger")})}}]),angular.module("osApp").controller("PartnerCtrl",["$scope","$state","Partner","$modal","FlashService","FileUploader",function(a,b,c,d,e,f){a.partner={},"new"!=b.params.id&&(a.partner=c.get({partnerId:b.params.id},function(a){a.id||b.go("partners")})),a.image={},a.files=[],a.uploadMultiple=!1,a.savePartner=function(d){d&&(a.partner.id?c.update({partnerId:a.partner.id},a.partner,function(a){1==a.status?e.show(a.message,"","success"):e.show("Speicher fehlgeschlagen!","","danger")}):c.create(a.partner,function(a){1==a.status?(e.show(a.message,"","success"),b.go("partner",{id:a.partner.id})):e.show("Speicher fehlgeschlagen!","","danger")}))};var g=a.uploader=new f({url:"http://www.openscience.or.at/assets/ajax/uploadImages.php",alias:"qqfile",queueLimit:20});g.formData=[{cat:"partner",id:"new"}],g.filters.push({name:"imageFilter",fn:function(a,b){var c="|"+a.type.slice(a.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(c)}}),g.onWhenAddingFileFailed=function(a,b,c){},g.onAfterAddingFile=function(b){g.formData[0].id=a.partner.id,b.formData[0].id=a.partner.id},g.onSuccessItem=function(b,c,d,e){a.uploadMultiple?a.images.push(c.image):a.image=c.image},a.openImagesModal=function(b){g.clearQueue(),a.images=[],a.image={},a.uploadMultiple=b,b?g.queueLimit=20:(g.queueLimit=1,a.image.id=0),a.uploadImagesModal=d({scope:a,template:"views/admin/modal/uploadImages.html",show:!1}),a.uploadImagesModal.$promise.then(a.uploadImagesModal.show)},a.deleteImage=function(){delete a.partner.image,a.partner.image_id=0},a.addImages=function(b){a.partner.image=a.image,a.partner.image_id=a.image.id,a.image={},a.uploadImagesModal.hide()}}]),angular.module("osApp").controller("CoopsCtrl",["$scope","Coop","FlashService",function(a,b,c){a.coops=b.query({order:"position"}),a.deleteCoop=function(d){confirm("Mitglied:\n"+d.title+"\nentgültig entfernen?")&&b.remove({coopId:d.id},function(b){1==b.status?(c.show(b.message,"","success"),a.coops.splice(a.coops.indexOf(d),1)):c.show("Löschen fehlgeschlagen!","","danger")})},a.sortController={additionalPlaceholderClass:"col-lg-2 col-md-4 col-sm-6 col-xs-12 no-pad",orderChanged:function(d){var e=[];angular.forEach(a.coops,function(a){e.push(a.id)}),b.sort({list:e},function(a){0==a.status?c.show("Fehlgeschlagen","","danger"):c.show(a.message,"","success")})}},a.setOnline=function(a,d){b.update({coopId:a.id},{online:d},function(b){1==b.status?(c.show(b.message,"","success"),a.online=d):c.show("Speicher fehlgeschlagen!","","danger")})}}]),angular.module("osApp").controller("CoopCtrl",["$scope","$state","Coop","$modal","FlashService","FileUploader",function(a,b,c,d,e,f){a.coop={},"new"!=b.params.id&&(a.coop=c.get({coopId:b.params.id},function(a){a.id||b.go("coops")})),a.image={},a.files=[],a.uploadMultiple=!1,a.saveCoop=function(d){d&&(a.coop.id?c.update({coopId:a.coop.id},a.coop,function(a){1==a.status?e.show(a.message,"","success"):e.show("Speicher fehlgeschlagen!","","danger")}):c.create(a.coop,function(a){1==a.status?(e.show(a.message,"","success"),b.go("coop",{id:a.partner.id})):e.show("Speicher fehlgeschlagen!","","danger")}))};var g=a.uploader=new f({url:"http://www.openscience.or.at/assets/ajax/uploadImages.php",alias:"qqfile",queueLimit:20});g.formData=[{cat:"mitglieder",id:"new"}],g.filters.push({name:"imageFilter",fn:function(a,b){var c="|"+a.type.slice(a.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(c)}}),g.onWhenAddingFileFailed=function(a,b,c){},g.onAfterAddingFile=function(b){g.formData[0].id=a.coop.id,b.formData[0].id=a.coop.id},g.onSuccessItem=function(b,c,d,e){a.uploadMultiple?a.images.push(c.image):a.image=c.image},a.openImagesModal=function(b){g.clearQueue(),a.images=[],a.image={},a.uploadMultiple=b,b?g.queueLimit=20:(g.queueLimit=1,a.image.id=0),a.uploadImagesModal=d({scope:a,template:"views/admin/modal/uploadImages.html",show:!1}),a.uploadImagesModal.$promise.then(a.uploadImagesModal.show)},a.deleteImage=function(){delete a.coop.image,a.coop.image_id=0},a.addImages=function(b){a.coop.image=a.image,a.coop.image_id=a.image.id,a.image={},a.uploadImagesModal.hide()}}]),angular.module("osApp").controller("TagsCtrl",["$scope","$modal","FlashService","Tags",function(a,b,c,d){a.tags=d.query(),a.predicate="title",a.tag={},a.hideModal=function(){a.tagModal.hide()},a.showModal=function(){a.tagModal=b({show:!1,template:"views/admin/modal/tag.html",scope:a}),a.tagModal.$promise.then(a.tagModal.show)},a.newTag=function(){a.tag={},a.showModal()},a.editTag=function(b){a.tag=b,a.showModal()},a.setOnline=function(a,b){d.update({tagId:a.id},{active:b},function(d){1==d.status?(c.show(d.message,"","success"),a.active=b):c.show("Speicher fehlgeschlagen!","","danger")})},a.deleteTag=function(b){confirm("Schlagwort:\n"+b.title+"\nentgültig entfernen?")&&d.remove({tagId:b.id},function(d){1==d.status?(c.show(d.message,"","success"),a.tags.splice(a.tags.indexOf(b),1)):c.show("Löschen fehlgeschlagen!","","danger")})},a.saveTag=function(b){b&&("undefined"!=typeof a.tag.id?d.update({tagId:a.tag.id},a.tag,function(b){1==b.status?(c.show("Schlagwort erfolgreich gespeichert!","","success"),a.hideModal()):c.show("Speichern fehlgeschlagen","","danger")}):d.create(a.tag,function(b){1==b.status?(c.show("Schlagwort erfolgreich gespeichert!","","success"),a.tags.push(b.tag),a.hideModal()):c.show("Speichern fehlgeschlagen","","danger")}))}}]),angular.module("osApp").controller("GlossarCtrl",["$scope","$modal","FlashService","Glossar",function(a,b,c,d){a.glossars=d.query(),a.predicate="title",a.glossar={},a.hideModal=function(){a.glossarModal.hide()},a.showModal=function(){a.glossarModal=b({show:!1,template:"views/admin/modal/glossar.html",scope:a}),a.glossarModal.$promise.then(a.glossarModal.show)},a.newGlossar=function(){a.glossar={},a.showModal()},a.editGlossar=function(b){a.glossar=b,a.showModal()},a.setOnline=function(a,b){d.update({glossarId:a.id},{active:b},function(d){1==d.status?(c.show(d.message,"","success"),a.active=b):c.show("Speicher fehlgeschlagen!","","danger")})},a.deleteGlossar=function(b){confirm("Eintrag:\n"+b.word+"\nentgültig entfernen?")&&d.remove({glossarId:b.id},function(d){1==d.status?(c.show(d.message,"","success"),a.glossars.splice(a.glossars.indexOf(b),1)):c.show("Löschen fehlgeschlagen!","","danger")})},a.saveGlossar=function(b){b&&("undefined"!=typeof a.glossar.id?d.update({glossarId:a.glossar.id},a.glossar,function(b){1==b.status?(c.show("Schlagwort erfolgreich gespeichert!","","success"),a.hideModal()):c.show("Speichern fehlgeschlagen","","danger")}):(a.glossar.active=1,d.create(a.glossar,function(b){1==b.status?(c.show("Schlagwort erfolgreich gespeichert!","","success"),a.glossars.push(b.entry),a.hideModal()):c.show("Speichern fehlgeschlagen","","danger")})))}}]),angular.module("osApp").factory("Quiz",["$resource",function(a){return a("http://www.openscience.or.at/api/quiz/:quizId/:type/:typeId/:action",{},{byCategorie:{method:"GET",params:{type:"bycategorie"},isArray:!0},query:{method:"GET",params:{quizId:""},isArray:!0},get:{method:"GET"},setresult:{method:"POST",params:{type:"answers"}},answers:{method:"GET",params:{type:"answers"}},update:{method:"PUT",params:{}},create:{method:"POST"},removeQuiz:{method:"DELETE"},createQuestion:{method:"POST",params:{type:"question"}},updateQuestion:{method:"PUT",params:{type:"question"}},removeQuestion:{method:"DELETE",params:{type:"question"}},sortQuestions:{method:"PUT",params:{action:"sortquestions"}}})}]),angular.module("osApp").controller("QuizCtrl",["$scope","Quiz","FlashService",function(a,b,c){a.quizes=b.query(),a.types=[{id:"1",name:"Quiz"},{id:"2",name:"Umfrage"}],a.removeIt=function(d){b.removeQuiz({quizId:d.id},function(b){1==b.status?a.quizes.splice(a.quizes.indexOf(d),1):c.show("Quiz konnte nicht entfernt werden!","","danger")})},a.deleteQuiz=function(b){confirm("Quiz entgültig entfernen?")&&(b.stats.count>0?confirm("Benutzer haben dieses Quiz bereits verwendet.\nTrotzdem entfernen?")&&a.removeIt(b):a.removeIt(b))},a.toggleOnline=function(a){0==a.is_online?a.is_online=1:a.is_online=0,b.update({quizId:a.id},{is_online:a.is_online},function(a){1==a.status?c.show(a.message,"","success"):c.show("Speichern fehlgeschlagen!","","danger")})}}]),angular.module("osApp").controller("QuizdetailsCtrl",["$scope","$state","$modal","FlashService","Quiz","Article","FileUploader",function(a,b,c,d,e,f,g){"new"!=b.params.id?a.quiz=e.get({quizId:b.params.id}):a.quiz={is_online:0,sections:[]},a.types=[{id:"1",name:"Quiz"},{id:"2",name:"Umfrage"}],a.answertypes=[{id:"1",name:"Single Choice"},{id:"2",name:"Multiple Choice"}],a.categories=["wissen","projekte","schulcorner","vol"],a.overview=f.overview(),a.sortFilter="",a.articles=[],a.saveQuiz=function(c){a.quiz.id?e.update({quizId:a.quiz.id},a.quiz,function(a){1==a.status?d.show(a.message,"","success"):d.show("Speichern fehlgeschlagen!","","danger")}):e.create(a.quiz,function(a){1==a.status?(d.show(a.message,"","success"),b.go("quizdetails",{id:a.quiz.id})):d.show("Speichern fehlgeschlagen!","","danger")})},a.toggleSortFilter=function(b){a.sortFilter==b?a.sortFilter="":a.sortFilter=b},a.showModal=function(){a.questionModal=c({scope:a,template:"views/admin/modal/question.html",show:!1}),a.questionModal.$promise.then(a.questionModal.show)},a.hideModal=function(){a.questionModal.hide},a.newQuestion=function(){a.question={answers:[]},a.showModal()},a.editQuestion=function(b){a.question=b,a.showModal()},a.deleteQuestion=function(b){confirm("Frage entgültig entfernen?")&&e.removeQuestion({quizId:a.quiz.id,typeId:b.id},function(c){1==c.status?a.quiz.questions.splice(a.quiz.questions.indexOf(b),1):d.show("Frage konnte nicht entfernt werden!","","danger")})},a.sortController={additionalPlaceholderClass:"",orderChanged:function(b){console.log("there");var c=[];angular.forEach(a.quiz.questions,function(a){c.push(a.id)}),e.sortQuestions({quizId:a.quiz.id},{list:c},function(a){0==a.status?d.show("Fehlgeschlagen","","danger"):d.show(a.message,"","success")})}},a.setAnswer=function(b){angular.forEach(a.question.answers,function(a){a.correct=0}),b.correct=1},a.deleteAnswer=function(b){a.question.answers.splice(a.question.answers.indexOf(b),1)},a.addAnswer=function(){a.question.answers.push({correct:0})},a.saveQuestion=function(){var b=!1;return 1==a.quiz.type?angular.forEach(a.question.answers,function(a){1==a.correct&&(b=!0)}):b=!0,b?void(a.question.id?e.updateQuestion({quizId:a.quiz.id,typeId:a.question.id},a.question,function(b){1==b.status?(d.show(b.message,"","success"),a.questionModal.hide()):d.show("Speichern fehlgeschlagen!","","danger")}):e.createQuestion({quizId:a.quiz.id},a.question,function(b){1==b.status?("undefined"==typeof a.quiz.questions&&(a.quiz.questions=[]),b.question.answers=JSON.parse(b.question.answers),a.quiz.questions.push(b.question),d.show(b.message,"","success"),a.questionModal.hide()):d.show("Speichern fehlgeschlagen!","","danger")})):void d.show("Sie müssen eine korrekte Antwort festlegen!","","danger")},a.newConnection=function(){0==a.overview.length&&(a.overview=f.overview()),a.connectionModal=c({scope:a,template:"views/admin/modal/connectionsId.html",show:!1}),a.connectionModal.$promise.then(a.connectionModal.show)},a.toggleConnection=function(b){var c=!1;"undefined"!=typeof a.quiz.articles&&null!=a.quiz.articles&&a.quiz.articles||(a.quiz.articles=[]),angular.forEach(a.quiz.articles,function(d,e){d==b.id&&(c=!0,a.quiz.articles.splice(e,1))}),c||a.quiz.articles.push(b.id)};var h=a.uploader=new g({url:"http://www.openscience.or.at/assets/ajax/uploadImages.php",alias:"qqfile",queueLimit:20});h.formData=[{cat:"quiz",id:"new"}],h.filters.push({name:"imageFilter",fn:function(a,b){var c="|"+a.type.slice(a.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(c)}}),h.onWhenAddingFileFailed=function(a,b,c){},h.onAfterAddingFile=function(b){h.formData[0].id=a.quiz.id||"new",b.formData[0].id=a.quiz.id||"new"},h.onSuccessItem=function(b,c,d,e){a.uploadMultiple?a.images.push(c.image):a.image=c.image},a.openImagesModal=function(b){h.clearQueue(),a.images=[],a.image={},a.uploadMultiple=b,b?h.queueLimit=20:(h.queueLimit=1,a.image.id=0),a.uploadImagesModal=c({scope:a,template:"views/admin/modal/uploadImages.html",show:!1}),a.uploadImagesModal.$promise.then(a.uploadImagesModal.show)},a.deleteImage=function(){delete a.quiz.image,a.quiz.image_id=0},a.addImages=function(b){a.quiz.image=a.image,a.quiz.image_id=a.image.id,a.image={},a.uploadImagesModal.hide()}}]),angular.module("osApp").controller("GuestbookCtrl",["$scope","$modal","FlashService","Guestbook",function(a,b,c,d){a.guestbook=d.query(),a.entry={},a.toggleActive=function(a){var b=0;0==a.active&&(b=1),d.update({id:a.id},{active:b},function(d){1==d.status&&(c.show(d.message,"","success"),a.active=b)})},a.deleteEntry=function(b){confirm("Eintrag #"+b.id+" entgültig entfernen?")&&d.remove({id:b.id},function(d){1==d.status&&(c.show(d.message,"","success"),a.guestbook.splice(a.guestbook.indexOf(b),1))})},a.showEntry=function(c){a.entry=c,a.gbModal=b({scope:a,template:"views/admin/modal/guestbook.html",show:!1}),a.gbModal.$promise.then(a.gbModal.show)}}]),angular.module("osApp").controller("EventsCtrl",["$scope","Events",function(a,b){a.events=b.list()}]),angular.module("osApp").controller("BookingsCtrl",["$scope","$state","$modal","FlashService","Events",function(a,b,c,d,e){a.bookings=e.bookings(),a.deleteTicket=function(b){1==b.solo?confirm("Die Einzelbuchung von\n"+b.firstname+" "+b.lastname+"\nfür den Kurs\n"+b["class"].title+"\nentgültig entfernen?")&&e.deleteTicket({eventId:b.id,type:"solo"},function(c){1==c.status&&(a.bookings.splice(a.bookings.indexOf(b),1),d.show("Buchung erfolgreich entfernt!","","success"))}):1==b.groups&&confirm("Die Gruppenbuchung von\n"+b.firstname+" "+b.lastname+"\nfür den Kurs\n"+b["class"].title+"\nentgültig entfernen?")&&e.deleteGroupEvent({eventId:b.id,type:"group"},function(c){1==c.status&&(a.bookings.splice(a.bookings.indexOf(b),1),d.show("Buchung erfolgreich entfernt!","","success"))})},a.showTicket=function(a){1==a.solo?b.go("event",{id:a.event.id,type:"solo"}):1==a.groups&&b.go("event",{id:a.id,type:"group"})}}]),angular.module("osApp").filter("eventtype",function(){return function(a,b){if("undefined"!=typeof b&&b){var c=[];return angular.forEach(a,function(a,d){"solo"==b?1==a.solo&&c.push(a):"groups"==b&&1==a.groups&&c.push(a)}),c}return a}}),angular.module("osApp").controller("EmailconfigCtrl",["$timeout","$scope","$state","FlashService","Article",function(a,b,c,d,e){b.view="solo",b.setView=function(a){b.view=a},b.header=e.get({articleId:598}),b.content_solo=e.get({articleId:599}),b.content_group=e.get({articleId:601}),b.footer=e.get({articleId:600}),b.froalaOptions={inlineMode:!0},b.saveData=function(){e.update({articleId:598},{text:b.header.text}),e.update({articleId:599},{text:b.content_solo.text}),e.update({articleId:601},{text:b.content_group.text}),e.update({articleId:600},{text:b.footer.text}),a(function(){d.show("Speichern erfolgreich!","","success")},250)}}]),angular.module("osApp").controller("FaqsCtrl",["$scope","Faq","$modal","FlashService",function(a,b,c,d){a.faqs=b.query({section:"vol",order:"position"}),a.openModal=function(){a.faqModal=c({scope:a,template:"views/admin/modal/faq.html",show:!1}),a.faqModal.$promise.then(a.faqModal.show)},a.editFaq=function(b){a.faq=b,a.openModal()},a.newFaq=function(){a.faq={},a.openModal()},a.deleteFaq=function(c){confirm("Eintrag\n"+c.title+"\nentgültig entfernen?")&&b.remove({faqId:c.id},function(b){1==b.status&&(d.show(b.message,"","success"),a.faqs.splice(a.faqs.indexOf(c),1))})},a.sortController={additionalPlaceholderClass:"",orderChanged:function(c){var e=[];angular.forEach(a.faqs,function(a){e.push(a.id)}),b.sort({list:e},function(a){0==a.status?d.show("Fehlgeschlagen","","danger"):d.show(a.message,"","success")})}},a.setOnline=function(a,c){b.update({faqId:a.id},{active:c},function(b){1==b.status?(d.show(b.message,"","success"),a.active=c):d.show("Speicher fehlgeschlagen!","","danger")})},a.saveFaq=function(c){c&&(a.faq.id?b.update({faqId:a.faq.id},{text:a.faq.text,title:a.faq.title},function(b){1==b.status&&(d.show(b.message,"","success"),a.faqModal.hide())}):b.create({text:a.faq.text,title:a.faq.title,section:"vol",active:"1"},function(b){1==b.status&&(d.show(b.message,"","success"),a.faqs.push(b.entry),a.faqModal.hide())}))}}]),angular.module("osApp").directive("sticker",["$document","$window","$timeout","$rootScope",function(a,b,c,d){return{restrict:"A",link:function(e,f){var g=angular.element(document.getElementById("header")),h=angular.element(document.getElementById("navigation")),i=angular.element(document.getElementById("content_container")),j=f.find(".scrollbar"),k=f.find(".items"),l=(k.find(".items").find(".row"),!1),m=f.parent().parent().find(".article"),n=0,o=new Sly(k,{speed:100,smart:1,activateOn:"click",activatePageOn:"click",scrollBar:f.find(".scrollbar"),scrollBy:100,dragHandle:1,mouseDragging:0,touchDragging:1,dynamicHandle:1,clickBar:1,releaseSwing:!0,keyboardNavBy:"items"});o.on("load",function(){l=!0}),e.checkDim=function(){var c=k.find(".slide");c.css({height:n+31+"px"});var d=angular.element(document.getElementById("sly-scroll-container")),e=parseInt(a.scrollTop());b.innerWidth>960&&(e>g.innerHeight()-h.innerHeight()+i.innerHeight()-22+m.innerHeight()?(f.addClass("headroom--not-top").css({transform:"translateY(-"+(g.innerHeight()-h.innerHeight()+i.innerHeight()-20+m.innerHeight())+"px)","-webkit-transform":"translateY(-"+(g.innerHeight()-h.innerHeight()+i.innerHeight()-20+m.innerHeight())+"px)"}),d.innerHeight()+30>b.innerHeight-h.innerHeight()?(k.css({height:b.innerHeight-h.innerHeight()-30+"px"}),j.css({height:b.innerHeight-h.innerHeight()-30+"px"}),l?o.reload():o.init(),j.show()):(l=!1,j.hide(),o.initialized&&o.destroy())):f.removeClass("headroom--not-top").css({transform:"translateY(0px)","-webkit-transform":"translateY(0px)"}))},a.on("scroll",function(){c(function(){e.checkDim()})}),j.hide(),c(function(){e.checkDim()}),angular.element(b).bind("resize",function(){c(function(){e.checkDim()})}),d.$on("nextConnection",function(a,b){var d=angular.element(document.getElementById("connections_list"));c(d.length>0?function(){n=d.find(".article_thumb").eq(b).height(),e.checkDim()}:function(){n=0,e.checkDim()})})}}}]),angular.module("osApp").factory("User",["$resource",function(a){return a("http://www.openscience.or.at/api/accounts/:userId/:action",{},{get:{method:"GET"},query:{method:"GET",params:{userId:""},isArray:!0},update:{method:"PUT"},remove:{method:"DELETE"},create:{method:"POST"},checkpassword:{method:"POST",params:{action:"checkpass"}}})}]).factory("Role",["$resource",function(a){return a("http://www.openscience.or.at/api/roles/:roleId",{},{get:{method:"GET"},query:{method:"GET",params:{roleId:""},isArray:!0},update:{method:"PUT"},remove:{method:"DELETE"},create:{method:"POST"}})}]),angular.module("osApp").controller("UserCtrl",["$scope","User","Role","FlashService","$modal",function(a,b,c,d,e){a.users=b.query(),a.roles=c.query(),a.error={},a.openUserModal=function(){a.userModal=e({scope:a,template:"views/admin/modal/user.html",show:!1}),a.userModal.$promise.then(a.userModal.show)},a.editUser=function(b){a.user=b,a.openUserModal()},a.newUser=function(){a.user={},a.openUserModal()},a.updateUserData=function(){b.update({userId:a.user.id},{name:a.user.name,username:a.user.username,role_id:a.user.role_id,password:a.user.pass},function(b){1==b.status&&(d.show(b.message,"","success"),a.userModal.hide())})},a.deleteUser=function(c){confirm("Account von:\n"+c.name+"\nentgültig entfernen?")&&b.remove({userId:c.id},function(b){1==b.status&&(a.users.splice(a.users.indexOf(c),1),d.show(b.message,"","success"))})},a.setActive=function(a,c){b.update({userId:a.id},{active:c},function(b){1==b.status&&(d.show(b.message,"","success"),a.active=c)})},a.saveUser=function(c){if(a.error.found=!1,c)if(a.user.id)if(a.user.pass){if(!a.user.re_pass)return a.error.found=!0,void(a.error.message="Sie müssen das Passwort wiederholen!");if(a.user.pass!=a.user.re_pass)return a.error.found=!0,void(a.error.message="Passwörter stimmen nicht überein!");b.checkpassword({userId:a.user.id},{password:a.user.old_pass},function(b){return 0==b.status?(a.error.found=!0,void(a.error.message="Vorhandenes Passwort falsch!")):void a.updateUserData()})}else a.updateUserData();else{if(!a.user.pass)return a.error.found=!0,void(a.error.message="Sie müssen ein Passwort festlegen!");if(!a.user.re_pass)return a.error.found=!0,void(a.error.message="Sie müssen das Passwort wiederholen!");if(a.user.pass!=a.user.re_pass)return a.error.found=!0,void(a.error.message="Passwörter stimmen nicht überein!");b.create({name:a.user.name,username:a.user.username,role_id:a.user.role_id,password:a.user.pass,active:0},function(b){1==b.status&&(d.show(b.message,"","success"),a.userModal.hide(),a.users.push(b.user))})}}}]),angular.module("osApp").directive("stickon",function(){return{restrict:"A",link:function(a,b,c){$(b).stick_in_parent().on("sticky_kit:stick",function(a){console.log("has stuck!",a.target)})}}}),angular.module("osApp").controller("NewslettersCtrl",["$scope","FlashService","Newsletter",function(a,b,c){function d(){"undefined"!=typeof a.campaigns.data&&a.campaigns.data.length&&a.newsletters.length&&angular.forEach(a.newsletters,function(b){angular.forEach(a.campaigns.data,function(a){b.mailchimp_id==a.id&&(b.mailchimp=a)})})}a.newsletters=c.query(function(){d()}),a.campaigns=c.campaigns(function(a){d();
}),a.deleteNewsletter=function(d){confirm("Newsletter:\n"+d.title+"\nentgültig entfernen?")&&c.removeCampaign({id:d.mailchimp_id},function(c){c.status?(a.newsletters.splice(a.newsletters.indexOf(d),1),b.show(c.message,"","success")):b.show("Newsletter konnte nicht gelöscht werden!","","danger")})}}]),angular.module("osApp").factory("Newsletter",["$resource",function(a){return a("http://www.openscience.or.at/:folder/:location/:newsId/:action/:id",{},{query:{method:"GET",params:{folder:"api",location:"newsletters"},isArray:!0},get:{method:"GET",params:{folder:"api",location:"newsletter"}},campaigns:{method:"GET",params:{folder:"api",location:"mailchimp",action:"campaigns"}},list:{method:"GET",params:{folder:"api",location:"mailchimp",newsId:"lists"}},campaign:{method:"GET",params:{folder:"api",location:"mailchimp",newsId:"campaigns",id:""}},content:{method:"GET",params:{folder:"api",location:"mailchimp",newsId:"mailchimper.php",fetch:"content",id:""}},registration:{method:"POST",params:{folder:"api",location:"mailchimp",newsId:"registration"}},createChimp:{method:"POST",params:{folder:"api",location:"mailchimp",newsId:"campaigns"}},update:{method:"PUT",params:{folder:"api",location:"mailchimp",newsId:"campaigns",id:""}},remove:{method:"DELETE",params:{folder:"api",location:"newsletters",newsId:""}},removeCampaign:{method:"DELETE",params:{folder:"api",location:"mailchimp",action:"campaigns",id:""}},sendTest:{method:"PUT",params:{folder:"api",location:"mailchimp",newsId:"campaigns",action:"",id:"testmail"}},sendCampaign:{method:"POST",params:{folder:"api",location:"mailchimp",newsId:"campaigns",action:"",id:"send"}},sort:{method:"PUT",params:{partnerId:"sort"}},configs:{method:"GET",params:{folder:"api",location:"newsletters",newsId:"configs"}},config:{method:"GET",params:{folder:"api",location:"newsletters",newsId:"configs"}},configSave:{method:"PUT",params:{folder:"api",location:"newsletters",newsId:"configs",id:""},isArray:!0}})}]),angular.module("osApp").controller("NewsletterCtrl",["$scope","$state","$timeout","$document","$stateParams","$modal","$aside","FlashService","Newsletter","Article",function(a,b,c,d,e,f,g,h,i,j){function k(){c(function(){$(".full-fixed").animate({scrollTop:$("#newsletter-box").height()},250)})}a.status="loading",a.colors=[{name:"normal",title:"Standard"},{name:"os",title:"OpenScience"},{name:"wissen",title:"Wissen"},{name:"projekte",title:"Projekte"},{name:"schulcorner",title:"Schulcorner"},{name:"vol",title:"Vienna Open Lab"}],a.color={wissen:"523C7C",schulcorner:"858D1E",projekte:"1DA9C7",vol:"A31031"},a.overview=[],"new"!=e.id?a.newsletter=i.get({newsId:e.id},function(){a.campaign=i.campaign({id:a.newsletter.mailchimp_id},function(b){a.newsletter.mailchimp=b.data[0],""==a.newsletter.content_data&&"sent"!=a.newsletter.mailchimp.status&&("undefined"==typeof a.newsletter.items&&(a.newsletter.items=[]),$(a.newsletter.content).children().children().each(function(b,c){$(c).find(".sort").each(function(b,c){var d={},e=$(c).attr("data-width");if(1==e&&(e=0),$(c).hasClass("text"))d={text:$(c).children().html(),size:e,type:{name:"text",intern:"additional","class":"",typClass:"text"}},a.newsletter.items.push(d);else if($(c).hasClass("header"))d={title:$(c).find("div").text(),size:e,type:{name:"header",intern:"additional","class":"",typClass:"title"}},a.newsletter.items.push(d);else{var f=$(c).attr("data-id");j.get({articleId:f},function(b){d={id:b.id,title:b.title,categorie:b.categorie.title,image:b.image,intro:b.intro||b.text.substring(0,b.text.indexOf(".")+1),size:0,type:{name:"",intern:"articles","class":b.section.name,typClass:"article"}},a.newsletter.items.push(d)})}}),h.show("Newsletter Inhalt wurde vom alten System konvertiert!","Elemente müssen eventuell neu positioniert werden","warning",10)}))})}):(a.newsletter={status:"create"},a.newsletter.items=[]),a.list=i.list(),a.$watchCollection("newsletter.mailchimp",function(b,c){b!=c&&(a.status=b.status)}),a.openArticlesModal=function(){0==a.overview.length&&(a.overview=j.overview({images:!0})),a.articlesModal=g({scope:a,template:"views/admin/modal/articles_drop.html"})},a.toggleSortFilter=function(b){a.sortFilter==b?a.sortFilter="":a.sortFilter=b},a.addTitle=function(){a.addingTitle=!0,a.newTitle={},a.titleModal=f({scope:a,template:"views/admin/modal/newsletter_title.html",show:!1}),a.titleModal.$promise.then(function(){a.titleModal.show()})},a.insertTitle=function(b){if(b){if(a.addingTitle){var c={title:a.newTitle.title,type:{name:"header",intern:"additional","class":a.newTitle.type["class"],typClass:"title"},size:3};"undefined"==typeof a.newsletter.items&&(a.newsletter.items=[]),a.newsletter.items.push(c),k()}a.titleModal.hide()}},a.editTitle=function(b){a.addingTitle=!1,a.newTitle=b,a.titleModal=f({scope:a,template:"views/admin/modal/newsletter_title.html",show:!1}),a.titleModal.$promise.then(function(){a.titleModal.show()})},a.addText=function(){a.addingText=!0,a.newText={},a.textModal=f({scope:a,template:"views/admin/modal/newsletter_text.html",show:!1}),a.textModal.$promise.then(function(){a.textModal.show()})},a.editText=function(b){a.addingText=!1,a.newText=b,a.textModal=f({scope:a,template:"views/admin/modal/newsletter_text.html",show:!1}),a.textModal.$promise.then(function(){a.textModal.show()})},a.insertText=function(b){if(b){if(a.addingText){var c={text:a.newText.text,size:3,type:{name:"text",intern:"additional","class":a.newText.type["class"],typClass:"text"}};"undefined"==typeof a.newsletter.items&&(a.newsletter.items=[]),a.newsletter.items.push(c),k()}a.textModal.hide()}},a.deleteItem=function(b){a.newsletter.items.splice(b,1)},a.sizeUp=function(a){a.size<3&&a.size++},a.sizeDown=function(a){a.size>0&&a.size--},a.toggleArticle=function(b){"undefined"==typeof a.newsletter.items&&(a.newsletter.items=[]);var c=!1;if(angular.forEach(a.newsletter.items,function(d,e){b.type==d.type.name&&b.id==d.id&&(a.newsletter.items.splice(e,1),c=!0)}),!c){if("class"==b.type){var d="Kurs/Seminar",e="kurse";"Summercamp"==b.section.title?(d="Summer Science Camp",e="summer-science-camps"):"Seminare"==b.section.title&&(e="seminare");var f={id:b.id,title:b.title,name:b.name,categorie:d,cat:e,image:b.image,intro:b.intro||b.text.substring(0,b.text.indexOf(".")+1),section:"vol",size:0,type:{name:b.type,intern:"articles","class":b.section.name,typClass:"article"}}}else if("article"==b.type)var f={id:b.id,title:b.title,name:b.name,categorie:b.categorie.title,cat:b.categorie.name,image:b.image,section:b.section.name,intro:b.intro||b.text.substring(0,b.text.indexOf(".")+1),size:0,type:{name:b.type,intern:"articles","class":b.section.name,typClass:"article"}};a.newsletter.items.push(f),k()}},a.saveNewsletter=function(c){a.loading(!0,"Newsletter wird gespeichert...");var d=$('<table id="main-content"></table>'),e=0,f=$("<tr></tr>"),g=0,j=null;angular.forEach(angular.element(".newsletter-toconvert > div"),function(a,b){var c=angular.element(a).clone();c.find(".newsletter-edit-menu").remove(),c.removeAttr("ng-class"),c.removeAttr("ng-repeat"),c.removeAttr("ng-if"),c.removeAttr("as-sortable-item");var h=$("<td></td>");c.hasClass("text")&&c.find("h2").wrap('<a target="_blank" href="http://www.openscience.or.at"></a>'),h.append(c),c.hasClass("col-md-12")?(h.attr("width","720"),h.attr("colspan",6),d.append(f),f=$("<tr></tr>"),e+=6):c.hasClass("col-md-8")?(h.attr("width","540"),h.attr("colspan",4),e+=4):c.hasClass("col-md-6")?(h.attr("width","360"),h.attr("colspan",3),e+=3):c.hasClass("col-md-4")&&(h.attr("width","240"),h.attr("colspan",2),e+=2),e>0&&f.append(h),e>=6&&(d.append(f),f=$("<tr></tr>"),e=0,g=b+1),j=c}),a.newsletter.id?i.update({id:a.newsletter.mailchimp_id},{list_id:a.newsletter.list_id,subject:a.newsletter.title,content:d.html().replace(/<!--[^(-->)]+-->/g,""),newsletter:a.newsletter},function(b){a.loading(!1),1==b.status?h.show(b.message,"","success"):h.show("Fehler beim speichern des Newsletters!","","danger")}):i.createChimp({list_id:a.newsletter.list_id,subject:a.newsletter.title,content:d.html().replace(/<!--[^(-->)]+-->/g,""),newsletter:a.newsletter},function(c){a.loading(!1),1==c.status?(h.show(c.message,"","success"),b.go("newsletter",{id:c.newsletter.id})):h.show("Fehler beim speichern des Newsletters!","","danger")})},a.sendTest=function(){a.test={},a.emailModal=f({template:"views/admin/modal/email.html",scope:a,show:!1}),a.emailModal.$promise.then(function(){a.emailModal.show()})},a.submitTest=function(b){b&&(a.loading(!0,"Testmail wird versendet"),a.emailModal.hide(),i.sendTest({action:a.newsletter.mailchimp_id},{email:a.test.email},function(b){a.loading(!1),1==b.status?(h.show(b.message,"","success"),a.newsletter.mailchimp.tests_remain--):h.show("Fehler beim senden der Testmail","","danger")}))},a.showPreview=function(){},a.sendCampaign=function(){a.loading(!0,"Newsletter wird versendet..."),confirm("Newsletter:\n"+a.newsletter.title+"\njetzt senden?")&&i.sendCampaign({action:a.newsletter.mailchimp_id},{},function(c){a.loading=!1,1==c.status?(h.show(c.message,"","success"),b.go("newsletters")):h.show("Fehler beim absenden des Newsletters","","danger")})},a.loading=function(b,c){b?(a.msg=c,a.loadingModal=f({template:"views/admin/modal/loading.html",scope:a,show:!1,placement:"center",backdrop:"static"}),a.loadingModal.$promise.then(function(){a.loadingModal.show()})):a.loadingModal.hide()}}]),angular.module("osApp").filter("innewsletter",function(){return function(a,b,c){var d="";return angular.forEach(b,function(b,c){a.id==b.id&&(d="selected")}),d}}),angular.module("osApp").controller("ElabsCtrl",["$scope","$modal","FlashService","Elab",function(a,b,c,d){a.sections=d.sections(),a.deleteElab=function(b){confirm("eLab :\n"+b.title+"\nentgültig entfernen?")&&d.remove({id:b.id},function(d){1==d.status?(a.sections.splice(a.sections.indexOf(b),1),c.show(d.message,"","success")):c.show("Löschen fehlgeschlagen!","","danger")})},a.setOnline=function(a,b){d.update({id:a.id},{online:b},function(d){1==d.status?(a.online=b,c.show(d.message,"","success")):c.show("Speichern fehlgeschlagen!","","danger")})},a.sortController={additionalPlaceholderClass:"col-lg-2 col-md-4 col-sm-6 col-xs-12 no-pad",orderChanged:function(b){var e=[];angular.forEach(a.sections,function(a){e.push(a.id)}),d.sort({list:e},function(a){0==a.status?c.show("Fehlgeschlagen","","danger"):c.show(a.message,"","success")})}}}]),angular.module("osApp").controller("ElabCtrl",["$stateParams","$state","$scope","$modal","FlashService","Elab","FileUploader","FileEdit",function(a,b,c,d,e,f,g,h){c.image={},c.files=[],c.uploadMultiple=!1,c.elab=f.section({id:a.id}),c.elabs=f.sectionLabs({type:a.id}),c.elabModal=d({template:"views/admin/modal/elabentry.html",scope:c,show:!1}),c.saveElab=function(){c.elab.id?f.update({id:c.elab.id},{image_id:c.elab.image_id,title:c.elab.title,online:c.elab.online,text:c.elab.text},function(a){1==a.status?e.show(a.message,"","success"):e.show("Speichern fehlgeschlagen!","","danger")}):f.create({image_id:c.elab.image_id,title:c.elab.title,online:c.elab.online,text:c.elab.text},function(a){1==a.status?(e.show(a.message,"","success"),b.go("elab",{id:a.elab.title})):e.show("Speichern fehlgeschlagen!","","danger")})},c.toggleEntryOnline=function(a){var b=0;0==a.online&&(b=1),f.updateElabentry({type:a.id},{online:b},function(c){1==c.status?(a.online=b,e.show(c.message,"","success")):e.show("Speichern fehlgeschlagen!","","danger")})},c.viewElab=function(a){c.elabentry=a,c.elabModal.show()},c.newElabentry=function(){c.elabentry={},c.elabModal.show()},c.saveElabEntry=function(a){a&&(c.elabentry.container_url?c.elabentry.id?f.updateElabentry({type:c.elabentry.id},{container_url:c.elabentry.container_url,online:c.elabentry.online,title:c.elabentry.title,text:c.elabentry.text},function(a){1==a.status?(e.show(a.message,"","success"),c.elabModal.hide()):e.show("Speichern fehlgeschlagen!","","danger")}):f.addElabentry({type:c.elabentry.id},{container_url:c.elabentry.container_url,online:c.elabentry.online,title:c.elabentry.title,text:c.elabentry.text,section_id:c.elab.id},function(a){1==a.status?(e.show(a.message,"","success"),c.elabs.push(a.elab),c.elabModal.hide()):e.show("Speichern fehlgeschlagen!","","danger")}):e.show("Keine Animation festgelegt!","","danger",5))},c.deleteElabentry=function(a){confirm("eLAB Eintrag:\n"+a.title+"\nentgültig entfernen?")&&f.removeElabentry({type:a.id},function(b){1==b.status?(c.elabs.splice(c.elabs.indexOf(a),1),e.show(b.message,"","success")):e.show("Löschen fehlgeschlagen!","","danger")})},c.sortController={additionalPlaceholderClass:"",orderChanged:function(a){var b=[];angular.forEach(c.elabs,function(a){b.push(a.id)}),f.sortEntries({id:c.elab.id},{list:b},function(a){0==a.status?e.show("Fehlgeschlagen","","danger"):e.show(a.message,"","success")})}};var i=c.uploader=new g({url:"http://www.openscience.or.at/assets/ajax/uploadImages.php",alias:"qqfile",queueLimit:20});i.formData=[{cat:"elab",id:"new"}],i.filters.push({name:"imageFilter",fn:function(a,b){var c="|"+a.type.slice(a.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(c)}}),i.onWhenAddingFileFailed=function(a,b,c){},i.onAfterAddingFile=function(a){i.formData[0].id=c.elab.id,a.formData[0].id=c.elab.id},i.onSuccessItem=function(a,b,d,e){c.uploadMultiple?c.images.push(b.image):c.image=b.image},c.openImagesModal=function(a){i.clearQueue(),c.images=[],c.image={},c.uploadMultiple=a,a?i.queueLimit=20:(i.queueLimit=1,c.image.id=0),c.uploadImagesModal=d({scope:c,template:"views/admin/modal/uploadImages.html",show:!1}),c.uploadImagesModal.$promise.then(c.uploadImagesModal.show)},c.deleteImage=function(){delete c.elab.image,c.elab.image_id=0},c.addImages=function(a){c.elab.image=c.image,c.elab.image_id=c.image.id,c.image={},c.uploadImagesModal.hide()};var j=c.uploaderFiles=new g({url:"http://www.openscience.or.at/assets/ajax/uploadFiles.php",alias:"qqfile"});j.filters.push({name:"flashFilter",fn:function(a,b){return a}}),j.formData=[{cat:"elab",id:"new"}],c.openFilesModal=function(){j.clearQueue(),c.file={},c.uploadFilesModal=d({scope:c,template:"views/admin/modal/uploadFiles.html",show:!1}),c.uploadFilesModal.$promise.then(c.uploadFilesModal.show)},c.addFiles=function(a){c.elabentry.container_url="/"+c.file.url,c.file={},c.uploadFilesModal.hide()},c.removeFile=function(){c.elabentry.container_url=""},j.onAfterAddingFile=function(a){j.formData[0].id=c.elabentry.id||"new",a.formData[0].id=c.elabentry.id||"new"},j.onSuccessItem=function(a,b,d,e){c.file=b.file}}]),angular.module("osApp").factory("SwfObject",["$window",function(a){return a.swfobject}]).directive("swfObject",["$window","$timeout","SwfObject",function(a,b,c){return{restrict:"EAC",template:'<div id="{{id}}" ng-transclude></div>',transclude:!0,scope:{params:"=swfParams",attrs:"=swfAttrs",callbacks:"=swfCallbacks"},link:function(d,e,f){if(d.id=f.swfId||"swf-"+Math.floor(1e12*Math.random()).toString(16),f.$observe("swfUrl",function(a){a&&(console.log(a),b(function(){c.embedSWF(a,d.id,f.swfWidth||700,f.swfHeight||580,f.swfVersion||"10",null,null,d.params,d.attrs)},f.swfTimeout||0))}),d.callbacks){var g=d.callbacks,h=Object.keys(g);h.forEach(function(b){a[b]=g[b]})}}}}]),angular.module("osApp").directive("fillscreen",["Fullscreen",function(a){return{restrict:"A",link:function(b,c,d){$(c).on("click",function(){$("#categorie_container").hasClass("fullscreen")?($("#categorie_container").removeClass("fullscreen"),a.cancel()):($("#categorie_container").addClass("fullscreen"),a.all())}),$(document).keyup(function(b){27==b.keyCode&&$("#categorie_container").hasClass("fullscreen")&&($("#categorie_container").removeClass("fullscreen"),a.cancel())})}}}]).directive("subswitcher",["$timeout",function(a){return{restrict:"AC",template:'<i class="fa fa-chevron-down" ng-class="{open: opened}"></i>',link:function(b,c,d){a(function(){var a=$(c).parent().find("ul"),b=a.height();c.on("click",function(c){"0px"==a.css("height")?a.css({height:b}):a.css({height:0})})})}}}]),function(a){var b=function(a){var b=a.module("FBAngular",[]);return b.factory("Fullscreen",["$document","$rootScope",function(b,c){var d=b[0],e="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element&&Element.ALLOW_KEYBOARD_INPUT,f=c.$new();b.on("fullscreenchange webkitfullscreenchange mozfullscreenchange MSFullscreenChange",function(){f.$emit("FBFullscreen.change",g.isEnabled())});var g={$on:a.bind(f,f.$on),all:function(){g.enable(d.documentElement)},enable:function(a){a.requestFullScreen?a.requestFullScreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen?/Version\/[\d]{1,2}(\.[\d]{1,2}){1}(\.(\d){1,2}){0,1} Safari/.test(navigator.userAgent)?a.webkitRequestFullscreen():a.webkitRequestFullscreen(e):a.msRequestFullscreen&&a.msRequestFullscreen()},cancel:function(){d.cancelFullScreen?d.cancelFullScreen():d.mozCancelFullScreen?d.mozCancelFullScreen():d.webkitExitFullscreen?d.webkitExitFullscreen():d.msExitFullscreen&&d.msExitFullscreen()},isEnabled:function(){var a=d.fullscreenElement||d.mozFullScreenElement||d.webkitFullscreenElement||d.msFullscreenElement;return a?!0:!1},isSupported:function(){var a=d.documentElement,b=a.requestFullScreen||a.mozRequestFullScreen||a.webkitRequestFullscreen||a.msRequestFullscreen;return b?!0:!1}};return g}]),b.directive("fullscreen",["Fullscreen",function(a){return{link:function(b,c,d){if(d.fullscreen){b.$watch(d.fullscreen,function(b){var d=a.isEnabled();b&&!d?(a.enable(c[0]),c.addClass("isInFullScreen")):!b&&d&&(a.cancel(),c.removeClass("isInFullScreen"))});var e=a.$on("FBFullscreen.change",function(a,e){e||b.$evalAsync(function(){b.$eval(d.fullscreen+"= false"),c.removeClass("isInFullScreen")})});b.$on("$destroy",function(){e()})}else{if(void 0!==d.onlyWatchedProperty)return;c.on("click",function(b){a.enable(c[0])})}}}}]),b};"function"==typeof define&&define.amd?define("FBAngular",["angular"],function(a){return b(a)}):b(a.angular)}(window),angular.module("osApp").controller("SectionquizCtrl",["$scope","$stateParams","Quiz",function(a,b,c){a.section=b.section||"vol"}]),angular.module("osApp").controller("SectionquizstartCtrl",["$scope","$stateParams","Quiz",function(a,b,c){a.q={},a.stats={},a.position=0,a.showMyAnswers=!1,a.startet=!1,a.finished=!1,a.section=b.section||"vol",a.$parent.quiz.$promise.then(function(){angular.forEach(a.$parent.quiz,function(c,d){c.name==b.name&&(a.q=c)})}),a.startQuiz=function(){a.startet=!0,a.position=1},a.changeQuestion=function(b){a.position+=b},a.user={},a.answers=[],a.setAnswer=function(b,c){var c={questionId:b.id,answerId:b.answers.indexOf(c),answer:c.id,correct:1==c.correct?!0:!1};a.answers[b.id]=c},a.setAnswers=function(b,c){var d=!1,e=0,f=0,g={questionId:b.id,answerId:b.answers.indexOf(c),answer:c.id,correct:1==c.correct?!0:!1};"undefined"==typeof a.answers[b.id]&&(a.answers[b.id]={questionId:b.id,correct:!1,correct_answers:JSON.parse(b.success_answer_multiple),answers:[]}),angular.forEach(a.answers[b.id].answers,function(c,e){c.answerId==g.answerId&&(a.answers[b.id].answers.splice(e,1),d=!0)}),d||a.answers[b.id].answers.push(g),angular.forEach(a.answers[b.id].answers,function(c){a.answers[b.id].correct_answers.indexOf(c.answerId)>-1?e++:f++}),e==a.answers[b.id].correct_answers.length&&0==f?a.answers[b.id].correct=!0:a.answers[b.id].correct=!1},a.showAnswers=function(b){a.showMyAnswers=!0},a.userAnswered=function(b,c){var d=!1;return angular.forEach(a.answers,function(a,e){"undefined"!=typeof a&&a.questionId==c.id&&(1==c.type?c.answers.indexOf(b)==a.answerId&&(d=!0):angular.forEach(a.answers,function(a){a.answerId==c.answers.indexOf(b)&&(d=!0)}))}),d},a.finish=function(){var b=0;angular.forEach(a.answers,function(a,c){"undefined"!=typeof a&&a.correct&&b++}),a.stats={right:b,percent:100/a.q.questions.length*b},a.result={quiz_id:a.q.id,correct_count:a.stats.right,questions_count:a.q.questions.length},a.finished=!0,c.setresult({quizId:a.q.id},a.result,function(a){1==a.status})}}]),angular.module("osApp").directive("sticktop",["$timeout",function(a){return{restrict:"EAC",link:function(a,b,c){var d=angular.element($(".full-fixed"));d.on("scroll",function(){var a=parseInt(d.scrollTop());a>10?(b.css({position:"fixed",top:0,left:0,"z-index":10}).addClass("row"),d.css({"padding-top":"58px"})):(b.css({position:"static"}).removeClass("row"),d.css({"padding-top":"0px"}))})}}}]),angular.module("osApp").controller("NewsletterconfigCtrl",["$scope","Newsletter","FlashService",function(a,b,c){a.configs=b.configs(),a.view="os",a.saveData=function(){var d={headertext:a.configs.headertext.value,headertext_vol:a.configs.headertext_vol.value,footertext:a.configs.footertext.value,footertext_vol:a.configs.footertext_vol.value};b.configSave(d,function(a){c.show("Speichern erfolgreich!","","success")})}}]),angular.module("osApp").service("Email",["$resource",function(a){return a("http://www.openscience.or.at/api/:module/:type/:id",{},{regmail:{method:"POST",params:{module:"email",type:"ticket",id:""}},sendArticle:{method:"POST",params:{module:"email",type:"article",id:""}},getPdf:{method:"GET",params:{module:"pdf",type:"article",id:""}}})}]);